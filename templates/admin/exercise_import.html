<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>批量导入练习题</title><style>* {margin:0;padding:0;box-sizing:border-box}body {font-family:-apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;background:#f8f9fa;color:#333;line-height:1.6}.import-container {max-width:1000px;margin:20px auto;background:white;border-radius:12px;box-shadow:0 4px 20px rgba(0,0,0,0.1);overflow:hidden}.import-header {background:linear-gradient(135deg, #6f42c1 0%, #e83e8c 100%);color:white;padding:30px;text-align:center}.import-header h1 {font-size:2em;margin-bottom:10px}.import-header p {opacity:0.9;font-size:1.1em}.import-content {padding:40px}.step-indicator {display:flex;justify-content:center;margin-bottom:40px}.step {display:flex;flex-direction:column;align-items:center;position:relative;flex:1;max-width:200px}.step:not(:last-child)::after {content:'';position:absolute;top:20px;left:60%;right:-40%;height:2px;background:#e9ecef;z-index:1}.step-number {width:40px;height:40px;border-radius:50%;background:#e9ecef;color:#6c757d;display:flex;align-items:center;justify-content:center;font-weight:bold;margin-bottom:10px;position:relative;z-index:2}.step.active .step-number {background:#007bff;color:white}.step-label {font-size:0.9em;color:#6c757d;text-align:center}.step.active .step-label {color:#007bff;font-weight:bold}.section {margin-bottom:40px}.section-title {font-size:1.3em;color:#495057;margin-bottom:20px;display:flex;align-items:center}.section-title::before {content:'';width:4px;height:24px;background:#007bff;margin-right:12px;border-radius:2px}.upload-area {border:2px dashed #007bff;border-radius:8px;padding:40px;text-align:center;background:#f8f9ff;transition:all 0.3s ease;cursor:pointer}.upload-area:hover {background:#e6f3ff;border-color:#0056b3}.upload-area.dragover {background:#cce7ff;border-color:#0056b3}.upload-icon {font-size:3em;color:#007bff;margin-bottom:15px}.upload-text {font-size:1.1em;color:#495057;margin-bottom:10px}.upload-hint {color:#6c757d;font-size:0.9em}.file-input {display:none}.template-section {background:#fff3cd;border:1px solid #ffeaa7;border-radius:8px;padding:25px;margin-bottom:30px}.template-header {display:flex;justify-content:space-between;align-items:center;margin-bottom:20px}.template-title {color:#856404;font-size:1.1em;font-weight:bold}.download-template {background:#ffc107;color:#212529;padding:8px 16px;border-radius:6px;text-decoration:none;font-weight:bold;transition:all 0.3s ease}.download-template:hover {background:#e0a800;transform:translateY(-2px)}.template-preview {background:white;border-radius:6px;padding:15px;overflow-x:auto}.template-table {width:100%;border-collapse:collapse;font-size:0.85em}.template-table th, .template-table td {padding:8px 12px;border:1px solid #dee2e6;text-align:left;white-space:nowrap}.template-table th {background:#f8f9fa;font-weight:bold;color:#495057}.instructions {background:#d1ecf1;border:1px solid #bee5eb;border-radius:8px;padding:25px}.instructions h3 {color:#0c5460;margin-bottom:15px}.instructions ul {color:#0c5460;padding-left:20px}.instructions li {margin-bottom:8px}.format-guide {display:grid;grid-template-columns:repeat(auto-fit, minmax(300px, 1fr));gap:20px;margin-top:20px}.format-item {background:white;padding:20px;border-radius:8px;border:1px solid #e9ecef}.format-item h4 {color:#495057;margin-bottom:10px}.format-example {background:#f8f9fa;padding:10px;border-radius:4px;font-family:monospace;font-size:0.9em;color:#495057}.submit-section {text-align:center;padding:30px 0;border-top:1px solid #e9ecef}.btn {display:inline-block;padding:12px 24px;margin:0 10px;border-radius:6px;text-decoration:none;font-weight:bold;transition:all 0.3s ease;border:none;cursor:pointer;font-size:1em}.btn-primary {background:#007bff;color:white}.btn-secondary {background:#6c757d;color:white}.btn:hover {transform:translateY(-2px);box-shadow:0 4px 8px rgba(0,0,0,0.1)}.btn:disabled {opacity:0.6;cursor:not-allowed;transform:none}.error-message {background:#f8d7da;border:1px solid #f5c6cb;color:#721c24;padding:15px;border-radius:6px;margin-bottom:20px}@media (max-width:768px) {.import-container {margin:10px;border-radius:8px}.import-content {padding:20px}.step-indicator {flex-direction:column;gap:20px}.step::after {display:none}.format-guide {grid-template-columns:1fr}}</style></head><body><div class="import-container"><!-- 头部 --><div class="import-header"><h1>📥 批量导入练习题</h1><p>通过CSV文件快速导入大量练习题，支持所有题型</p></div><!-- 主要内容 --><div class="import-content"><!-- 步骤指示器 --><div class="step-indicator"><div class="step active"><div class="step-number">1</div><div class="step-label">下载模板</div></div><div class="step"><div class="step-number">2</div><div class="step-label">填写数据</div></div><div class="step"><div class="step-number">3</div><div class="step-label">上传文件</div></div><div class="step"><div class="step-number">4</div><div class="step-label">完成导入</div></div></div><!-- 错误信息 -->
            {% if error %}
            <div class="error-message"><strong>导入失败：</strong>{{ error }}
            </div>
            {% endif %}
            
            <!-- 模板下载区域 --><div class="section"><h2 class="section-title">📋 第一步：下载CSV模板</h2><div class="template-section"><div class="template-header"><div class="template-title">CSV导入模板</div><a href="data:text/csv;charset=utf-8,{% for item in sample_data %}{% for key, value in item.items %}{{ key }}{% if not forloop.last %},{% endif %}{% endfor %}{% if not forloop.last %}%0A{% endif %}{% endfor %}%0A{% for item in sample_data %}{% for key, value in item.items %}&quot;{{ value }}&quot;{% if not forloop.last %},{% endif %}{% endfor %}{% if not forloop.last %}%0A{% endif %}{% endfor %}" 
                           download="exercise_template.csv" class="download-template">
                            📥 下载模板文件
                        </a></div><div class="template-preview"><table class="template-table"><thead><tr><th>title</th><th>category</th><th>difficulty</th><th>question_type</th><th>question_text</th><th>option_A</th><th>option_B</th><th>correct_answer</th></tr></thead><tbody><tr><td>示例单选题</td><td>数据结构</td><td>初级</td><td>single_choice</td><td>以下哪个是正确的描述？</td><td>选项A的内容</td><td>选项B的内容</td><td>A</td></tr></tbody></table></div></div></div><!-- 格式说明 --><div class="section"><h2 class="section-title">📝 第二步：填写题目数据</h2><div class="instructions"><h3>📋 字段说明</h3><ul><li><strong>title</strong>：题目标题（必填）</li><li><strong>category</strong>：分类名称（必填，如：数据结构、算法设计）</li><li><strong>difficulty</strong>：难度等级（必填，如：初级、中级、高级）</li><li><strong>question_type</strong>：题目类型（必填，见下方说明）</li><li><strong>question_text</strong>：题目内容（必填）</li><li><strong>option_A~F</strong>：选择题选项（选择题必填）</li><li><strong>correct_answer</strong>：正确答案（必填）</li><li><strong>explanation</strong>：答案解析（可选）</li><li><strong>hint_1~5</strong>：提示信息（可选）</li><li><strong>tags</strong>：标签，用逗号分隔（可选）</li></ul></div><div class="format-guide"><div class="format-item"><h4>🔘 单选题 (single_choice)</h4><div class="format-example">
                            question_type: single_choice<br>
                            correct_answer: A
                        </div></div><div class="format-item"><h4>☑️ 多选题 (multiple_choice)</h4><div class="format-example">
                            question_type: multiple_choice<br>
                            correct_answer: A,C,D
                        </div></div><div class="format-item"><h4>✅ 判断题 (true_false)</h4><div class="format-example">
                            question_type: true_false<br>
                            correct_answer: true
                        </div></div><div class="format-item"><h4>📝 填空题 (fill_blank)</h4><div class="format-example">
                            question_type: fill_blank<br>
                            correct_answer: O(log n)
                        </div></div><div class="format-item"><h4>📄 简答题 (short_answer)</h4><div class="format-example">
                            question_type: short_answer<br>
                            correct_answer: 参考答案内容
                        </div></div><div class="format-item"><h4>💻 编程题 (coding)</h4><div class="format-example">
                            question_type: coding<br>
                            correct_answer: 标准代码
                        </div></div></div></div><!-- 文件上传区域 --><div class="section"><h2 class="section-title">📤 第三步：上传CSV文件</h2><form method="post" enctype="multipart/form-data" id="import-form">
                    {% csrf_token %}
                    <div class="upload-area" onclick="document.getElementById('csv-file').click()" 
                         ondrop="handleDrop(event)" ondragover="handleDragOver(event)" ondragleave="handleDragLeave(event)"><div class="upload-icon">📁</div><div class="upload-text">点击选择文件或拖拽文件到此处</div><div class="upload-hint">支持CSV格式，文件大小不超过10MB</div><input type="file" id="csv-file" name="csv_file" accept=".csv" class="file-input" onchange="handleFileSelect(event)"></div><div id="file-info" style="margin-top: 15px; display: none;"><p><strong>已选择文件：</strong><span id="file-name"></span></p><p><strong>文件大小：</strong><span id="file-size"></span></p></div></form></div><!-- 提交按钮 --><div class="submit-section"><button type="button" class="btn btn-secondary" onclick="window.history.back()">
                    ← 返回
                </button><button type="submit" form="import-form" class="btn btn-primary" id="submit-btn" disabled>
                    🚀 开始导入
                </button></div></div></div><script>function handleDragOver(event) { event.preventDefault(); event.currentTarget.classList.add('dragover'); } function handleDragLeave(event) { event.currentTarget.classList.remove('dragover'); } function handleDrop(event) { event.preventDefault(); event.currentTarget.classList.remove('dragover'); const files = event.dataTransfer.files; if (files.length > 0) { document.getElementById('csv-file').files = files; handleFileSelect({ target: { files: files } }); } } function handleFileSelect(event) { const file = event.target.files[0]; if (file) { document.getElementById('file-name').textContent = file.name; document.getElementById('file-size').textContent = formatFileSize(file.size); document.getElementById('file-info').style.display = 'block'; document.getElementById('submit-btn').disabled = false; document.querySelectorAll('.step')[2].classList.add('active'); } } function formatFileSize(bytes) { if (bytes === 0) return '0 Bytes'; const k = 1024; const sizes = ['Bytes', 'KB', 'MB', 'GB']; const i = Math.floor(Math.log(bytes) / Math.log(k)); return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i]; } document.getElementById('import-form').addEventListener('submit', function() { const submitBtn = document.getElementById('submit-btn'); submitBtn.disabled = true; submitBtn.innerHTML = '⏳ 导入中...'; document.querySelectorAll('.step')[3].classList.add('active'); });</script></body></html>
