{% extends 'knowledge_app/base.html' %}

{% block title %}äºŒåˆ†æŸ¥æ‰¾ç®—æ³• - è®¡ç®—æœºç§‘å­¦å­¦ä¹ å¹³å°{% endblock %}

{% block content %}
<style>
    .visualization-container {
        background: #f8f9fa;
        border-radius: 12px;
        padding: 30px;
        margin: 20px 0;
        box-shadow: 0 2px 8px rgba(0,0,0,0.1);
    }

    .concept-card {
        background: white;
        border-radius: 8px;
        padding: 20px;
        margin: 15px 0;
        border-left: 4px solid #2196F3;
    }

    .key-term {
        display: inline-block;
        background: #e3f2fd;
        padding: 4px 8px;
        border-radius: 4px;
        margin: 2px;
        font-weight: 600;
    }

    .difficulty-badge {
        display: inline-block;
        padding: 6px 12px;
        border-radius: 20px;
        font-weight: bold;
        margin: 10px 0;
    }

    .difficulty-easy {
        background: #d4edda;
        color: #155724;
    }

    .code-tabs {
        display: flex;
        gap: 10px;
        margin-bottom: 10px;
        border-bottom: 2px solid #e0e0e0;
    }

    .code-tab {
        padding: 10px 20px;
        cursor: pointer;
        background: #f5f5f5;
        border: none;
        border-radius: 8px 8px 0 0;
        transition: all 0.3s;
    }

    .code-tab.active {
        background: #2196F3;
        color: white;
    }

    .code-content {
        display: none;
        background: #2d2d2d;
        color: #f8f8f2;
        padding: 20px;
        border-radius: 0 8px 8px 8px;
        position: relative;
        font-family: 'Courier New', monospace;
        overflow-x: auto;
    }

    .code-content.active {
        display: block;
    }

    .copy-btn {
        position: absolute;
        top: 10px;
        right: 10px;
        padding: 6px 12px;
        background: #2196F3;
        color: white;
        border: none;
        border-radius: 4px;
        cursor: pointer;
        font-size: 12px;
    }

    .copy-btn:hover {
        background: #1976D2;
    }

    #binaryCanvas {
        border: 2px solid #ddd;
        border-radius: 8px;
        margin: 20px auto;
        display: block;
        background: white;
    }

    .array-container {
        display: flex;
        justify-content: center;
        align-items: center;
        flex-wrap: wrap;
        margin: 20px 0;
        gap: 5px;
    }

    .array-element {
        width: 50px;
        height: 50px;
        display: flex;
        align-items: center;
        justify-content: center;
        border: 2px solid #ddd;
        border-radius: 8px;
        font-weight: bold;
        font-size: 18px;
        transition: all 0.3s;
        position: relative;
    }

    .array-element.left-bound {
        border-color: #4CAF50;
        background: #e8f5e9;
    }

    .array-element.right-bound {
        border-color: #f44336;
        background: #ffebee;
    }

    .array-element.mid {
        border-color: #FF9800;
        background: #fff3e0;
        transform: scale(1.1);
    }

    .array-element.found {
        border-color: #9C27B0;
        background: #f3e5f5;
        animation: pulse 0.5s;
    }

    .array-element.eliminated {
        opacity: 0.3;
        background: #f5f5f5;
    }

    .array-index {
        position: absolute;
        bottom: -20px;
        font-size: 12px;
        color: #666;
    }

    @keyframes pulse {
        0% { transform: scale(1); }
        50% { transform: scale(1.2); }
        100% { transform: scale(1); }
    }

    .control-panel {
        text-align: center;
        margin: 20px 0;
        display: flex;
        flex-wrap: wrap;
        justify-content: center;
        gap: 10px;
    }

    .control-btn {
        padding: 10px 20px;
        background: #2196F3;
        color: white;
        border: none;
        border-radius: 6px;
        cursor: pointer;
        font-size: 14px;
        transition: all 0.3s;
    }

    .control-btn:hover {
        background: #1976D2;
        transform: translateY(-2px);
    }

    .control-btn.secondary {
        background: #4CAF50;
    }

    .control-btn.secondary:hover {
        background: #45a049;
    }

    .control-btn.danger {
        background: #f44336;
    }

    .control-btn.danger:hover {
        background: #da190b;
    }

    .input-group {
        display: inline-flex;
        align-items: center;
        gap: 10px;
        margin: 10px;
    }

    .input-field {
        padding: 8px 12px;
        border: 2px solid #2196F3;
        border-radius: 6px;
        font-size: 14px;
    }

    .stats-panel {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
        gap: 15px;
        margin: 20px 0;
    }

    .stat-card {
        background: white;
        padding: 15px;
        border-radius: 8px;
        text-align: center;
        box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    }

    .stat-value {
        font-size: 24px;
        font-weight: bold;
        color: #2196F3;
    }

    .stat-label {
        font-size: 12px;
        color: #666;
        margin-top: 5px;
    }

    .comparison-box {
        background: #f0f0f0;
        padding: 20px;
        border-radius: 8px;
        margin: 20px 0;
        text-align: center;
    }

    .comparison-box h3 {
        margin-bottom: 15px;
        color: #333;
    }

    .comparison-result {
        font-size: 24px;
        font-weight: bold;
        margin: 10px 0;
    }

    .speed-control {
        display: inline-block;
        margin: 0 15px;
    }

    .speed-control label {
        margin-right: 10px;
        font-weight: 600;
    }

    .quiz-item {
        background: #f8f9fa;
        padding: 20px;
        margin: 15px 0;
        border-radius: 8px;
        border: 2px solid #e9ecef;
    }

    .quiz-question {
        font-weight: 600;
        margin-bottom: 10px;
        color: #333;
    }

    .show-answer-btn {
        padding: 8px 16px;
        background: #17a2b8;
        color: white;
        border: none;
        border-radius: 4px;
        cursor: pointer;
        margin-top: 10px;
    }

    .quiz-answer {
        display: none;
        background: #d4edda;
        padding: 15px;
        border-radius: 6px;
        margin-top: 10px;
        border-left: 4px solid #28a745;
    }

    .analogy-box {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
        padding: 25px;
        border-radius: 12px;
        margin: 20px 0;
    }

    .application-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
        gap: 20px;
        margin: 20px 0;
    }

    .app-card {
        background: white;
        padding: 20px;
        border-radius: 8px;
        box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        transition: transform 0.3s;
    }

    .app-card:hover {
        transform: translateY(-5px);
        box-shadow: 0 4px 8px rgba(0,0,0,0.15);
    }

    .highlight {
        background: #ffeb3b;
        padding: 2px 4px;
        border-radius: 3px;
    }

    .formula-box {
        background: #f0f0f0;
        padding: 20px;
        border-radius: 8px;
        text-align: center;
        font-size: 18px;
        margin: 20px 0;
        font-family: 'Courier New', monospace;
    }

    .algorithm-step {
        background: #f8f9fa;
        padding: 15px;
        margin: 10px 0;
        border-radius: 8px;
        border-left: 4px solid #2196F3;
    }

    .step-number {
        display: inline-block;
        width: 30px;
        height: 30px;
        background: #2196F3;
        color: white;
        border-radius: 50%;
        text-align: center;
        line-height: 30px;
        margin-right: 10px;
        font-weight: bold;
    }

    .step-history {
        background: white;
        padding: 15px;
        border-radius: 8px;
        margin: 20px 0;
        max-height: 200px;
        overflow-y: auto;
    }

    .step-item {
        padding: 8px;
        margin: 5px 0;
        background: #f8f9fa;
        border-radius: 4px;
        border-left: 3px solid #2196F3;
    }
</style>

<div class="page-container fade-in">
    <!-- é¢åŒ…å±‘å¯¼èˆª -->
    <div class="breadcrumb">
        <a href="{% url 'knowledge_app:index' %}">é¦–é¡µ</a>
        <span>></span>
        <span>ç®—æ³•</span>
        <span>></span>
        <span>äºŒåˆ†æŸ¥æ‰¾</span>
    </div>

    <!-- é¡µé¢å¤´éƒ¨ -->
    <div class="page-header slide-in-left">
        <h1>
            <span class="page-icon">ğŸ”</span>
            äºŒåˆ†æŸ¥æ‰¾ç®—æ³•ï¼ˆBinary Searchï¼‰
        </h1>
        <p>é«˜æ•ˆæŸ¥æ‰¾çš„ç»å…¸ç®—æ³• - æ¯æ¬¡æ’é™¤ä¸€åŠçš„æœç´¢ç©ºé—´</p>
    </div>

    <!-- çŸ¥è¯†ç‚¹æ¦‚è¿° -->
    <div class="content-card slide-in-right">
        <h2 class="section-title">
            <span class="section-icon">ğŸ“‹</span>
            çŸ¥è¯†ç‚¹æ¦‚è¿°
        </h2>

        <div class="concept-card">
            <p style="font-size: 18px; line-height: 1.6;">
                <strong>æ ¸å¿ƒæ¦‚å¿µï¼š</strong>äºŒåˆ†æŸ¥æ‰¾å°±åƒåœ¨<span class="highlight">å­—å…¸é‡ŒæŸ¥å•è¯</span>ï¼Œæ¯æ¬¡æ‰“å¼€ä¸­é—´é¡µï¼Œæ ¹æ®å­—æ¯é¡ºåºå†³å®šå¾€å‰ç¿»è¿˜æ˜¯å¾€åç¿»ï¼Œæ¯æ¬¡éƒ½èƒ½æ’é™¤ä¸€åŠçš„å†…å®¹ï¼Œå¿«é€Ÿå®šä½ç›®æ ‡ï¼
            </p>

            <div style="margin: 20px 0;">
                <h4>ğŸ”¤ å…³é”®æœ¯è¯­ï¼š</h4>
                <span class="key-term">æœ‰åºæ•°ç»„</span> - å‰ææ¡ä»¶ï¼Œæ•°ç»„å¿…é¡»å·²æ’åº<br>
                <span class="key-term">æœç´¢åŒºé—´</span> - å½“å‰æŸ¥æ‰¾çš„èŒƒå›´[left, right]<br>
                <span class="key-term">ä¸­é—´å…ƒç´ </span> - mid = (left + right) / 2<br>
                <span class="key-term">æ—¶é—´å¤æ‚åº¦</span> - O(log n)ï¼Œå¯¹æ•°çº§åˆ«<br>
                <span class="key-term">ç©ºé—´å¤æ‚åº¦</span> - O(1)ï¼Œåªéœ€å‡ ä¸ªå˜é‡
            </div>

            <div class="difficulty-badge difficulty-easy">
                ğŸ“Š å­¦ä¹ éš¾åº¦ï¼šå…¥é—¨
            </div>

            <div style="margin-top: 15px;">
                <strong>å‰ç½®çŸ¥è¯†ï¼š</strong>æ•°ç»„ã€å¾ªç¯ã€æ¡ä»¶åˆ¤æ–­
            </div>
        </div>
    </div>

    <!-- æ¦‚å¿µè¯¦è§£ -->
    <div class="content-card">
        <h2 class="section-title">
            <span class="section-icon">ğŸ”</span>
            æ¦‚å¿µè¯¦è§£
        </h2>

        <div class="analogy-box">
            <h3>ğŸ“š ç”Ÿæ´»ç±»æ¯”ï¼šçŒœæ•°å­—æ¸¸æˆ</h3>
            <p>æœ‹å‹å¿ƒé‡Œæƒ³äº†1-100ä¹‹é—´çš„æ•°å­—ï¼Œè®©ä½ çŒœï¼š</p>
            <ul style="list-style: none; padding-left: 0;">
                <li>ğŸ¯ ç¬¬ä¸€æ¬¡çŒœ50ï¼Œæœ‹å‹è¯´"å¤ªå¤§äº†"</li>
                <li>â¡ï¸ èŒƒå›´ç¼©å°åˆ°1-49</li>
                <li>ğŸ¯ ç¬¬äºŒæ¬¡çŒœ25ï¼Œæœ‹å‹è¯´"å¤ªå°äº†"</li>
                <li>â¡ï¸ èŒƒå›´ç¼©å°åˆ°26-49</li>
                <li>ğŸ¯ ç»§ç»­äºŒåˆ†ï¼Œæœ€å¤š7æ¬¡å°±èƒ½çŒœä¸­ï¼ˆlogâ‚‚100 â‰ˆ 7ï¼‰</li>
                <li>ğŸ’¡ æ¯”ä»1å¼€å§‹é€ä¸ªçŒœï¼ˆæœ€å¤š100æ¬¡ï¼‰å¿«å¾—å¤šï¼</li>
            </ul>
        </div>

        <div class="concept-card">
            <h4>1ï¸âƒ£ ç®—æ³•åŸç†</h4>
            <p><strong>æ ¸å¿ƒæ€æƒ³ï¼š</strong>åˆ©ç”¨æ•°ç»„çš„æœ‰åºæ€§ï¼Œæ¯æ¬¡æ¯”è¾ƒä¸­é—´å…ƒç´ ï¼Œæ’é™¤ä¸€åŠçš„æœç´¢ç©ºé—´ã€‚</p>

            <div class="formula-box">
                mid = left + (right - left) / 2<br>
                <small>é¿å…(left + right)æº¢å‡ºçš„å†™æ³•</small>
            </div>

            <p><strong>ä¸‰ç§æƒ…å†µï¼š</strong></p>
            <ul>
                <li>arr[mid] == targetï¼šæ‰¾åˆ°ç›®æ ‡ï¼Œè¿”å›ç´¢å¼•</li>
                <li>arr[mid] < targetï¼šç›®æ ‡åœ¨å³åŠéƒ¨åˆ†ï¼Œleft = mid + 1</li>
                <li>arr[mid] > targetï¼šç›®æ ‡åœ¨å·¦åŠéƒ¨åˆ†ï¼Œright = mid - 1</li>
            </ul>
        </div>

        <div class="concept-card">
            <h4>2ï¸âƒ£ æ—¶é—´å¤æ‚åº¦åˆ†æ</h4>
            <p><strong>ä¸ºä»€ä¹ˆæ˜¯O(log n)ï¼Ÿ</strong></p>
            <ul>
                <li>ç¬¬1æ¬¡æ¯”è¾ƒåï¼Œå‰©ä½™ n/2 ä¸ªå…ƒç´ </li>
                <li>ç¬¬2æ¬¡æ¯”è¾ƒåï¼Œå‰©ä½™ n/4 ä¸ªå…ƒç´ </li>
                <li>ç¬¬3æ¬¡æ¯”è¾ƒåï¼Œå‰©ä½™ n/8 ä¸ªå…ƒç´ </li>
                <li>ç¬¬kæ¬¡æ¯”è¾ƒåï¼Œå‰©ä½™ n/2^k ä¸ªå…ƒç´ </li>
                <li>å½“ n/2^k = 1 æ—¶ï¼Œk = logâ‚‚n</li>
            </ul>

            <p><strong>å…·ä½“ä¾‹å­ï¼š</strong></p>
            <table style="width: 100%; border-collapse: collapse;">
                <tr style="background: #f0f0f0;">
                    <th style="padding: 10px; border: 1px solid #ddd;">æ•°ç»„å¤§å°</th>
                    <th style="padding: 10px; border: 1px solid #ddd;">æœ€å¤šæ¯”è¾ƒæ¬¡æ•°</th>
                    <th style="padding: 10px; border: 1px solid #ddd;">çº¿æ€§æŸ¥æ‰¾</th>
                </tr>
                <tr>
                    <td style="padding: 10px; border: 1px solid #ddd;">10</td>
                    <td style="padding: 10px; border: 1px solid #ddd;">4</td>
                    <td style="padding: 10px; border: 1px solid #ddd;">10</td>
                </tr>
                <tr>
                    <td style="padding: 10px; border: 1px solid #ddd;">100</td>
                    <td style="padding: 10px; border: 1px solid #ddd;">7</td>
                    <td style="padding: 10px; border: 1px solid #ddd;">100</td>
                </tr>
                <tr>
                    <td style="padding: 10px; border: 1px solid #ddd;">1,000</td>
                    <td style="padding: 10px; border: 1px solid #ddd;">10</td>
                    <td style="padding: 10px; border: 1px solid #ddd;">1,000</td>
                </tr>
                <tr>
                    <td style="padding: 10px; border: 1px solid #ddd;">1,000,000</td>
                    <td style="padding: 10px; border: 1px solid #ddd;">20</td>
                    <td style="padding: 10px; border: 1px solid #ddd;">1,000,000</td>
                </tr>
            </table>
        </div>

        <div class="concept-card">
            <h4>3ï¸âƒ£ ç®—æ³•æ‰§è¡Œæ­¥éª¤</h4>
            <div class="algorithm-step">
                <span class="step-number">1</span>
                åˆå§‹åŒ–ï¼šleft = 0, right = n - 1
            </div>
            <div class="algorithm-step">
                <span class="step-number">2</span>
                è®¡ç®—ä¸­é—´ä½ç½®ï¼šmid = left + (right - left) / 2
            </div>
            <div class="algorithm-step">
                <span class="step-number">3</span>
                æ¯”è¾ƒarr[mid]ä¸target
            </div>
            <div class="algorithm-step">
                <span class="step-number">4</span>
                æ ¹æ®æ¯”è¾ƒç»“æœè°ƒæ•´leftæˆ–right
            </div>
            <div class="algorithm-step">
                <span class="step-number">5</span>
                é‡å¤2-4ç›´åˆ°æ‰¾åˆ°æˆ–left > right
            </div>
        </div>

        <div class="concept-card" style="background: #fff3cd; border-left-color: #ffc107;">
            <h4>âš ï¸ åˆå­¦è€…æ˜“é”™ç‚¹</h4>
            <ul>
                <li><strong>è¾¹ç•Œæ¡ä»¶ï¼š</strong>æ˜¯ left <= right è¿˜æ˜¯ left < rightï¼Ÿ</li>
                <li><strong>æ›´æ–°è¾¹ç•Œï¼š</strong>æ˜¯ mid è¿˜æ˜¯ mid Â± 1ï¼Ÿ</li>
                <li><strong>æ•´æ•°æº¢å‡ºï¼š</strong>mid = (left + right) / 2 å¯èƒ½æº¢å‡º</li>
                <li><strong>æ•°ç»„å¿…é¡»æœ‰åºï¼š</strong>è¿™æ˜¯å‰ææ¡ä»¶ï¼</li>
                <li><strong>é‡å¤å…ƒç´ ï¼š</strong>æ ‡å‡†äºŒåˆ†æ‰¾åˆ°çš„å¯èƒ½ä¸æ˜¯ç¬¬ä¸€ä¸ª</li>
            </ul>
        </div>
    </div>

    <!-- å¯è§†åŒ–å±•ç¤º -->
    <div class="content-card">
        <h2 class="section-title">
            <span class="section-icon">ğŸ“Š</span>
            å¯è§†åŒ–å±•ç¤º
        </h2>

        <div class="visualization-container">
            <h3 style="text-align: center;">ğŸ¯ äºŒåˆ†æŸ¥æ‰¾åŠ¨æ€æ¼”ç¤º</h3>

            <div class="input-group">
                <label>æŸ¥æ‰¾ç›®æ ‡ï¼š</label>
                <input type="number" id="targetInput" class="input-field" value="42" min="1" max="100">
                <button class="control-btn" onclick="startSearch()">ğŸ” å¼€å§‹æŸ¥æ‰¾</button>
            </div>

            <div class="input-group">
                <label>æ•°ç»„å¤§å°ï¼š</label>
                <select id="arraySizeSelect" class="input-field" onchange="generateArray()">
                    <option value="10">10ä¸ªå…ƒç´ </option>
                    <option value="15" selected>15ä¸ªå…ƒç´ </option>
                    <option value="20">20ä¸ªå…ƒç´ </option>
                    <option value="30">30ä¸ªå…ƒç´ </option>
                </select>
            </div>

            <canvas id="binaryCanvas" width="800" height="400"></canvas>

            <div class="array-container" id="arrayContainer">
                <!-- åŠ¨æ€ç”Ÿæˆæ•°ç»„å…ƒç´  -->
            </div>

            <div class="comparison-box">
                <h3>å½“å‰æ¯”è¾ƒ</h3>
                <div id="comparisonInfo">
                    <p>ç­‰å¾…å¼€å§‹æŸ¥æ‰¾...</p>
                </div>
            </div>

            <div class="control-panel">
                <button class="control-btn" onclick="stepSearch()">â­ï¸ å•æ­¥æ‰§è¡Œ</button>
                <button class="control-btn secondary" onclick="resetSearch()">ğŸ”„ é‡ç½®</button>
                <button class="control-btn secondary" onclick="generateArray()">ğŸ² éšæœºæ•°ç»„</button>

                <div class="speed-control">
                    <label for="speedSlider">é€Ÿåº¦ï¼š</label>
                    <input type="range" id="speedSlider" min="300" max="2000" value="1000" step="100">
                    <span id="speedValue">1000ms</span>
                </div>
            </div>

            <div class="stats-panel">
                <div class="stat-card">
                    <div class="stat-value" id="stepCount">0</div>
                    <div class="stat-label">æ¯”è¾ƒæ¬¡æ•°</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="leftBound">-</div>
                    <div class="stat-label">å·¦è¾¹ç•Œ</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="rightBound">-</div>
                    <div class="stat-label">å³è¾¹ç•Œ</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="midPoint">-</div>
                    <div class="stat-label">ä¸­é—´ä½ç½®</div>
                </div>
            </div>

            <div class="step-history">
                <h4>æŸ¥æ‰¾å†å²</h4>
                <div id="stepHistory">
                    <!-- åŠ¨æ€ç”Ÿæˆæ­¥éª¤å†å² -->
                </div>
            </div>
        </div>
    </div>

    <!-- ä»£ç ç¤ºä¾‹ -->
    <div class="content-card">
        <h2 class="section-title">
            <span class="section-icon">ğŸ’»</span>
            ä»£ç å®ç°
        </h2>

        <div class="code-tabs">
            <button class="code-tab active" onclick="switchCode('python', event)">Python</button>
            <button class="code-tab" onclick="switchCode('cpp', event)">C++</button>
            <button class="code-tab" onclick="switchCode('java', event)">Java</button>
        </div>

        <div id="python-code" class="code-content active">
            <button class="copy-btn" onclick="copyCode('python', event)">ğŸ“‹ å¤åˆ¶ä»£ç </button>
            <pre><code>def binary_search(arr, target):
    """
    æ ‡å‡†äºŒåˆ†æŸ¥æ‰¾
    Args:
        arr: æœ‰åºæ•°ç»„
        target: æŸ¥æ‰¾ç›®æ ‡
    Returns:
        ç›®æ ‡å…ƒç´ çš„ç´¢å¼•ï¼Œå¦‚æœä¸å­˜åœ¨è¿”å›-1
    """
    left, right = 0, len(arr) - 1

    while left <= right:
        # é˜²æ­¢æº¢å‡ºçš„å†™æ³•
        mid = left + (right - left) // 2

        if arr[mid] == target:
            return mid  # æ‰¾åˆ°ç›®æ ‡
        elif arr[mid] < target:
            left = mid + 1  # ç›®æ ‡åœ¨å³åŠéƒ¨åˆ†
        else:
            right = mid - 1  # ç›®æ ‡åœ¨å·¦åŠéƒ¨åˆ†

    return -1  # æœªæ‰¾åˆ°


def binary_search_recursive(arr, target, left=0, right=None):
    """
    é€’å½’ç‰ˆæœ¬çš„äºŒåˆ†æŸ¥æ‰¾
    """
    if right is None:
        right = len(arr) - 1

    if left > right:
        return -1

    mid = left + (right - left) // 2

    if arr[mid] == target:
        return mid
    elif arr[mid] < target:
        return binary_search_recursive(arr, target, mid + 1, right)
    else:
        return binary_search_recursive(arr, target, left, mid - 1)


def binary_search_first(arr, target):
    """
    æŸ¥æ‰¾ç¬¬ä¸€ä¸ªç­‰äºtargetçš„å…ƒç´ 
    ç”¨äºå¤„ç†æœ‰é‡å¤å…ƒç´ çš„æƒ…å†µ
    """
    left, right = 0, len(arr) - 1
    result = -1

    while left <= right:
        mid = left + (right - left) // 2

        if arr[mid] == target:
            result = mid
            right = mid - 1  # ç»§ç»­åœ¨å·¦è¾¹æŸ¥æ‰¾
        elif arr[mid] < target:
            left = mid + 1
        else:
            right = mid - 1

    return result


def binary_search_last(arr, target):
    """
    æŸ¥æ‰¾æœ€åä¸€ä¸ªç­‰äºtargetçš„å…ƒç´ 
    """
    left, right = 0, len(arr) - 1
    result = -1

    while left <= right:
        mid = left + (right - left) // 2

        if arr[mid] == target:
            result = mid
            left = mid + 1  # ç»§ç»­åœ¨å³è¾¹æŸ¥æ‰¾
        elif arr[mid] < target:
            left = mid + 1
        else:
            right = mid - 1

    return result


def binary_search_insert_position(arr, target):
    """
    æŸ¥æ‰¾æ’å…¥ä½ç½®
    è¿”å›targetåº”è¯¥æ’å…¥çš„ä½ç½®ï¼Œä¿æŒæ•°ç»„æœ‰åº
    """
    left, right = 0, len(arr)

    while left < right:
        mid = left + (right - left) // 2

        if arr[mid] < target:
            left = mid + 1
        else:
            right = mid

    return left


def binary_search_range(arr, target):
    """
    æŸ¥æ‰¾ç›®æ ‡å…ƒç´ çš„èŒƒå›´ [first, last]
    """
    first = binary_search_first(arr, target)
    if first == -1:
        return [-1, -1]

    last = binary_search_last(arr, target)
    return [first, last]


def binary_search_rotated(arr, target):
    """
    åœ¨æ—‹è½¬æ’åºæ•°ç»„ä¸­æŸ¥æ‰¾
    ä¾‹å¦‚ï¼š[4,5,6,7,0,1,2]
    """
    left, right = 0, len(arr) - 1

    while left <= right:
        mid = left + (right - left) // 2

        if arr[mid] == target:
            return mid

        # åˆ¤æ–­å“ªä¸€åŠæ˜¯æœ‰åºçš„
        if arr[left] <= arr[mid]:  # å·¦åŠéƒ¨åˆ†æœ‰åº
            if arr[left] <= target < arr[mid]:
                right = mid - 1
            else:
                left = mid + 1
        else:  # å³åŠéƒ¨åˆ†æœ‰åº
            if arr[mid] < target <= arr[right]:
                left = mid + 1
            else:
                right = mid - 1

    return -1


def binary_search_peak(arr):
    """
    å¯»æ‰¾å³°å€¼å…ƒç´ 
    å³°å€¼ï¼šå¤§äºå·¦å³ç›¸é‚»å…ƒç´ çš„å…ƒç´ 
    """
    left, right = 0, len(arr) - 1

    while left < right:
        mid = left + (right - left) // 2

        if arr[mid] < arr[mid + 1]:
            left = mid + 1  # å³°å€¼åœ¨å³è¾¹
        else:
            right = mid  # å³°å€¼åœ¨å·¦è¾¹æˆ–å°±æ˜¯mid

    return left


def binary_search_2d_matrix(matrix, target):
    """
    åœ¨äºŒç»´çŸ©é˜µä¸­æŸ¥æ‰¾
    çŸ©é˜µæ¯è¡Œé€’å¢ï¼Œæ¯è¡Œçš„ç¬¬ä¸€ä¸ªå…ƒç´ å¤§äºä¸Šä¸€è¡Œçš„æœ€åä¸€ä¸ªå…ƒç´ 
    """
    if not matrix or not matrix[0]:
        return False

    m, n = len(matrix), len(matrix[0])
    left, right = 0, m * n - 1

    while left <= right:
        mid = left + (right - left) // 2
        # å°†ä¸€ç»´ç´¢å¼•è½¬æ¢ä¸ºäºŒç»´åæ ‡
        row, col = mid // n, mid % n

        if matrix[row][col] == target:
            return True
        elif matrix[row][col] < target:
            left = mid + 1
        else:
            right = mid - 1

    return False


# æµ‹è¯•ç¤ºä¾‹
if __name__ == "__main__":
    # åŸºç¡€æµ‹è¯•
    arr = [1, 3, 5, 7, 9, 11, 13, 15, 17, 19]
    print("æ•°ç»„:", arr)

    # æ ‡å‡†äºŒåˆ†æŸ¥æ‰¾
    target = 7
    result = binary_search(arr, target)
    print(f"æŸ¥æ‰¾ {target}: ç´¢å¼• = {result}")

    # é€’å½’ç‰ˆæœ¬
    result = binary_search_recursive(arr, target)
    print(f"é€’å½’æŸ¥æ‰¾ {target}: ç´¢å¼• = {result}")

    # æœ‰é‡å¤å…ƒç´ çš„æƒ…å†µ
    arr_dup = [1, 2, 2, 2, 3, 4, 4, 5]
    print(f"\næœ‰é‡å¤å…ƒç´ çš„æ•°ç»„: {arr_dup}")
    print(f"ç¬¬ä¸€ä¸ª2çš„ä½ç½®: {binary_search_first(arr_dup, 2)}")
    print(f"æœ€åä¸€ä¸ª2çš„ä½ç½®: {binary_search_last(arr_dup, 2)}")
    print(f"2çš„èŒƒå›´: {binary_search_range(arr_dup, 2)}")

    # æ’å…¥ä½ç½®
    print(f"\næ’å…¥3.5çš„ä½ç½®: {binary_search_insert_position(arr, 8)}")

    # æ—‹è½¬æ•°ç»„
    rotated = [4, 5, 6, 7, 0, 1, 2]
    print(f"\næ—‹è½¬æ•°ç»„: {rotated}")
    print(f"æŸ¥æ‰¾0: {binary_search_rotated(rotated, 0)}")

    # å¯»æ‰¾å³°å€¼
    peak_arr = [1, 2, 3, 1]
    print(f"\næ•°ç»„ {peak_arr} çš„å³°å€¼ç´¢å¼•: {binary_search_peak(peak_arr)}")</code></pre>
        </div>

        <div id="cpp-code" class="code-content">
            <button class="copy-btn" onclick="copyCode('cpp', event)">ğŸ“‹ å¤åˆ¶ä»£ç </button>
            <pre><code>#include &lt;iostream&gt;
#include &lt;vector&gt;
#include &lt;algorithm&gt;
using namespace std;

// æ ‡å‡†äºŒåˆ†æŸ¥æ‰¾
int binarySearch(vector&lt;int&gt;& arr, int target) {
    int left = 0, right = arr.size() - 1;

    while (left &lt;= right) {
        int mid = left + (right - left) / 2;  // é˜²æ­¢æº¢å‡º

        if (arr[mid] == target) {
            return mid;  // æ‰¾åˆ°ç›®æ ‡
        } else if (arr[mid] &lt; target) {
            left = mid + 1;  // ç›®æ ‡åœ¨å³åŠéƒ¨åˆ†
        } else {
            right = mid - 1;  // ç›®æ ‡åœ¨å·¦åŠéƒ¨åˆ†
        }
    }

    return -1;  // æœªæ‰¾åˆ°
}

// é€’å½’ç‰ˆæœ¬
int binarySearchRecursive(vector&lt;int&gt;& arr, int target, int left, int right) {
    if (left &gt; right) {
        return -1;
    }

    int mid = left + (right - left) / 2;

    if (arr[mid] == target) {
        return mid;
    } else if (arr[mid] &lt; target) {
        return binarySearchRecursive(arr, target, mid + 1, right);
    } else {
        return binarySearchRecursive(arr, target, left, mid - 1);
    }
}

// æŸ¥æ‰¾ç¬¬ä¸€ä¸ªç­‰äºtargetçš„å…ƒç´ 
int binarySearchFirst(vector&lt;int&gt;& arr, int target) {
    int left = 0, right = arr.size() - 1;
    int result = -1;

    while (left &lt;= right) {
        int mid = left + (right - left) / 2;

        if (arr[mid] == target) {
            result = mid;
            right = mid - 1;  // ç»§ç»­åœ¨å·¦è¾¹æŸ¥æ‰¾
        } else if (arr[mid] &lt; target) {
            left = mid + 1;
        } else {
            right = mid - 1;
        }
    }

    return result;
}

// æŸ¥æ‰¾æœ€åä¸€ä¸ªç­‰äºtargetçš„å…ƒç´ 
int binarySearchLast(vector&lt;int&gt;& arr, int target) {
    int left = 0, right = arr.size() - 1;
    int result = -1;

    while (left &lt;= right) {
        int mid = left + (right - left) / 2;

        if (arr[mid] == target) {
            result = mid;
            left = mid + 1;  // ç»§ç»­åœ¨å³è¾¹æŸ¥æ‰¾
        } else if (arr[mid] &lt; target) {
            left = mid + 1;
        } else {
            right = mid - 1;
        }
    }

    return result;
}

// æŸ¥æ‰¾æ’å…¥ä½ç½®
int searchInsertPosition(vector&lt;int&gt;& arr, int target) {
    int left = 0, right = arr.size();

    while (left &lt; right) {
        int mid = left + (right - left) / 2;

        if (arr[mid] &lt; target) {
            left = mid + 1;
        } else {
            right = mid;
        }
    }

    return left;
}

// æŸ¥æ‰¾å…ƒç´ èŒƒå›´
vector&lt;int&gt; searchRange(vector&lt;int&gt;& arr, int target) {
    int first = binarySearchFirst(arr, target);
    if (first == -1) {
        return {-1, -1};
    }

    int last = binarySearchLast(arr, target);
    return {first, last};
}

// åœ¨æ—‹è½¬æ’åºæ•°ç»„ä¸­æŸ¥æ‰¾
int searchRotated(vector&lt;int&gt;& arr, int target) {
    int left = 0, right = arr.size() - 1;

    while (left &lt;= right) {
        int mid = left + (right - left) / 2;

        if (arr[mid] == target) {
            return mid;
        }

        // åˆ¤æ–­å“ªä¸€åŠæ˜¯æœ‰åºçš„
        if (arr[left] &lt;= arr[mid]) {  // å·¦åŠéƒ¨åˆ†æœ‰åº
            if (arr[left] &lt;= target && target &lt; arr[mid]) {
                right = mid - 1;
            } else {
                left = mid + 1;
            }
        } else {  // å³åŠéƒ¨åˆ†æœ‰åº
            if (arr[mid] &lt; target && target &lt;= arr[right]) {
                left = mid + 1;
            } else {
                right = mid - 1;
            }
        }
    }

    return -1;
}

// å¯»æ‰¾å³°å€¼
int findPeakElement(vector&lt;int&gt;& arr) {
    int left = 0, right = arr.size() - 1;

    while (left &lt; right) {
        int mid = left + (right - left) / 2;

        if (arr[mid] &lt; arr[mid + 1]) {
            left = mid + 1;  // å³°å€¼åœ¨å³è¾¹
        } else {
            right = mid;  // å³°å€¼åœ¨å·¦è¾¹æˆ–å°±æ˜¯mid
        }
    }

    return left;
}

// äºŒåˆ†æŸ¥æ‰¾æ¨¡æ¿ç±»ï¼ˆæ”¯æŒè‡ªå®šä¹‰æ¯”è¾ƒï¼‰
template&lt;typename T&gt;
class BinarySearcher {
public:
    // æ ‡å‡†äºŒåˆ†æŸ¥æ‰¾
    static int search(const vector&lt;T&gt;& arr, const T& target) {
        int left = 0, right = arr.size() - 1;

        while (left &lt;= right) {
            int mid = left + (right - left) / 2;

            if (arr[mid] == target) {
                return mid;
            } else if (arr[mid] &lt; target) {
                left = mid + 1;
            } else {
                right = mid - 1;
            }
        }

        return -1;
    }

    // ä½¿ç”¨è‡ªå®šä¹‰æ¯”è¾ƒå‡½æ•°
    template&lt;typename Compare&gt;
    static int searchWithCompare(const vector&lt;T&gt;& arr, const T& target, Compare comp) {
        int left = 0, right = arr.size() - 1;

        while (left &lt;= right) {
            int mid = left + (right - left) / 2;

            if (!comp(arr[mid], target) && !comp(target, arr[mid])) {
                return mid;  // ç›¸ç­‰
            } else if (comp(arr[mid], target)) {
                left = mid + 1;
            } else {
                right = mid - 1;
            }
        }

        return -1;
    }
};

// æ‰“å°æ•°ç»„
void printArray(const vector&lt;int&gt;& arr) {
    for (int x : arr) {
        cout &lt;&lt; x &lt;&lt; " ";
    }
    cout &lt;&lt; endl;
}

int main() {
    // åŸºç¡€æµ‹è¯•
    vector&lt;int&gt; arr = {1, 3, 5, 7, 9, 11, 13, 15, 17, 19};
    cout &lt;&lt; "æ•°ç»„: ";
    printArray(arr);

    // æ ‡å‡†äºŒåˆ†æŸ¥æ‰¾
    int target = 7;
    int result = binarySearch(arr, target);
    cout &lt;&lt; "æŸ¥æ‰¾ " &lt;&lt; target &lt;&lt; ": ç´¢å¼• = " &lt;&lt; result &lt;&lt; endl;

    // é€’å½’ç‰ˆæœ¬
    result = binarySearchRecursive(arr, target, 0, arr.size() - 1);
    cout &lt;&lt; "é€’å½’æŸ¥æ‰¾ " &lt;&lt; target &lt;&lt; ": ç´¢å¼• = " &lt;&lt; result &lt;&lt; endl;

    // æœ‰é‡å¤å…ƒç´ 
    vector&lt;int&gt; arrDup = {1, 2, 2, 2, 3, 4, 4, 5};
    cout &lt;&lt; "\næœ‰é‡å¤å…ƒç´ çš„æ•°ç»„: ";
    printArray(arrDup);
    cout &lt;&lt; "ç¬¬ä¸€ä¸ª2çš„ä½ç½®: " &lt;&lt; binarySearchFirst(arrDup, 2) &lt;&lt; endl;
    cout &lt;&lt; "æœ€åä¸€ä¸ª2çš„ä½ç½®: " &lt;&lt; binarySearchLast(arrDup, 2) &lt;&lt; endl;

    auto range = searchRange(arrDup, 2);
    cout &lt;&lt; "2çš„èŒƒå›´: [" &lt;&lt; range[0] &lt;&lt; ", " &lt;&lt; range[1] &lt;&lt; "]" &lt;&lt; endl;

    // æ’å…¥ä½ç½®
    cout &lt;&lt; "\nåœ¨åŸæ•°ç»„ä¸­æ’å…¥8çš„ä½ç½®: " &lt;&lt; searchInsertPosition(arr, 8) &lt;&lt; endl;

    // æ—‹è½¬æ•°ç»„
    vector&lt;int&gt; rotated = {4, 5, 6, 7, 0, 1, 2};
    cout &lt;&lt; "\næ—‹è½¬æ•°ç»„: ";
    printArray(rotated);
    cout &lt;&lt; "æŸ¥æ‰¾0: " &lt;&lt; searchRotated(rotated, 0) &lt;&lt; endl;

    // å¯»æ‰¾å³°å€¼
    vector&lt;int&gt; peakArr = {1, 2, 3, 1};
    cout &lt;&lt; "\næ•°ç»„ ";
    printArray(peakArr);
    cout &lt;&lt; "å³°å€¼ç´¢å¼•: " &lt;&lt; findPeakElement(peakArr) &lt;&lt; endl;

    // ä½¿ç”¨æ¨¡æ¿ç±»
    cout &lt;&lt; "\nä½¿ç”¨æ¨¡æ¿ç±»æŸ¥æ‰¾: " &lt;&lt; BinarySearcher&lt;int&gt;::search(arr, 13) &lt;&lt; endl;

    return 0;
}</code></pre>
        </div>

        <div id="java-code" class="code-content">
            <button class="copy-btn" onclick="copyCode('java', event)">ğŸ“‹ å¤åˆ¶ä»£ç </button>
            <pre><code>import java.util.*;

public class BinarySearch {

    // æ ‡å‡†äºŒåˆ†æŸ¥æ‰¾
    public static int binarySearch(int[] arr, int target) {
        int left = 0, right = arr.length - 1;

        while (left &lt;= right) {
            int mid = left + (right - left) / 2;  // é˜²æ­¢æº¢å‡º

            if (arr[mid] == target) {
                return mid;  // æ‰¾åˆ°ç›®æ ‡
            } else if (arr[mid] &lt; target) {
                left = mid + 1;  // ç›®æ ‡åœ¨å³åŠéƒ¨åˆ†
            } else {
                right = mid - 1;  // ç›®æ ‡åœ¨å·¦åŠéƒ¨åˆ†
            }
        }

        return -1;  // æœªæ‰¾åˆ°
    }

    // é€’å½’ç‰ˆæœ¬
    public static int binarySearchRecursive(int[] arr, int target, int left, int right) {
        if (left &gt; right) {
            return -1;
        }

        int mid = left + (right - left) / 2;

        if (arr[mid] == target) {
            return mid;
        } else if (arr[mid] &lt; target) {
            return binarySearchRecursive(arr, target, mid + 1, right);
        } else {
            return binarySearchRecursive(arr, target, left, mid - 1);
        }
    }

    // æŸ¥æ‰¾ç¬¬ä¸€ä¸ªç­‰äºtargetçš„å…ƒç´ 
    public static int binarySearchFirst(int[] arr, int target) {
        int left = 0, right = arr.length - 1;
        int result = -1;

        while (left &lt;= right) {
            int mid = left + (right - left) / 2;

            if (arr[mid] == target) {
                result = mid;
                right = mid - 1;  // ç»§ç»­åœ¨å·¦è¾¹æŸ¥æ‰¾
            } else if (arr[mid] &lt; target) {
                left = mid + 1;
            } else {
                right = mid - 1;
            }
        }

        return result;
    }

    // æŸ¥æ‰¾æœ€åä¸€ä¸ªç­‰äºtargetçš„å…ƒç´ 
    public static int binarySearchLast(int[] arr, int target) {
        int left = 0, right = arr.length - 1;
        int result = -1;

        while (left &lt;= right) {
            int mid = left + (right - left) / 2;

            if (arr[mid] == target) {
                result = mid;
                left = mid + 1;  // ç»§ç»­åœ¨å³è¾¹æŸ¥æ‰¾
            } else if (arr[mid] &lt; target) {
                left = mid + 1;
            } else {
                right = mid - 1;
            }
        }

        return result;
    }

    // æŸ¥æ‰¾æ’å…¥ä½ç½®
    public static int searchInsertPosition(int[] arr, int target) {
        int left = 0, right = arr.length;

        while (left &lt; right) {
            int mid = left + (right - left) / 2;

            if (arr[mid] &lt; target) {
                left = mid + 1;
            } else {
                right = mid;
            }
        }

        return left;
    }

    // æŸ¥æ‰¾å…ƒç´ èŒƒå›´
    public static int[] searchRange(int[] arr, int target) {
        int first = binarySearchFirst(arr, target);
        if (first == -1) {
            return new int[]{-1, -1};
        }

        int last = binarySearchLast(arr, target);
        return new int[]{first, last};
    }

    // åœ¨æ—‹è½¬æ’åºæ•°ç»„ä¸­æŸ¥æ‰¾
    public static int searchRotated(int[] arr, int target) {
        int left = 0, right = arr.length - 1;

        while (left &lt;= right) {
            int mid = left + (right - left) / 2;

            if (arr[mid] == target) {
                return mid;
            }

            // åˆ¤æ–­å“ªä¸€åŠæ˜¯æœ‰åºçš„
            if (arr[left] &lt;= arr[mid]) {  // å·¦åŠéƒ¨åˆ†æœ‰åº
                if (arr[left] &lt;= target && target &lt; arr[mid]) {
                    right = mid - 1;
                } else {
                    left = mid + 1;
                }
            } else {  // å³åŠéƒ¨åˆ†æœ‰åº
                if (arr[mid] &lt; target && target &lt;= arr[right]) {
                    left = mid + 1;
                } else {
                    right = mid - 1;
                }
            }
        }

        return -1;
    }

    // å¯»æ‰¾å³°å€¼
    public static int findPeakElement(int[] arr) {
        int left = 0, right = arr.length - 1;

        while (left &lt; right) {
            int mid = left + (right - left) / 2;

            if (arr[mid] &lt; arr[mid + 1]) {
                left = mid + 1;  // å³°å€¼åœ¨å³è¾¹
            } else {
                right = mid;  // å³°å€¼åœ¨å·¦è¾¹æˆ–å°±æ˜¯mid
            }
        }

        return left;
    }

    // äºŒåˆ†æŸ¥æ‰¾çš„æ³›å‹å®ç°
    public static &lt;T extends Comparable&lt;T&gt;&gt; int binarySearchGeneric(T[] arr, T target) {
        int left = 0, right = arr.length - 1;

        while (left &lt;= right) {
            int mid = left + (right - left) / 2;
            int cmp = arr[mid].compareTo(target);

            if (cmp == 0) {
                return mid;
            } else if (cmp &lt; 0) {
                left = mid + 1;
            } else {
                right = mid - 1;
            }
        }

        return -1;
    }

    // æ‰“å°æ•°ç»„
    public static void printArray(int[] arr) {
        System.out.println(Arrays.toString(arr));
    }

    public static void main(String[] args) {
        // åŸºç¡€æµ‹è¯•
        int[] arr = {1, 3, 5, 7, 9, 11, 13, 15, 17, 19};
        System.out.print("æ•°ç»„: ");
        printArray(arr);

        // æ ‡å‡†äºŒåˆ†æŸ¥æ‰¾
        int target = 7;
        int result = binarySearch(arr, target);
        System.out.println("æŸ¥æ‰¾ " + target + ": ç´¢å¼• = " + result);

        // é€’å½’ç‰ˆæœ¬
        result = binarySearchRecursive(arr, target, 0, arr.length - 1);
        System.out.println("é€’å½’æŸ¥æ‰¾ " + target + ": ç´¢å¼• = " + result);

        // æœ‰é‡å¤å…ƒç´ 
        int[] arrDup = {1, 2, 2, 2, 3, 4, 4, 5};
        System.out.print("\næœ‰é‡å¤å…ƒç´ çš„æ•°ç»„: ");
        printArray(arrDup);
        System.out.println("ç¬¬ä¸€ä¸ª2çš„ä½ç½®: " + binarySearchFirst(arrDup, 2));
        System.out.println("æœ€åä¸€ä¸ª2çš„ä½ç½®: " + binarySearchLast(arrDup, 2));

        int[] range = searchRange(arrDup, 2);
        System.out.println("2çš„èŒƒå›´: " + Arrays.toString(range));

        // æ’å…¥ä½ç½®
        System.out.println("\nåœ¨åŸæ•°ç»„ä¸­æ’å…¥8çš„ä½ç½®: " + searchInsertPosition(arr, 8));

        // æ—‹è½¬æ•°ç»„
        int[] rotated = {4, 5, 6, 7, 0, 1, 2};
        System.out.print("\næ—‹è½¬æ•°ç»„: ");
        printArray(rotated);
        System.out.println("æŸ¥æ‰¾0: " + searchRotated(rotated, 0));

        // å¯»æ‰¾å³°å€¼
        int[] peakArr = {1, 2, 3, 1};
        System.out.print("\næ•°ç»„ ");
        printArray(peakArr);
        System.out.println("å³°å€¼ç´¢å¼•: " + findPeakElement(peakArr));

        // ä½¿ç”¨æ³›å‹
        Integer[] integerArr = {1, 3, 5, 7, 9};
        System.out.println("\næ³›å‹æŸ¥æ‰¾5: " + binarySearchGeneric(integerArr, 5));

        // ä½¿ç”¨Javaå†…ç½®çš„äºŒåˆ†æŸ¥æ‰¾
        System.out.println("\nJava Arrays.binarySearch: " +
                          Arrays.binarySearch(arr, 13));
    }
}</code></pre>
        </div>
    </div>

    <!-- å®é™…åº”ç”¨ -->
    <div class="content-card">
        <h2 class="section-title">
            <span class="section-icon">ğŸŒŸ</span>
            å®é™…åº”ç”¨
        </h2>

        <div class="application-grid">
            <div class="app-card">
                <h3>ğŸ“š å­—å…¸æŸ¥è¯¢</h3>
                <p>ç”µå­è¯å…¸ã€æ•°æ®åº“ç´¢å¼•ç­‰ä½¿ç”¨äºŒåˆ†æŸ¥æ‰¾å¿«é€Ÿå®šä½</p>
            </div>

            <div class="app-card">
                <h3>ğŸ® æ¸¸æˆå¼€å‘</h3>
                <p>åœ¨æ’è¡Œæ¦œä¸­å¿«é€ŸæŸ¥æ‰¾ç©å®¶æ’åï¼Œç¢°æ’æ£€æµ‹ä¼˜åŒ–</p>
            </div>

            <div class="app-card">
                <h3>ğŸ’¾ æ–‡ä»¶ç³»ç»Ÿ</h3>
                <p>åœ¨å·²æ’åºçš„æ–‡ä»¶åˆ—è¡¨ä¸­å¿«é€ŸæŸ¥æ‰¾æ–‡ä»¶</p>
            </div>

            <div class="app-card">
                <h3>ğŸ”¢ æ•°å€¼è®¡ç®—</h3>
                <p>æ±‚å¹³æ–¹æ ¹ã€æ–¹ç¨‹æ±‚è§£ç­‰æ•°å€¼æ–¹æ³•</p>
            </div>

            <div class="app-card">
                <h3>ğŸ“Š æ•°æ®åˆ†æ</h3>
                <p>åœ¨æ—¶é—´åºåˆ—æ•°æ®ä¸­æŸ¥æ‰¾ç‰¹å®šæ—¶é—´ç‚¹çš„æ•°æ®</p>
            </div>

            <div class="app-card">
                <h3>ğŸ­ å·¥ä¸šæ§åˆ¶</h3>
                <p>åœ¨ä¼ æ„Ÿå™¨æ•°æ®ä¸­å¿«é€Ÿå®šä½å¼‚å¸¸å€¼</p>
            </div>
        </div>
    </div>

    <!-- å­¦ä¹ æ£€éªŒ -->
    <div class="content-card">
        <h2 class="section-title">
            <span class="section-icon">âœ…</span>
            å­¦ä¹ æ£€éªŒ
        </h2>

        <div class="quiz-item">
            <div class="quiz-question">
                â“ é—®é¢˜1ï¼šäºŒåˆ†æŸ¥æ‰¾çš„å‰ææ¡ä»¶æ˜¯ä»€ä¹ˆï¼Ÿä¸ºä»€ä¹ˆéœ€è¦è¿™äº›æ¡ä»¶ï¼Ÿ
            </div>
            <button class="show-answer-btn" onclick="toggleAnswer(1, event)">æŸ¥çœ‹ç­”æ¡ˆ</button>
            <div id="answer1" class="quiz-answer">
                <strong>ç­”æ¡ˆï¼š</strong>äºŒåˆ†æŸ¥æ‰¾éœ€è¦ä¸¤ä¸ªå‰ææ¡ä»¶ï¼š

                <p><strong>1. æ•°ç»„å¿…é¡»æœ‰åº</strong></p>
                <ul>
                    <li>åŸå› ï¼šåªæœ‰æœ‰åºæ‰èƒ½ç¡®å®šç›®æ ‡åœ¨å“ªä¸€åŠ</li>
                    <li>å¦‚æœæ— åºï¼Œæ¯”è¾ƒç»“æœæ— æ³•æŒ‡å¯¼æœç´¢æ–¹å‘</li>
                </ul>

                <p><strong>2. æ”¯æŒéšæœºè®¿é—®ï¼ˆæ•°ç»„ç»“æ„ï¼‰</strong></p>
                <ul>
                    <li>åŸå› ï¼šéœ€è¦O(1)æ—¶é—´è®¿é—®ä¸­é—´å…ƒç´ </li>
                    <li>é“¾è¡¨ä¸é€‚åˆï¼Œè®¿é—®ä¸­é—´èŠ‚ç‚¹éœ€è¦O(n)</li>
                </ul>

                <p><strong>é¢å¤–è€ƒè™‘ï¼š</strong></p>
                <ul>
                    <li>æ•°æ®é‡è¾ƒå¤§æ—¶æ‰æœ‰ä¼˜åŠ¿ï¼ˆå°æ•°æ®é‡çº¿æ€§æŸ¥æ‰¾å¯èƒ½æ›´å¿«ï¼‰</li>
                    <li>é™æ€æˆ–å¾ˆå°‘å˜åŒ–çš„æ•°æ®ï¼ˆé¢‘ç¹æ’å…¥åˆ é™¤ä¼šç ´åæœ‰åºæ€§ï¼‰</li>
                </ul>
            </div>
        </div>

        <div class="quiz-item">
            <div class="quiz-question">
                â“ é—®é¢˜2ï¼šwhile (left <= right) å’Œ while (left < right) çš„åŒºåˆ«ï¼Ÿ
            </div>
            <button class="show-answer-btn" onclick="toggleAnswer(2, event)">æŸ¥çœ‹ç­”æ¡ˆ</button>
            <div id="answer2" class="quiz-answer">
                <strong>ç­”æ¡ˆï¼š</strong>è¿™æ˜¯äºŒåˆ†æŸ¥æ‰¾æœ€å¸¸è§çš„è¾¹ç•Œé—®é¢˜ã€‚

                <p><strong>while (left <= right)ï¼š</strong></p>
                <ul>
                    <li>æœç´¢åŒºé—´ï¼š[left, right]ï¼Œä¸¤ç«¯éƒ½åŒ…å«</li>
                    <li>ç»ˆæ­¢æ¡ä»¶ï¼šleft > rightï¼ŒåŒºé—´ä¸ºç©º</li>
                    <li>æ›´æ–°æ–¹å¼ï¼šleft = mid + 1, right = mid - 1</li>
                    <li>é€‚ç”¨ï¼šæ ‡å‡†çš„æŸ¥æ‰¾æŸä¸ªå€¼</li>
                </ul>

                <p><strong>while (left < right)ï¼š</strong></p>
                <ul>
                    <li>æœç´¢åŒºé—´ï¼š[left, right)ï¼Œå·¦é—­å³å¼€</li>
                    <li>ç»ˆæ­¢æ¡ä»¶ï¼šleft == right</li>
                    <li>æ›´æ–°æ–¹å¼ï¼šleft = mid + 1, right = mid</li>
                    <li>é€‚ç”¨ï¼šæŸ¥æ‰¾è¾¹ç•Œä½ç½®</li>
                </ul>

                <p><strong>ç¤ºä¾‹å¯¹æ¯”ï¼š</strong></p>
                <pre style="background: #f0f0f0; padding: 10px;">
// æ ‡å‡†æŸ¥æ‰¾
while (left <= right) {
    mid = left + (right - left) / 2;
    if (arr[mid] == target) return mid;
    else if (arr[mid] < target) left = mid + 1;
    else right = mid - 1;
}

// æŸ¥æ‰¾å·¦è¾¹ç•Œ
while (left < right) {
    mid = left + (right - left) / 2;
    if (arr[mid] < target) left = mid + 1;
    else right = mid;
}
                </pre>
            </div>
        </div>

        <div class="quiz-item">
            <div class="quiz-question">
                â“ é—®é¢˜3ï¼šä¸ºä»€ä¹ˆè¦å†™ mid = left + (right - left) / 2 è€Œä¸æ˜¯ mid = (left + right) / 2ï¼Ÿ
            </div>
            <button class="show-answer-btn" onclick="toggleAnswer(3, event)">æŸ¥çœ‹ç­”æ¡ˆ</button>
            <div id="answer3" class="quiz-answer">
                <strong>ç­”æ¡ˆï¼š</strong>é˜²æ­¢æ•´æ•°æº¢å‡ºï¼

                <p><strong>é—®é¢˜åˆ†æï¼š</strong></p>
                <ul>
                    <li>å½“leftå’Œrightéƒ½å¾ˆå¤§æ—¶ï¼Œleft + rightå¯èƒ½è¶…è¿‡æ•´æ•°æœ€å¤§å€¼</li>
                    <li>ä¾‹å¦‚ï¼šleft = 2^30, right = 2^30ï¼Œç›¸åŠ ä¼šæº¢å‡º</li>
                    <li>æº¢å‡ºåç»“æœå˜æˆè´Ÿæ•°ï¼Œå¯¼è‡´ç¨‹åºé”™è¯¯</li>
                </ul>

                <p><strong>è§£å†³æ–¹æ¡ˆï¼š</strong></p>
                <ol>
                    <li><code>mid = left + (right - left) / 2</code>ï¼ˆæ¨èï¼‰</li>
                    <li><code>mid = left + ((right - left) >> 1)</code>ï¼ˆä½è¿ç®—ç‰ˆæœ¬ï¼‰</li>
                    <li><code>mid = (left + right) >>> 1</code>ï¼ˆJavaæ— ç¬¦å·å³ç§»ï¼‰</li>
                </ol>

                <p><strong>å…¶ä»–è¯­è¨€çš„å¤„ç†ï¼š</strong></p>
                <ul>
                    <li>Pythonï¼šæ•´æ•°æ— é™å¤§ï¼Œä¸å­˜åœ¨æº¢å‡ºé—®é¢˜</li>
                    <li>JavaScriptï¼šä½¿ç”¨Math.floor((left + right) / 2)</li>
                </ul>
            </div>
        </div>

        <div class="quiz-item">
            <div class="quiz-question">
                â“ é—®é¢˜4ï¼šå¦‚ä½•ç”¨äºŒåˆ†æŸ¥æ‰¾è§£å†³"å¯»æ‰¾æ—‹è½¬æ•°ç»„çš„æœ€å°å€¼"é—®é¢˜ï¼Ÿ
            </div>
            <button class="show-answer-btn" onclick="toggleAnswer(4, event)">æŸ¥çœ‹ç­”æ¡ˆ</button>
            <div id="answer4" class="quiz-answer">
                <strong>ç­”æ¡ˆï¼š</strong>åˆ©ç”¨æ—‹è½¬æ•°ç»„çš„ç‰¹æ€§è¿›è¡ŒäºŒåˆ†ã€‚

                <p><strong>é—®é¢˜æè¿°ï¼š</strong></p>
                <p>æ•°ç»„åŸæœ¬æœ‰åºï¼Œè¢«æ—‹è½¬äº†è‹¥å¹²ä½ã€‚å¦‚ï¼š[4,5,6,7,0,1,2]</p>

                <p><strong>è§£é¢˜æ€è·¯ï¼š</strong></p>
                <ol>
                    <li>æœ€å°å€¼ä¸€å®šåœ¨"æ–­å±‚"å¤„</li>
                    <li>æ¯”è¾ƒmidä¸rightï¼š
                        <ul>
                            <li>arr[mid] > arr[right]ï¼šæœ€å°å€¼åœ¨å³åŠéƒ¨åˆ†</li>
                            <li>arr[mid] < arr[right]ï¼šæœ€å°å€¼åœ¨å·¦åŠéƒ¨åˆ†ï¼ˆåŒ…æ‹¬midï¼‰</li>
                            <li>arr[mid] == arr[right]ï¼šæ— æ³•åˆ¤æ–­ï¼Œright--</li>
                        </ul>
                    </li>
                </ol>

                <p><strong>ä»£ç å®ç°ï¼š</strong></p>
                <pre style="background: #f0f0f0; padding: 10px;">
def findMin(arr):
    left, right = 0, len(arr) - 1

    while left < right:
        mid = left + (right - left) // 2

        if arr[mid] > arr[right]:
            left = mid + 1  # æœ€å°å€¼åœ¨å³è¾¹
        elif arr[mid] < arr[right]:
            right = mid     # æœ€å°å€¼åœ¨å·¦è¾¹æˆ–å°±æ˜¯mid
        else:
            right -= 1      # å¤„ç†é‡å¤å…ƒç´ 

    return arr[left]
                </pre>

                <p><strong>æ—¶é—´å¤æ‚åº¦ï¼š</strong>O(log n)ï¼Œæœ‰é‡å¤æ—¶æœ€åO(n)</p>
            </div>
        </div>

        <div style="margin-top: 30px; padding: 20px; background: #e3f2fd; border-radius: 8px;">
            <h4>ğŸ“š è¿›é˜¶å­¦ä¹ å»ºè®®</h4>
            <ol>
                <li><strong>æŒæ¡å˜ç§ï¼š</strong>æŸ¥æ‰¾ç¬¬ä¸€ä¸ª/æœ€åä¸€ä¸ªã€æŸ¥æ‰¾èŒƒå›´</li>
                <li><strong>æ‰©å±•åº”ç”¨ï¼š</strong>äºŒåˆ†ç­”æ¡ˆã€ä¸‰åˆ†æŸ¥æ‰¾</li>
                <li><strong>ç›¸å…³ç®—æ³•ï¼š</strong>å¿«é€Ÿé€‰æ‹©ã€æ’å€¼æŸ¥æ‰¾</li>
                <li><strong>å®æˆ˜ç»ƒä¹ ï¼š</strong>LeetCodeäºŒåˆ†æŸ¥æ‰¾ä¸“é¢˜</li>
            </ol>
        </div>
    </div>

    <!-- è¿”å›å¯¼èˆª -->
    <div style="text-align: center; margin-top: 40px;">
        <a href="{% url 'knowledge_app:index' %}" class="unified-btn unified-btn-primary">
            <span>ğŸ </span>
            è¿”å›é¦–é¡µ
        </a>
        <a href="{% url 'knowledge_app:cs_universe' %}" class="unified-btn unified-btn-secondary">
            <span>ğŸŒŒ</span>
            æ¢ç´¢CSå®‡å®™
        </a>
    </div>
</div>

<script>
// å…¨å±€å˜é‡
let array = [];
let target = 42;
let left = -1;
let right = -1;
let mid = -1;
let steps = 0;
let found = false;
let animationRunning = false;
let animationSpeed = 1000;
let stepHistory = [];

// Canvasç›¸å…³
const canvas = document.getElementById('binaryCanvas');
const ctx = canvas.getContext('2d');

// ç”Ÿæˆæœ‰åºæ•°ç»„
function generateArray() {
    const size = parseInt(document.getElementById('arraySizeSelect').value);
    array = [];
    stepHistory = [];

    // ç”Ÿæˆéšæœºæœ‰åºæ•°ç»„
    let current = Math.floor(Math.random() * 5) + 1;
    for (let i = 0; i < size; i++) {
        array.push(current);
        current += Math.floor(Math.random() * 10) + 1;
    }

    resetSearch();
    displayArray();
    drawCanvas();
}

// æ˜¾ç¤ºæ•°ç»„å…ƒç´ 
function displayArray() {
    const container = document.getElementById('arrayContainer');
    container.innerHTML = '';

    for (let i = 0; i < array.length; i++) {
        const element = document.createElement('div');
        element.className = 'array-element';
        element.id = `elem-${i}`;
        element.innerHTML = `
            ${array[i]}
            <div class="array-index">${i}</div>
        `;
        container.appendChild(element);
    }
}

// æ›´æ–°å…ƒç´ æ ·å¼
function updateElementStyles() {
    for (let i = 0; i < array.length; i++) {
        const element = document.getElementById(`elem-${i}`);
        if (!element) continue;

        // é‡ç½®æ ·å¼
        element.className = 'array-element';

        // åº”ç”¨æ ·å¼
        if (i === mid && !found) {
            element.classList.add('mid');
        }
        if (i === left) {
            element.classList.add('left-bound');
        }
        if (i === right) {
            element.classList.add('right-bound');
        }
        if (i < left || i > right) {
            element.classList.add('eliminated');
        }
        if (found && i === mid) {
            element.classList.add('found');
        }
    }
}

// ç»˜åˆ¶Canvaså¯è§†åŒ–
function drawCanvas() {
    ctx.clearRect(0, 0, canvas.width, canvas.height);

    if (array.length === 0) return;

    const barWidth = canvas.width / array.length;
    const maxValue = Math.max(...array);
    const scale = (canvas.height - 60) / maxValue;

    // ç»˜åˆ¶æ¡å½¢å›¾
    for (let i = 0; i < array.length; i++) {
        const barHeight = array[i] * scale;
        const x = i * barWidth;
        const y = canvas.height - barHeight - 30;

        // è®¾ç½®é¢œè‰²
        if (i === mid && !found) {
            ctx.fillStyle = '#FF9800';
        } else if (i === left || i === right) {
            ctx.fillStyle = i === left ? '#4CAF50' : '#f44336';
        } else if (i < left || i > right) {
            ctx.fillStyle = '#e0e0e0';
        } else {
            ctx.fillStyle = '#2196F3';
        }

        if (found && i === mid) {
            ctx.fillStyle = '#9C27B0';
        }

        // ç»˜åˆ¶æ¡å½¢
        ctx.fillRect(x + 2, y, barWidth - 4, barHeight);

        // ç»˜åˆ¶æ•°å€¼
        ctx.fillStyle = '#333';
        ctx.font = '12px Arial';
        ctx.textAlign = 'center';
        ctx.fillText(array[i], x + barWidth / 2, canvas.height - 10);

        // ç»˜åˆ¶ç´¢å¼•
        ctx.fillStyle = '#666';
        ctx.font = '10px Arial';
        ctx.fillText(i, x + barWidth / 2, canvas.height - 20);
    }

    // ç»˜åˆ¶æŒ‡é’ˆ
    if (left >= 0 && left < array.length) {
        drawPointer(left * barWidth + barWidth / 2, 20, 'L', '#4CAF50');
    }
    if (right >= 0 && right < array.length) {
        drawPointer(right * barWidth + barWidth / 2, 20, 'R', '#f44336');
    }
    if (mid >= 0 && mid < array.length && !found) {
        drawPointer(mid * barWidth + barWidth / 2, 40, 'M', '#FF9800');
    }
}

// ç»˜åˆ¶æŒ‡é’ˆ
function drawPointer(x, y, label, color) {
    ctx.fillStyle = color;
    ctx.beginPath();
    ctx.moveTo(x, y);
    ctx.lineTo(x - 10, y - 15);
    ctx.lineTo(x + 10, y - 15);
    ctx.closePath();
    ctx.fill();

    ctx.fillStyle = 'white';
    ctx.font = 'bold 12px Arial';
    ctx.textAlign = 'center';
    ctx.fillText(label, x, y - 5);
}

// äºŒåˆ†æŸ¥æ‰¾æ­¥éª¤
async function binarySearchStep() {
    if (left > right) {
        found = false;
        updateLog('âŒ æœªæ‰¾åˆ°ç›®æ ‡å…ƒç´ ');
        addStepToHistory(`æœªæ‰¾åˆ° ${target}`);
        animationRunning = false;
        return false;
    }

    mid = Math.floor(left + (right - left) / 2);
    steps++;

    updateStats();
    updateElementStyles();
    drawCanvas();

    // æ›´æ–°æ¯”è¾ƒä¿¡æ¯
    const compInfo = document.getElementById('comparisonInfo');
    compInfo.innerHTML = `
        <p><strong>ç¬¬ ${steps} æ­¥</strong></p>
        <p>æ¯”è¾ƒ: arr[${mid}] = ${array[mid]} ä¸ target = ${target}</p>
    `;

    await sleep(animationSpeed);

    if (array[mid] === target) {
        found = true;
        compInfo.innerHTML += `<p class="comparison-result" style="color: #9C27B0;">âœ… æ‰¾åˆ°äº†ï¼</p>`;
        updateLog(`ğŸ‰ æ‰¾åˆ°ç›®æ ‡ï¼ä½ç½®: ${mid}ï¼Œæ¯”è¾ƒæ¬¡æ•°: ${steps}`);
        addStepToHistory(`æ‰¾åˆ° ${target} åœ¨ä½ç½® ${mid}`);
        updateElementStyles();
        drawCanvas();
        animationRunning = false;
        return false;
    } else if (array[mid] < target) {
        compInfo.innerHTML += `<p class="comparison-result">${array[mid]} < ${target} â†’ æœç´¢å³åŠéƒ¨åˆ†</p>`;
        addStepToHistory(`arr[${mid}]=${array[mid]} < ${target}ï¼Œæœç´¢å³è¾¹`);
        left = mid + 1;
    } else {
        compInfo.innerHTML += `<p class="comparison-result">${array[mid]} > ${target} â†’ æœç´¢å·¦åŠéƒ¨åˆ†</p>`;
        addStepToHistory(`arr[${mid}]=${array[mid]} > ${target}ï¼Œæœç´¢å·¦è¾¹`);
        right = mid - 1;
    }

    return true;
}

// å¼€å§‹æœç´¢
async function startSearch() {
    if (animationRunning) return;

    target = parseInt(document.getElementById('targetInput').value);
    resetSearch();
    animationRunning = true;

    while (await binarySearchStep()) {
        if (!animationRunning) break;
        await sleep(animationSpeed / 2);
    }
}

// å•æ­¥æ‰§è¡Œ
async function stepSearch() {
    if (animationRunning) return;

    if (steps === 0) {
        target = parseInt(document.getElementById('targetInput').value);
        resetSearch();
    }

    await binarySearchStep();
}

// é‡ç½®æœç´¢
function resetSearch() {
    left = 0;
    right = array.length - 1;
    mid = -1;
    steps = 0;
    found = false;
    animationRunning = false;
    stepHistory = [];

    updateStats();
    updateElementStyles();
    drawCanvas();

    document.getElementById('comparisonInfo').innerHTML = '<p>ç­‰å¾…å¼€å§‹æŸ¥æ‰¾...</p>';
    document.getElementById('stepHistory').innerHTML = '';
}

// æ›´æ–°ç»Ÿè®¡ä¿¡æ¯
function updateStats() {
    document.getElementById('stepCount').textContent = steps;
    document.getElementById('leftBound').textContent = left >= 0 ? left : '-';
    document.getElementById('rightBound').textContent = right >= 0 ? right : '-';
    document.getElementById('midPoint').textContent = mid >= 0 ? mid : '-';
}

// æ·»åŠ æ­¥éª¤åˆ°å†å²
function addStepToHistory(message) {
    stepHistory.push(message);
    const historyDiv = document.getElementById('stepHistory');
    const stepDiv = document.createElement('div');
    stepDiv.className = 'step-item';
    stepDiv.textContent = `æ­¥éª¤ ${stepHistory.length}: ${message}`;
    historyDiv.appendChild(stepDiv);
    historyDiv.scrollTop = historyDiv.scrollHeight;
}

// è¾…åŠ©å‡½æ•°
function sleep(ms) {
    return new Promise(resolve => setTimeout(resolve, ms));
}

function updateLog(message) {
    console.log(message);
}

// ä»£ç åˆ‡æ¢
function switchCode(lang, event) {
    document.querySelectorAll('.code-tab').forEach(tab => tab.classList.remove('active'));
    document.querySelectorAll('.code-content').forEach(content => content.classList.remove('active'));

    event.target.classList.add('active');
    document.getElementById(`${lang}-code`).classList.add('active');
}

// å¤åˆ¶ä»£ç 
function copyCode(lang, event) {
    const codeElement = document.getElementById(`${lang}-code`).querySelector('code');
    const text = codeElement.textContent;

    navigator.clipboard.writeText(text).then(() => {
        const btn = event.target;
        const originalText = btn.textContent;
        btn.textContent = 'âœ… å·²å¤åˆ¶ï¼';
        setTimeout(() => {
            btn.textContent = originalText;
        }, 2000);
    }).catch(err => {
        // é™çº§æ–¹æ¡ˆ
        const textArea = document.createElement('textarea');
        textArea.value = text;
        textArea.style.position = 'fixed';
        textArea.style.left = '-9999px';
        document.body.appendChild(textArea);
        textArea.select();

        try {
            document.execCommand('copy');
            const btn = event.target;
            const originalText = btn.textContent;
            btn.textContent = 'âœ… å·²å¤åˆ¶ï¼';
            setTimeout(() => {
                btn.textContent = originalText;
            }, 2000);
        } catch (err) {
            alert('å¤åˆ¶å¤±è´¥ï¼Œè¯·æ‰‹åŠ¨å¤åˆ¶ä»£ç ');
        }

        document.body.removeChild(textArea);
    });
}

// æ˜¾ç¤º/éšè—ç­”æ¡ˆ
function toggleAnswer(num, event) {
    const answer = document.getElementById(`answer${num}`);
    const btn = event.target;

    if (answer.style.display === 'block') {
        answer.style.display = 'none';
        btn.textContent = 'æŸ¥çœ‹ç­”æ¡ˆ';
    } else {
        answer.style.display = 'block';
        btn.textContent = 'éšè—ç­”æ¡ˆ';
    }
}

// é€Ÿåº¦æ§åˆ¶
document.getElementById('speedSlider').addEventListener('input', (e) => {
    animationSpeed = parseInt(e.target.value);
    document.getElementById('speedValue').textContent = `${animationSpeed}ms`;
});

// åˆå§‹åŒ–
generateArray();
</script>

{% endblock %}