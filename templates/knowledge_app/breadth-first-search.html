{% extends 'knowledge_app/base.html' %}

{% block title %}{{ page_title|default:"é˜Ÿåˆ—ä¸å¹¿åº¦ä¼˜å…ˆæœç´¢" }} - è®¡ç®—æœºç§‘å­¦å­¦ä¹ å¹³å°{% endblock %}

{% block content %}
<div class="page-container fade-in">
    <!-- é¢åŒ…å±‘å¯¼èˆª -->
    <div class="breadcrumb">
        <a href="{% url 'knowledge_app:index' %}">é¦–é¡µ</a>
        <span>></span>
        <span>{{ breadcrumb_category|default:"æ•°æ®ç»“æ„ä¸ç®—æ³•" }}</span>
        <span>></span>
        <span>{{ page_title|default:"é˜Ÿåˆ—ä¸å¹¿åº¦ä¼˜å…ˆæœç´¢" }}</span>
    </div>

    <!-- é¡µé¢å¤´éƒ¨ -->
    <div class="page-header slide-in-left">
        <h1>
            <span class="page-icon">{{ page_icon|default:"ğŸš¶â€â™‚ï¸" }}</span>
            {{ page_title|default:"é˜Ÿåˆ—ä¸å¹¿åº¦ä¼˜å…ˆæœç´¢" }}
        </h1>
        <p>{{ page_description|default:"æ¢ç´¢é˜Ÿåˆ—å¦‚ä½•é©±åŠ¨BFSç®—æ³•ï¼Œå®ç°å±‚å±‚æ¨è¿›çš„æœç´¢ç­–ç•¥" }}</p>
    </div>

    <!-- ğŸ“‹ çŸ¥è¯†ç‚¹æ¦‚è¿° -->
    <div class="content-card slide-in-right">
        <div class="content-section">
            <h2 class="section-title">
                <span class="section-icon">ğŸ“‹</span>
                çŸ¥è¯†ç‚¹æ¦‚è¿°
            </h2>
            <div class="overview-content">
                <div class="concept-intro">
                    <p><strong>æ ¸å¿ƒæ¦‚å¿µï¼š</strong>é˜Ÿåˆ—å°±åƒæ’é˜Ÿä¹°ç¥¨çš„é˜Ÿä¼â€”â€”å…ˆåˆ°å…ˆæœåŠ¡ï¼è€ŒBFSå°±åƒæ°´æ³¢çº¹æ‰©æ•£ï¼Œä¸€åœˆåœˆå‘å¤–æœç´¢ã€‚é˜Ÿåˆ—çš„FIFO(å…ˆè¿›å…ˆå‡º)ç‰¹æ€§å®Œç¾æ”¯æ’‘äº†BFSçš„å±‚æ¬¡éå†éœ€æ±‚ï¼</p>
                </div>

                <div class="unified-grid unified-grid-2">
                    <div class="info-box info-box-info">
                        <h3>ğŸ·ï¸ å…³é”®æœ¯è¯­</h3>
                        <ul>
                            <li><strong>é˜Ÿåˆ—(Queue)ï¼š</strong>FIFOçº¿æ€§æ•°æ®ç»“æ„</li>
                            <li><strong>å…¥é˜Ÿ(Enqueue)ï¼š</strong>åœ¨é˜Ÿå°¾æ·»åŠ å…ƒç´ </li>
                            <li><strong>å‡ºé˜Ÿ(Dequeue)ï¼š</strong>ä»é˜Ÿå¤´ç§»é™¤å…ƒç´ </li>
                            <li><strong>BFSï¼š</strong>é€å±‚æœç´¢çš„å›¾éå†ç®—æ³•</li>
                            <li><strong>è®¿é—®é¡ºåºï¼š</strong>æŒ‰è·ç¦»èµ·ç‚¹çš„å±‚æ¬¡è®¿é—®</li>
                        </ul>
                    </div>

                    <div class="info-box info-box-success">
                        <h3>ğŸ“Š å­¦ä¹ æŒ‡æ ‡</h3>
                        <p><strong>éš¾åº¦ç­‰çº§ï¼š</strong> <span class="badge badge-medium">è¿›é˜¶</span></p>
                        <p><strong>å‰ç½®çŸ¥è¯†ï¼š</strong></p>
                        <ul>
                            <li>çº¿æ€§æ•°æ®ç»“æ„ âœ“</li>
                            <li>å›¾çš„åŸºæœ¬æ¦‚å¿µ âœ“</li>
                            <li>é€’å½’ä¸è¿­ä»£ âœ“</li>
                            <li>ç®—æ³•æ—¶é—´å¤æ‚åº¦ âœ“</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- ğŸ” æ¦‚å¿µè¯¦è§£ -->
    <div class="content-card">
        <div class="content-section">
            <h2 class="section-title">
                <span class="section-icon">ğŸ”</span>
                æ¦‚å¿µè¯¦è§£
            </h2>

            <div class="concept-details">
                <div class="concept-item">
                    <h3>ğŸ—ï¸ é˜Ÿåˆ—çš„FIFOç‰¹æ€§</h3>
                    <p>æƒ³è±¡ä¸€ä¸ªç”µå½±é™¢çš„å…¥åœºé˜Ÿåˆ—ï¼š</p>
                    <ul>
                        <li>é˜Ÿå¤´(Front)ï¼šç¬¬ä¸€ä¸ªæ’é˜Ÿçš„äººï¼Œæœ€å…ˆå…¥åœº</li>
                        <li>é˜Ÿå°¾(Rear)ï¼šæœ€åä¸€ä¸ªæ’é˜Ÿçš„äººï¼Œæœ€åå…¥åœº</li>
                        <li>å…¥é˜Ÿï¼šæ–°äººæ€»æ˜¯æ’åˆ°é˜Ÿä¼æœ€å</li>
                        <li>å‡ºé˜Ÿï¼šæ€»æ˜¯ä»é˜Ÿå¤´å¼€å§‹è®©äººå…¥åœº</li>
                        <li>å…¬å¹³åŸåˆ™ï¼šå…ˆæ¥ååˆ°ï¼Œç»ä¸æ’é˜Ÿï¼</li>
                    </ul>

                    <div class="fifo-demo">
                        <div class="queue-visual">
                            <div class="queue-label">é˜Ÿå¤´ â†’ å‡ºé˜Ÿ</div>
                            <div class="queue-container">
                                <div class="queue-element">A</div>
                                <div class="queue-element">B</div>
                                <div class="queue-element">C</div>
                                <div class="queue-element">D</div>
                            </div>
                            <div class="queue-label">é˜Ÿå°¾ â† å…¥é˜Ÿ</div>
                        </div>
                    </div>
                </div>

                <div class="concept-item">
                    <h3>ğŸŒŠ BFSçš„å±‚æ¬¡æœç´¢ç­–ç•¥</h3>
                    <div class="bfs-strategy">
                        <div class="strategy-explanation">
                            <h4>ğŸ¯ BFSæ ¸å¿ƒæ€æƒ³</h4>
                            <p>å°±åƒæ± å¡˜é‡Œæ‰”çŸ³å¤´äº§ç”Ÿçš„æ°´æ³¢çº¹ï¼Œä»èµ·ç‚¹å¼€å§‹ä¸€åœˆåœˆå‘å¤–æ‰©æ•£ï¼š</p>
                            <ul>
                                <li><strong>ç¬¬1å±‚ï¼š</strong>èµ·ç‚¹æœ¬èº«</li>
                                <li><strong>ç¬¬2å±‚ï¼š</strong>è·ç¦»èµ·ç‚¹1æ­¥çš„æ‰€æœ‰èŠ‚ç‚¹</li>
                                <li><strong>ç¬¬3å±‚ï¼š</strong>è·ç¦»èµ·ç‚¹2æ­¥çš„æ‰€æœ‰èŠ‚ç‚¹</li>
                                <li><strong>ç¬¬nå±‚ï¼š</strong>è·ç¦»èµ·ç‚¹n-1æ­¥çš„æ‰€æœ‰èŠ‚ç‚¹</li>
                            </ul>
                        </div>

                        <div class="ripple-demo">
                            <div class="ripple-container">
                                <div class="ripple-layer layer-1">
                                    <span>èµ·ç‚¹</span>
                                </div>
                                <div class="ripple-layer layer-2">
                                    <span>ç¬¬2å±‚</span>
                                </div>
                                <div class="ripple-layer layer-3">
                                    <span>ç¬¬3å±‚</span>
                                </div>
                                <div class="ripple-layer layer-4">
                                    <span>ç¬¬4å±‚</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="concept-item">
                    <h3>ğŸ¤ é˜Ÿåˆ—ä¸BFSçš„å®Œç¾é…åˆ</h3>
                    <div class="perfect-match">
                        <div class="match-explanation">
                            <h4>ğŸ’¡ ä¸ºä»€ä¹ˆé˜Ÿåˆ—æ˜¯BFSçš„æœ€ä½³æ­æ¡£ï¼Ÿ</h4>
                            <div class="reason-cards">
                                <div class="reason-card">
                                    <span class="reason-icon">ğŸ¯</span>
                                    <h5>å±‚æ¬¡ä¿è¯</h5>
                                    <p>é˜Ÿåˆ—ç¡®ä¿å…ˆè®¿é—®ç¬¬kå±‚çš„æ‰€æœ‰èŠ‚ç‚¹ï¼Œå†è®¿é—®ç¬¬k+1å±‚</p>
                                </div>
                                <div class="reason-card">
                                    <span class="reason-icon">âš–ï¸</span>
                                    <h5>å…¬å¹³æ€§</h5>
                                    <p>åŒä¸€å±‚çš„èŠ‚ç‚¹æŒ‰å‘ç°é¡ºåºè®¿é—®ï¼Œä¸ä¼šå‡ºç°"æ’é˜Ÿ"</p>
                                </div>
                                <div class="reason-card">
                                    <span class="reason-icon">ğŸ”„</span>
                                    <h5>çŠ¶æ€ç®¡ç†</h5>
                                    <p>é˜Ÿåˆ—è‡ªç„¶åœ°ç»´æŠ¤äº†"å¾…è®¿é—®"èŠ‚ç‚¹çš„é¡ºåº</p>
                                </div>
                                <div class="reason-card">
                                    <span class="reason-icon">ğŸ“</span>
                                    <h5>æœ€çŸ­è·¯å¾„</h5>
                                    <p>ä¿è¯æ‰¾åˆ°çš„è·¯å¾„æ˜¯æœ€çŸ­çš„ï¼ˆæ— æƒå›¾ï¼‰</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="concept-item">
                    <h3>âš ï¸ å¯¹æ¯”ï¼šä¸ºä»€ä¹ˆä¸ç”¨æ ˆï¼Ÿ</h3>
                    <div class="comparison-table">
                        <table>
                            <thead>
                                <tr>
                                    <th>æ•°æ®ç»“æ„</th>
                                    <th>æœç´¢æ–¹å¼</th>
                                    <th>è®¿é—®é¡ºåº</th>
                                    <th>é€‚ç”¨ç®—æ³•</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr class="queue-row">
                                    <td>é˜Ÿåˆ— (FIFO)</td>
                                    <td>æ¨ªå‘ä¼˜å…ˆ</td>
                                    <td>æŒ‰å±‚æ¬¡ï¼Œå…ˆå®½åæ·±</td>
                                    <td>BFSå¹¿åº¦ä¼˜å…ˆæœç´¢</td>
                                </tr>
                                <tr class="stack-row">
                                    <td>æ ˆ (LIFO)</td>
                                    <td>çºµå‘ä¼˜å…ˆ</td>
                                    <td>å°½é‡æ·±å…¥ï¼Œå…ˆæ·±åå®½</td>
                                    <td>DFSæ·±åº¦ä¼˜å…ˆæœç´¢</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- ğŸ“Š å¯è§†åŒ–å±•ç¤º -->
    <div class="content-card">
        <div class="content-section">
            <h2 class="section-title">
                <span class="section-icon">ğŸ“Š</span>
                å¯è§†åŒ–å±•ç¤º
            </h2>

            <!-- BFSæ¼”ç¤ºæ§åˆ¶é¢æ¿ -->
            <div class="visualization-container">
                <h3>ğŸ¬ BFSé˜Ÿåˆ—åŠ¨ç”»æ¼”ç¤º</h3>
                <div class="demo-controls">
                    <div class="control-panel">
                        <button id="autoDemo" class="unified-btn unified-btn-success">ğŸš€ è‡ªåŠ¨BFSæ¼”ç¤º</button>
                        <button id="stepDemo" class="unified-btn unified-btn-primary">ğŸ‘† å•æ­¥æ‰§è¡Œ</button>
                        <button id="resetDemo" class="unified-btn unified-btn-secondary">ğŸ”„ é‡ç½®</button>
                    </div>
                    <div class="graph-selector">
                        <label>é€‰æ‹©æ¼”ç¤ºåœºæ™¯ï¼š</label>
                        <select id="graphType">
                            <option value="simple">ç®€å•å›¾éå†</option>
                            <option value="maze">è¿·å®«è·¯å¾„æœç´¢</option>
                            <option value="tree">äºŒå‰æ ‘å±‚æ¬¡éå†</option>
                            <option value="social">ç¤¾äº¤ç½‘ç»œä¼ æ’­</option>
                        </select>
                        <label>èµ·å§‹èŠ‚ç‚¹ï¼š</label>
                        <select id="startNode">
                            <option value="0">èŠ‚ç‚¹ 0</option>
                            <option value="1">èŠ‚ç‚¹ 1</option>
                            <option value="2">èŠ‚ç‚¹ 2</option>
                            <option value="3">èŠ‚ç‚¹ 3</option>
                        </select>
                    </div>
                    <div class="speed-control">
                        <label>æ¼”ç¤ºé€Ÿåº¦ï¼š</label>
                        <input type="range" id="speedSlider" min="500" max="3000" value="1500" step="250">
                        <span id="speedLabel">æ­£å¸¸</span>
                    </div>
                </div>

                <div class="demo-info" id="demoInfo">
                    ç‚¹å‡»"è‡ªåŠ¨BFSæ¼”ç¤º"è§‚çœ‹å®Œæ•´çš„å¹¿åº¦ä¼˜å…ˆæœç´¢è¿‡ç¨‹
                </div>

                <!-- ä¸»è¦å¯è§†åŒ–åŒºåŸŸ -->
                <div class="visualization-area">
                    <!-- å›¾ç»“æ„å±•ç¤º -->
                    <div class="graph-area">
                        <h4>ğŸŒ å›¾ç»“æ„</h4>
                        <canvas id="graphCanvas" width="500" height="400"></canvas>
                        <div class="graph-legend">
                            <div class="legend-item">
                                <div class="legend-dot unvisited"></div>
                                <span>æœªè®¿é—®</span>
                            </div>
                            <div class="legend-item">
                                <div class="legend-dot current"></div>
                                <span>å½“å‰å¤„ç†</span>
                            </div>
                            <div class="legend-item">
                                <div class="legend-dot visited"></div>
                                <span>å·²è®¿é—®</span>
                            </div>
                            <div class="legend-item">
                                <div class="legend-dot queued"></div>
                                <span>åœ¨é˜Ÿåˆ—ä¸­</span>
                            </div>
                        </div>
                    </div>

                    <!-- é˜Ÿåˆ—çŠ¶æ€å±•ç¤º -->
                    <div class="queue-area">
                        <h4>ğŸ“‹ é˜Ÿåˆ—çŠ¶æ€</h4>
                        <div class="queue-display" id="queueDisplay">
                            <div class="queue-header">
                                <span class="queue-front-label">é˜Ÿå¤´ (å‡ºé˜Ÿ)</span>
                                <span class="queue-rear-label">é˜Ÿå°¾ (å…¥é˜Ÿ)</span>
                            </div>
                            <div class="queue-body" id="queueBody">
                                <div class="empty-queue">é˜Ÿåˆ—ä¸ºç©º</div>
                            </div>
                        </div>
                        <div class="queue-stats" id="queueStats">
                            <div>é˜Ÿåˆ—é•¿åº¦: <span id="queueLength">0</span></div>
                            <div>å·²è®¿é—®: <span id="visitedCount">0</span></div>
                            <div>å½“å‰å±‚: <span id="currentLevel">0</span></div>
                        </div>
                    </div>
                </div>

                <!-- æ­¥éª¤è¯¦è§£ -->
                <div class="step-details" id="stepDetails">
                    <h4>ğŸ“ æ‰§è¡Œæ­¥éª¤</h4>
                    <div class="step-list" id="stepList">
                        <div class="step-item">å‡†å¤‡å¼€å§‹BFSéå†...</div>
                    </div>
                </div>
            </div>

            <!-- BFSç®—æ³•ä¼ªä»£ç  -->
            <div class="algorithm-pseudocode">
                <h3>ğŸ”§ BFSç®—æ³•ä¼ªä»£ç </h3>
                <div class="pseudocode-container">
                    <pre class="pseudocode" id="pseudocode">
<span class="keyword">function</span> <span class="function">BFS</span>(<span class="param">graph, start</span>):
    <span class="comment">// 1. åˆå§‹åŒ–</span>
    <span class="variable">queue</span> â† <span class="function">æ–°å»ºç©ºé˜Ÿåˆ—()</span>
    <span class="variable">visited</span> â† <span class="function">æ–°å»ºç©ºé›†åˆ()</span>

    <span class="comment">// 2. å°†èµ·ç‚¹åŠ å…¥é˜Ÿåˆ—</span>
    <span class="function">queue.enqueue</span>(<span class="variable">start</span>)
    <span class="function">visited.add</span>(<span class="variable">start</span>)

    <span class="comment">// 3. é˜Ÿåˆ—ä¸ç©ºæ—¶æŒç»­å¤„ç†</span>
    <span class="keyword">while</span> <span class="function">queue.ä¸ä¸ºç©º</span>():
        <span class="comment">// 4. å–å‡ºé˜Ÿå¤´å…ƒç´ </span>
        <span class="variable">current</span> â† <span class="function">queue.dequeue</span>()
        <span class="function">å¤„ç†</span>(<span class="variable">current</span>)

        <span class="comment">// 5. éå†æ‰€æœ‰é‚»å±…</span>
        <span class="keyword">for each</span> <span class="variable">neighbor</span> <span class="keyword">in</span> <span class="function">graph.é‚»æ¥è¡¨</span>[<span class="variable">current</span>]:
            <span class="keyword">if</span> <span class="variable">neighbor</span> <span class="keyword">not in</span> <span class="variable">visited</span>:
                <span class="comment">// 6. æœªè®¿é—®çš„é‚»å±…åŠ å…¥é˜Ÿåˆ—</span>
                <span class="function">queue.enqueue</span>(<span class="variable">neighbor</span>)
                <span class="function">visited.add</span>(<span class="variable">neighbor</span>)
                    </pre>
                    <div class="highlight-line" id="highlightLine"></div>
                </div>
            </div>
        </div>
    </div>

    <!-- ğŸŒŸ å®é™…åº”ç”¨ -->
    <div class="content-card">
        <div class="content-section">
            <h2 class="section-title">
                <span class="section-icon">ğŸŒŸ</span>
                å®é™…åº”ç”¨åœºæ™¯
            </h2>

            <div class="applications">
                <div class="application-item featured">
                    <h3>ğŸ—ºï¸ æœ€çŸ­è·¯å¾„å¯»æ‰¾</h3>
                    <p>åœ¨æ— æƒå›¾ä¸­å¯»æ‰¾ä¸¤ç‚¹é—´çš„æœ€çŸ­è·¯å¾„ï¼Œå¦‚æ¸¸æˆä¸­çš„è·¯å¾„è§„åˆ’ã€è¿·å®«æ±‚è§£ç­‰ã€‚</p>
                    <div class="application-details">
                        <h4>åº”ç”¨ç‰¹ç‚¹ï¼š</h4>
                        <ul>
                            <li>ä¿è¯æ‰¾åˆ°çš„è·¯å¾„æ­¥æ•°æœ€å°‘</li>
                            <li>é˜Ÿåˆ—ç¡®ä¿æŒ‰è·ç¦»é€’å¢çš„é¡ºåºè®¿é—®</li>
                            <li>ç¬¬ä¸€æ¬¡è®¿é—®åˆ°ç›®æ ‡å°±æ˜¯æœ€çŸ­è·¯å¾„</li>
                        </ul>
                        <div class="use-case">
                            <strong>å…¸å‹åœºæ™¯ï¼š</strong>GPSå¯¼èˆªã€æ¸¸æˆAIå¯»è·¯ã€ç½‘ç»œè·¯ç”±
                        </div>
                    </div>
                </div>

                <div class="application-item">
                    <h3>ğŸŒ³ æ ‘çš„å±‚æ¬¡éå†</h3>
                    <p>æŒ‰å±‚æ¬¡ä»ä¸Šåˆ°ä¸‹ã€ä»å·¦åˆ°å³éå†äºŒå‰æ ‘ï¼Œå¸¸ç”¨äºæ ‘çš„åºåˆ—åŒ–å’Œæ‰“å°ã€‚</p>
                    <div class="mini-example">
                        <strong>ç¤ºä¾‹ï¼š</strong>æ‰“å°äºŒå‰æ ‘æ¯ä¸€å±‚çš„èŠ‚ç‚¹
                    </div>
                </div>

                <div class="application-item">
                    <h3>ğŸ”¥ ç—…æ¯’ä¼ æ’­æ¨¡æ‹Ÿ</h3>
                    <p>æ¨¡æ‹Ÿç—…æ¯’åœ¨ç½‘ç»œä¸­çš„ä¼ æ’­è¿‡ç¨‹ï¼Œæ¯ä¸€è½®ä¼ æ’­å¯¹åº”BFSçš„ä¸€å±‚æ‰©å±•ã€‚</p>
                    <div class="mini-example">
                        <strong>åœºæ™¯ï¼š</strong>ç¤¾äº¤ç½‘ç»œä¿¡æ¯ä¼ æ’­ã€è®¡ç®—æœºç—…æ¯’æ‰©æ•£
                    </div>
                </div>

                <div class="application-item">
                    <h3>ğŸï¸ è¿é€šåˆ†é‡æ£€æµ‹</h3>
                    <p>æ£€æµ‹å›¾ä¸­çš„è¿é€šåˆ†é‡ï¼Œå¦‚å²›å±¿æ•°é‡ç»Ÿè®¡ã€ç½‘ç»œåˆ†åŒºæ£€æµ‹ã€‚</p>
                    <div class="mini-example">
                        <strong>åº”ç”¨ï¼š</strong>å›¾åƒå¤„ç†ä¸­çš„åŒºåŸŸåˆ†å‰²ã€ç½‘ç»œæ‹“æ‰‘åˆ†æ
                    </div>
                </div>

                <div class="application-item">
                    <h3>ğŸ¯ çŠ¶æ€ç©ºé—´æœç´¢</h3>
                    <p>åœ¨çŠ¶æ€å›¾ä¸­æœç´¢ç›®æ ‡çŠ¶æ€ï¼Œå¦‚8æ•°ç é—®é¢˜ã€é­”æ–¹æ±‚è§£ç­‰ã€‚</p>
                    <div class="mini-example">
                        <strong>ç‰¹è‰²ï¼š</strong>ä¿è¯æ‰¾åˆ°æ­¥æ•°æœ€å°‘çš„è§£å†³æ–¹æ¡ˆ
                    </div>
                </div>
            </div>

            <!-- ä»£ç ç¤ºä¾‹ -->
            <div class="code-examples">
                <h3>ğŸ’» ä»£ç å®ç°</h3>
                <div class="code-tabs">
                    <button class="tab-btn active" data-lang="cpp">C++</button>
                    <button class="tab-btn" data-lang="java">Java</button>
                    <button class="tab-btn" data-lang="python">Python</button>
                </div>

                <!-- C++ ä»£ç  -->
                <div class="code-content active" data-lang="cpp">
                    <div class="code-header">
                        <span>BFSç»å…¸å®ç° - C++</span>
                        <button class="copy-btn" data-clipboard-target="cpp-code">ğŸ“‹ å¤åˆ¶</button>
                    </div>
                    <pre id="cpp-code"><code>
#include &lt;iostream&gt;
#include &lt;vector&gt;
#include &lt;queue&gt;
#include &lt;unordered_set&gt;

class Graph {
private:
    int V;
    std::vector&lt;std::vector&lt;int&gt;&gt; adj;

public:
    Graph(int vertices) : V(vertices), adj(vertices) {}

    void addEdge(int u, int v) {
        adj[u].push_back(v);
        adj[v].push_back(u);  // æ— å‘å›¾
    }

    // åŸºæœ¬BFSéå†
    void BFS(int start) {
        std::vector&lt;bool&gt; visited(V, false);
        std::queue&lt;int&gt; q;

        // åˆå§‹åŒ–ï¼šèµ·ç‚¹å…¥é˜Ÿå¹¶æ ‡è®°ä¸ºå·²è®¿é—®
        q.push(start);
        visited[start] = true;

        std::cout << "BFSéå†é¡ºåº: ";

        while (!q.empty()) {
            // å‡ºé˜Ÿå¹¶å¤„ç†å½“å‰èŠ‚ç‚¹
            int current = q.front();
            q.pop();
            std::cout << current << " ";

            // éå†æ‰€æœ‰æœªè®¿é—®çš„é‚»å±…
            for (int neighbor : adj[current]) {
                if (!visited[neighbor]) {
                    q.push(neighbor);
                    visited[neighbor] = true;
                }
            }
        }
        std::cout << std::endl;
    }

    // BFSå¯»æ‰¾æœ€çŸ­è·¯å¾„
    std::vector&lt;int&gt; shortestPath(int start, int target) {
        std::vector&lt;bool&gt; visited(V, false);
        std::vector&lt;int&gt; parent(V, -1);
        std::queue&lt;int&gt; q;

        q.push(start);
        visited[start] = true;

        while (!q.empty()) {
            int current = q.front();
            q.pop();

            if (current == target) {
                // é‡å»ºè·¯å¾„
                std::vector&lt;int&gt; path;
                int node = target;
                while (node != -1) {
                    path.push_back(node);
                    node = parent[node];
                }
                std::reverse(path.begin(), path.end());
                return path;
            }

            for (int neighbor : adj[current]) {
                if (!visited[neighbor]) {
                    q.push(neighbor);
                    visited[neighbor] = true;
                    parent[neighbor] = current;
                }
            }
        }

        return {}; // æ— è·¯å¾„
    }

    // BFSå±‚æ¬¡éå†ï¼ˆè¿”å›æ¯å±‚çš„èŠ‚ç‚¹ï¼‰
    std::vector&lt;std::vector&lt;int&gt;&gt; levelOrderTraversal(int start) {
        std::vector&lt;std::vector&lt;int&gt;&gt; levels;
        std::vector&lt;bool&gt; visited(V, false);
        std::queue&lt;int&gt; q;

        q.push(start);
        visited[start] = true;

        while (!q.empty()) {
            int levelSize = q.size();
            std::vector&lt;int&gt; currentLevel;

            // å¤„ç†å½“å‰å±‚çš„æ‰€æœ‰èŠ‚ç‚¹
            for (int i = 0; i < levelSize; i++) {
                int current = q.front();
                q.pop();
                currentLevel.push_back(current);

                // å°†ä¸‹ä¸€å±‚èŠ‚ç‚¹åŠ å…¥é˜Ÿåˆ—
                for (int neighbor : adj[current]) {
                    if (!visited[neighbor]) {
                        q.push(neighbor);
                        visited[neighbor] = true;
                    }
                }
            }
            levels.push_back(currentLevel);
        }

        return levels;
    }
};

// è¿·å®«æ±‚è§£ç¤ºä¾‹
class MazeSolver {
private:
    std::vector&lt;std::vector&lt;int&gt;&gt; maze;
    int rows, cols;
    int dx[4] = {-1, 1, 0, 0};  // ä¸Šä¸‹å·¦å³
    int dy[4] = {0, 0, -1, 1};

public:
    MazeSolver(std::vector&lt;std::vector&lt;int&gt;&gt;&amp; m) : maze(m) {
        rows = maze.size();
        cols = maze[0].size();
    }

    int shortestPath(int startX, int startY, int endX, int endY) {
        if (maze[startX][startY] == 1 || maze[endX][endY] == 1) {
            return -1; // èµ·ç‚¹æˆ–ç»ˆç‚¹è¢«å¢™æŒ¡ä½
        }

        std::vector&lt;std::vector&lt;bool&gt;&gt; visited(rows,
            std::vector&lt;bool&gt;(cols, false));
        std::queue&lt;std::tuple&lt;int, int, int&gt;&gt; q; // x, y, è·ç¦»

        q.push({startX, startY, 0});
        visited[startX][startY] = true;

        while (!q.empty()) {
            auto [x, y, dist] = q.front();
            q.pop();

            if (x == endX && y == endY) {
                return dist;
            }

            // æ¢ç´¢å››ä¸ªæ–¹å‘
            for (int i = 0; i < 4; i++) {
                int nx = x + dx[i];
                int ny = y + dy[i];

                if (nx >= 0 && nx < rows && ny >= 0 && ny < cols &&
                    !visited[nx][ny] && maze[nx][ny] == 0) {
                    q.push({nx, ny, dist + 1});
                    visited[nx][ny] = true;
                }
            }
        }

        return -1; // æ— è·¯å¾„
    }
};
                    </code></pre>
                </div>

                <!-- Java ä»£ç  -->
                <div class="code-content" data-lang="java">
                    <div class="code-header">
                        <span>BFSç»å…¸å®ç° - Java</span>
                        <button class="copy-btn" data-clipboard-target="java-code">ğŸ“‹ å¤åˆ¶</button>
                    </div>
                    <pre id="java-code"><code>
import java.util.*;

public class BFSImplementation {

    // å›¾çš„BFSéå†
    static class Graph {
        private int V;
        private List&lt;Integer&gt;[] adj;

        @SuppressWarnings("unchecked")
        public Graph(int V) {
            this.V = V;
            adj = new ArrayList[V];
            for (int i = 0; i < V; i++) {
                adj[i] = new ArrayList&lt;&gt;();
            }
        }

        public void addEdge(int u, int v) {
            adj[u].add(v);
            adj[v].add(u); // æ— å‘å›¾
        }

        public void BFS(int start) {
            boolean[] visited = new boolean[V];
            Queue&lt;Integer&gt; queue = new LinkedList&lt;&gt;();

            queue.offer(start);
            visited[start] = true;

            System.out.print("BFSéå†é¡ºåº: ");

            while (!queue.isEmpty()) {
                int current = queue.poll();
                System.out.print(current + " ");

                for (int neighbor : adj[current]) {
                    if (!visited[neighbor]) {
                        queue.offer(neighbor);
                        visited[neighbor] = true;
                    }
                }
            }
            System.out.println();
        }

        // å±‚æ¬¡éå†
        public List&lt;List&lt;Integer&gt;&gt; levelOrder(int start) {
            List&lt;List&lt;Integer&gt;&gt; result = new ArrayList&lt;&gt;();
            boolean[] visited = new boolean[V];
            Queue&lt;Integer&gt; queue = new LinkedList&lt;&gt;();

            queue.offer(start);
            visited[start] = true;

            while (!queue.isEmpty()) {
                int size = queue.size();
                List&lt;Integer&gt; level = new ArrayList&lt;&gt;();

                for (int i = 0; i < size; i++) {
                    int current = queue.poll();
                    level.add(current);

                    for (int neighbor : adj[current]) {
                        if (!visited[neighbor]) {
                            queue.offer(neighbor);
                            visited[neighbor] = true;
                        }
                    }
                }
                result.add(level);
            }

            return result;
        }
    }

    // äºŒå‰æ ‘å±‚æ¬¡éå†
    static class TreeNode {
        int val;
        TreeNode left;
        TreeNode right;

        TreeNode(int val) {
            this.val = val;
        }
    }

    public static List&lt;List&lt;Integer&gt;&gt; levelOrder(TreeNode root) {
        List&lt;List&lt;Integer&gt;&gt; result = new ArrayList&lt;&gt;();
        if (root == null) return result;

        Queue&lt;TreeNode&gt; queue = new LinkedList&lt;&gt;();
        queue.offer(root);

        while (!queue.isEmpty()) {
            int levelSize = queue.size();
            List&lt;Integer&gt; level = new ArrayList&lt;&gt;();

            for (int i = 0; i < levelSize; i++) {
                TreeNode current = queue.poll();
                level.add(current.val);

                if (current.left != null) {
                    queue.offer(current.left);
                }
                if (current.right != null) {
                    queue.offer(current.right);
                }
            }
            result.add(level);
        }

        return result;
    }

    // å²›å±¿æ•°é‡é—®é¢˜ï¼ˆBFSç‰ˆæœ¬ï¼‰
    public static int numIslands(char[][] grid) {
        if (grid == null || grid.length == 0) return 0;

        int rows = grid.length;
        int cols = grid[0].length;
        boolean[][] visited = new boolean[rows][cols];
        int[][] directions = { {-1,0}, {1,0}, {0,-1}, {0,1} };
        int count = 0;

        for (int i = 0; i < rows; i++) {
            for (int j = 0; j < cols; j++) {
                if (grid[i][j] == '1' && !visited[i][j]) {
                    // å‘ç°æ–°å²›å±¿ï¼Œä½¿ç”¨BFSæ ‡è®°æ•´ä¸ªå²›å±¿
                    Queue&lt;int[]&gt; queue = new LinkedList&lt;&gt;();
                    queue.offer(new int[]{i, j});
                    visited[i][j] = true;

                    while (!queue.isEmpty()) {
                        int[] current = queue.poll();
                        int x = current[0], y = current[1];

                        for (int[] dir : directions) {
                            int nx = x + dir[0];
                            int ny = y + dir[1];

                            if (nx >= 0 && nx < rows && ny >= 0 && ny < cols &&
                                grid[nx][ny] == '1' && !visited[nx][ny]) {
                                queue.offer(new int[]{nx, ny});
                                visited[nx][ny] = true;
                            }
                        }
                    }
                    count++;
                }
            }
        }

        return count;
    }

    public static void main(String[] args) {
        // æµ‹è¯•å›¾éå†
        Graph g = new Graph(6);
        g.addEdge(0, 1);
        g.addEdge(0, 2);
        g.addEdge(1, 3);
        g.addEdge(2, 4);
        g.addEdge(3, 5);
        g.addEdge(4, 5);

        g.BFS(0);

        System.out.println("å±‚æ¬¡éå†ç»“æœ:");
        List&lt;List&lt;Integer&gt;&gt; levels = g.levelOrder(0);
        for (int i = 0; i < levels.size(); i++) {
            System.out.println("ç¬¬" + (i+1) + "å±‚: " + levels.get(i));
        }
    }
}
                    </code></pre>
                </div>

                <!-- Python ä»£ç  -->
                <div class="code-content" data-lang="python">
                    <div class="code-header">
                        <span>BFSç»å…¸å®ç° - Python</span>
                        <button class="copy-btn" data-clipboard-target="python-code">ğŸ“‹ å¤åˆ¶</button>
                    </div>
                    <pre id="python-code"><code>
from collections import deque
from typing import List, Optional

class Graph:
    """å›¾çš„BFSå®ç°"""

    def __init__(self, vertices: int):
        self.V = vertices
        self.adj = [[] for _ in range(vertices)]

    def add_edge(self, u: int, v: int):
        """æ·»åŠ è¾¹ï¼ˆæ— å‘å›¾ï¼‰"""
        self.adj[u].append(v)
        self.adj[v].append(u)

    def bfs(self, start: int) -> List[int]:
        """åŸºæœ¬BFSéå†"""
        visited = [False] * self.V
        queue = deque([start])
        visited[start] = True
        result = []

        while queue:
            current = queue.popleft()
            result.append(current)

            for neighbor in self.adj[current]:
                if not visited[neighbor]:
                    queue.append(neighbor)
                    visited[neighbor] = True

        return result

    def shortest_path(self, start: int, target: int) -> Optional[List[int]]:
        """BFSå¯»æ‰¾æœ€çŸ­è·¯å¾„"""
        if start == target:
            return [start]

        visited = [False] * self.V
        parent = [-1] * self.V
        queue = deque([start])
        visited[start] = True

        while queue:
            current = queue.popleft()

            for neighbor in self.adj[current]:
                if not visited[neighbor]:
                    queue.append(neighbor)
                    visited[neighbor] = True
                    parent[neighbor] = current

                    if neighbor == target:
                        # é‡å»ºè·¯å¾„
                        path = []
                        node = target
                        while node != -1:
                            path.append(node)
                            node = parent[node]
                        return path[::-1]

        return None  # æ— è·¯å¾„

    def level_order_traversal(self, start: int) -> List[List[int]]:
        """å±‚æ¬¡éå†"""
        visited = [False] * self.V
        queue = deque([start])
        visited[start] = True
        levels = []

        while queue:
            level_size = len(queue)
            current_level = []

            for _ in range(level_size):
                current = queue.popleft()
                current_level.append(current)

                for neighbor in self.adj[current]:
                    if not visited[neighbor]:
                        queue.append(neighbor)
                        visited[neighbor] = True

            levels.append(current_level)

        return levels

class TreeNode:
    """äºŒå‰æ ‘èŠ‚ç‚¹"""
    def __init__(self, val=0, left=None, right=None):
        self.val = val
        self.left = left
        self.right = right

def level_order_tree(root: TreeNode) -> List[List[int]]:
    """äºŒå‰æ ‘å±‚æ¬¡éå†"""
    if not root:
        return []

    result = []
    queue = deque([root])

    while queue:
        level_size = len(queue)
        level = []

        for _ in range(level_size):
            node = queue.popleft()
            level.append(node.val)

            if node.left:
                queue.append(node.left)
            if node.right:
                queue.append(node.right)

        result.append(level)

    return result

def num_islands(grid: List[List[str]]) -> int:
    """å²›å±¿æ•°é‡é—®é¢˜ï¼ˆBFSè§£æ³•ï¼‰"""
    if not grid or not grid[0]:
        return 0

    rows, cols = len(grid), len(grid[0])
    visited = [[False] * cols for _ in range(rows)]
    directions = [(-1, 0), (1, 0), (0, -1), (0, 1)]
    count = 0

    for i in range(rows):
        for j in range(cols):
            if grid[i][j] == '1' and not visited[i][j]:
                # å‘ç°æ–°å²›å±¿ï¼Œç”¨BFSæ ‡è®°æ•´ä¸ªå²›å±¿
                queue = deque([(i, j)])
                visited[i][j] = True

                while queue:
                    x, y = queue.popleft()

                    for dx, dy in directions:
                        nx, ny = x + dx, y + dy

                        if (0 <= nx < rows and 0 <= ny < cols and
                            grid[nx][ny] == '1' and not visited[nx][ny]):
                            queue.append((nx, ny))
                            visited[nx][ny] = True

                count += 1

    return count

def shortest_path_maze(maze: List[List[int]],
                      start: tuple, end: tuple) -> int:
    """è¿·å®«æœ€çŸ­è·¯å¾„ï¼ˆBFSï¼‰"""
    if not maze or maze[start[0]][start[1]] == 1 or maze[end[0]][end[1]] == 1:
        return -1

    rows, cols = len(maze), len(maze[0])
    visited = [[False] * cols for _ in range(rows)]
    queue = deque([(start[0], start[1], 0)])  # x, y, è·ç¦»
    visited[start[0]][start[1]] = True
    directions = [(-1, 0), (1, 0), (0, -1), (0, 1)]

    while queue:
        x, y, dist = queue.popleft()

        if (x, y) == end:
            return dist

        for dx, dy in directions:
            nx, ny = x + dx, y + dy

            if (0 <= nx < rows and 0 <= ny < cols and
                not visited[nx][ny] and maze[nx][ny] == 0):
                queue.append((nx, ny, dist + 1))
                visited[nx][ny] = True

    return -1  # æ— è·¯å¾„

# ç—…æ¯’ä¼ æ’­æ¨¡æ‹Ÿ
def virus_spread_simulation(network: List[List[int]],
                           initial_infected: List[int]) -> List[List[int]]:
    """æ¨¡æ‹Ÿç—…æ¯’ä¼ æ’­è¿‡ç¨‹"""
    n = len(network)
    infected = set(initial_infected)
    spread_history = [initial_infected.copy()]
    queue = deque(initial_infected)

    while queue:
        level_size = len(queue)
        new_infected = []

        for _ in range(level_size):
            current = queue.popleft()

            # ä¼ æ’­ç»™é‚»å±…
            for neighbor in range(n):
                if network[current][neighbor] == 1 and neighbor not in infected:
                    infected.add(neighbor)
                    queue.append(neighbor)
                    new_infected.append(neighbor)

        if new_infected:
            spread_history.append(new_infected)

    return spread_history

# ä½¿ç”¨ç¤ºä¾‹
if __name__ == "__main__":
    # åˆ›å»ºå›¾å¹¶æµ‹è¯•
    g = Graph(6)
    edges = [(0,1), (0,2), (1,3), (2,4), (3,5), (4,5)]

    for u, v in edges:
        g.add_edge(u, v)

    print("BFSéå†:", g.bfs(0))
    print("æœ€çŸ­è·¯å¾„ 0->5:", g.shortest_path(0, 5))

    levels = g.level_order_traversal(0)
    for i, level in enumerate(levels):
        print(f"ç¬¬{i+1}å±‚: {level}")

    # æµ‹è¯•è¿·å®«
    maze = [
        [0, 0, 1, 0, 0],
        [0, 0, 0, 0, 1],
        [1, 0, 1, 0, 0],
        [0, 0, 0, 1, 0],
        [0, 1, 0, 0, 0]
    ]

    distance = shortest_path_maze(maze, (0, 0), (4, 4))
    print(f"è¿·å®«æœ€çŸ­è·ç¦»: {distance}")
                    </code></pre>
                </div>
            </div>
        </div>
    </div>

    <!-- âœ… å­¦ä¹ æ£€éªŒ -->
    <div class="content-card">
        <div class="content-section">
            <h2 class="section-title">
                <span class="section-icon">âœ…</span>
                å­¦ä¹ æ£€éªŒ
            </h2>

            <div class="quiz-container">
                <div class="quiz-item">
                    <h3>ğŸ¤” æ€è€ƒé¢˜1ï¼šé˜Ÿåˆ—ä¸BFSçš„æœ¬è´¨å…³ç³»</h3>
                    <p><strong>é—®é¢˜ï¼š</strong>ä¸ºä»€ä¹ˆBFSå¿…é¡»ä½¿ç”¨é˜Ÿåˆ—ï¼Œè€Œä¸èƒ½ä½¿ç”¨æ ˆæˆ–å…¶ä»–æ•°æ®ç»“æ„ï¼Ÿè¯·ä»ç®—æ³•æ­£ç¡®æ€§è§’åº¦åˆ†æã€‚</p>
                    <button class="answer-btn" onclick="toggleAnswer('answer1')">ç‚¹å‡»æŸ¥çœ‹ç­”æ¡ˆ</button>
                    <div class="answer-content" id="answer1">
                        <p><strong>ç­”æ¡ˆï¼š</strong>é˜Ÿåˆ—çš„FIFOç‰¹æ€§ä¿è¯äº†BFSæŒ‰å±‚æ¬¡è®¿é—®èŠ‚ç‚¹ï¼Œç¡®ä¿æ‰¾åˆ°æœ€çŸ­è·¯å¾„ã€‚</p>
                        <p><strong>è¯¦ç»†è§£é‡Šï¼š</strong>â‘ <strong>å±‚æ¬¡æ€§ä¿è¯ï¼š</strong>é˜Ÿåˆ—ç¡®ä¿å…ˆå¤„ç†å®Œç¬¬kå±‚æ‰€æœ‰èŠ‚ç‚¹ï¼Œå†å¤„ç†ç¬¬k+1å±‚ï¼›â‘¡<strong>æœ€çŸ­è·¯å¾„ï¼š</strong>ç¬¬ä¸€æ¬¡è®¿é—®åˆ°çš„è·¯å¾„å°±æ˜¯æœ€çŸ­çš„ï¼›â‘¢<strong>å¦‚æœç”¨æ ˆï¼š</strong>ä¼šå˜æˆDFSï¼Œå¯èƒ½å…ˆæ‰¾åˆ°è¾ƒé•¿è·¯å¾„ï¼›â‘£<strong>ç®—æ³•æ­£ç¡®æ€§ï¼š</strong>åªæœ‰FIFOæ‰èƒ½ä¿è¯BFSçš„"å¹¿åº¦ä¼˜å…ˆ"ç‰¹æ€§ã€‚</p>
                    </div>
                </div>

                <div class="quiz-item">
                    <h3>ğŸ¤” æ€è€ƒé¢˜2ï¼šBFSæ—¶é—´å¤æ‚åº¦åˆ†æ</h3>
                    <p><strong>é—®é¢˜ï¼š</strong>å¯¹äºæœ‰Vä¸ªé¡¶ç‚¹ã€Eæ¡è¾¹çš„å›¾ï¼ŒBFSçš„æ—¶é—´å¤æ‚åº¦æ˜¯å¤šå°‘ï¼Ÿé˜Ÿåˆ—æ“ä½œå¦‚ä½•å½±å“å¤æ‚åº¦ï¼Ÿ</p>
                    <button class="answer-btn" onclick="toggleAnswer('answer2')">ç‚¹å‡»æŸ¥çœ‹ç­”æ¡ˆ</button>
                    <div class="answer-content" id="answer2">
                        <p><strong>ç­”æ¡ˆï¼š</strong>BFSçš„æ—¶é—´å¤æ‚åº¦æ˜¯O(V+E)ï¼Œé˜Ÿåˆ—æ“ä½œä¸ºO(1)ä¸å½±å“æ•´ä½“å¤æ‚åº¦ã€‚</p>
                        <p><strong>åˆ†æè¿‡ç¨‹ï¼š</strong>â‘ <strong>é¡¶ç‚¹è®¿é—®ï¼š</strong>æ¯ä¸ªé¡¶ç‚¹æœ€å¤šå…¥é˜Ÿå‡ºé˜Ÿä¸€æ¬¡ï¼ŒO(V)ï¼›â‘¡<strong>è¾¹çš„æ£€æŸ¥ï¼š</strong>æ¯æ¡è¾¹æœ€å¤šæ£€æŸ¥ä¸€æ¬¡ï¼ŒO(E)ï¼›â‘¢<strong>é˜Ÿåˆ—æ“ä½œï¼š</strong>å…¥é˜Ÿå‡ºé˜Ÿéƒ½æ˜¯O(1)æ“ä½œï¼›â‘£<strong>æ€»å¤æ‚åº¦ï¼š</strong>O(V+E)ï¼Œè¿™æ˜¯å›¾éå†ç®—æ³•çš„æœ€ä¼˜å¤æ‚åº¦ã€‚</p>
                    </div>
                </div>

                <div class="quiz-item">
                    <h3>ğŸ¤” æ€è€ƒé¢˜3ï¼šBFSå˜ç§åº”ç”¨</h3>
                    <p><strong>é—®é¢˜ï¼š</strong>å¦‚ä½•ç”¨BFSè§£å†³"01çŸ©é˜µ"é—®é¢˜ï¼šç»™å®šåªåŒ…å«0å’Œ1çš„çŸ©é˜µï¼Œæ±‚æ¯ä¸ªä½ç½®åˆ°æœ€è¿‘0çš„è·ç¦»ï¼Ÿ</p>
                    <button class="answer-btn" onclick="toggleAnswer('answer3')">ç‚¹å‡»æŸ¥çœ‹ç­”æ¡ˆ</button>
                    <div class="answer-content" id="answer3">
                        <p><strong>ç­”æ¡ˆï¼š</strong>å¤šæºBFS - å°†æ‰€æœ‰0ä½ç½®åŒæ—¶ä½œä¸ºèµ·ç‚¹ï¼Œä¸€èµ·å‘å¤–æ‰©æ•£ã€‚</p>
                        <p><strong>ç®—æ³•æ€è·¯ï¼š</strong>â‘ <strong>åˆå§‹åŒ–ï¼š</strong>å°†æ‰€æœ‰0ä½ç½®åŠ å…¥é˜Ÿåˆ—ï¼Œè·ç¦»è®¾ä¸º0ï¼›â‘¡<strong>å¹¶å‘æ‰©æ•£ï¼š</strong>ä»æ‰€æœ‰0åŒæ—¶å¼€å§‹BFSï¼›â‘¢<strong>è·ç¦»æ›´æ–°ï¼š</strong>æ¯å‘å¤–æ‰©ä¸€å±‚ï¼Œè·ç¦»+1ï¼›â‘£<strong>ä¼˜åŠ¿ï¼š</strong>ä¸€æ¬¡éå†è§£å†³æ‰€æœ‰ä½ç½®ï¼Œæ¯”å•ç‹¬è®¡ç®—æ¯ä¸ªä½ç½®æ•ˆç‡é«˜å¾—å¤šã€‚</p>
                    </div>
                </div>

                <div class="quiz-item">
                    <h3>ğŸ¤” æ€è€ƒé¢˜4ï¼šBFSä¸Dijkstraå¯¹æ¯”</h3>
                    <p><strong>é—®é¢˜ï¼š</strong>BFSåªèƒ½å¤„ç†æ— æƒå›¾çš„æœ€çŸ­è·¯å¾„ï¼Œé‚£ä¹ˆå®ƒå’ŒDijkstraç®—æ³•æœ‰ä»€ä¹ˆæœ¬è´¨åŒºåˆ«ï¼Ÿ</p>
                    <button class="answer-btn" onclick="toggleAnswer('answer4')">ç‚¹å‡»æŸ¥çœ‹ç­”æ¡ˆ</button>
                    <div class="answer-content" id="answer4">
                        <p><strong>ç­”æ¡ˆï¼š</strong>BFSç”¨é˜Ÿåˆ—ä¿è¯å±‚æ¬¡éå†ï¼ŒDijkstraç”¨ä¼˜å…ˆé˜Ÿåˆ—ä¿è¯è·ç¦»æœ€å°çš„å…ˆå¤„ç†ã€‚</p>
                        <p><strong>æ ¸å¿ƒåŒºåˆ«ï¼š</strong>â‘ <strong>é€‚ç”¨èŒƒå›´ï¼š</strong>BFSåªé€‚ç”¨äºæ— æƒå›¾æˆ–ç­‰æƒå›¾ï¼›â‘¡<strong>æ•°æ®ç»“æ„ï¼š</strong>BFSç”¨æ™®é€šé˜Ÿåˆ—ï¼ŒDijkstraç”¨ä¼˜å…ˆé˜Ÿåˆ—ï¼›â‘¢<strong>æ‰©å±•ç­–ç•¥ï¼š</strong>BFSæŒ‰å‘ç°é¡ºåºï¼ŒDijkstraæŒ‰è·ç¦»å¤§å°ï¼›â‘£<strong>å¤æ‚åº¦ï¼š</strong>BFSæ˜¯O(V+E)ï¼ŒDijkstraæ˜¯O((V+E)logV)ã€‚</p>
                    </div>
                </div>

                <div class="quiz-item">
                    <h3>ğŸ¤” æ€è€ƒé¢˜5ï¼šé˜Ÿåˆ—å®ç°çš„é€‰æ‹©</h3>
                    <p><strong>é—®é¢˜ï¼š</strong>åœ¨BFSå®ç°ä¸­ï¼Œç”¨æ•°ç»„æ¨¡æ‹Ÿé˜Ÿåˆ—ã€é“¾è¡¨é˜Ÿåˆ—ã€åŒç«¯é˜Ÿåˆ—å„æœ‰ä»€ä¹ˆä¼˜ç¼ºç‚¹ï¼Ÿ</p>
                    <button class="answer-btn" onclick="toggleAnswer('answer5')">ç‚¹å‡»æŸ¥çœ‹ç­”æ¡ˆ</button>
                    <div class="answer-content" id="answer5">
                        <p><strong>ç­”æ¡ˆï¼š</strong>æ ¹æ®å…·ä½“åœºæ™¯é€‰æ‹©ï¼šç©ºé—´å—é™ç”¨æ•°ç»„ï¼ŒåŠ¨æ€å¤§å°ç”¨é“¾è¡¨ï¼Œéœ€è¦åŒå‘æ“ä½œç”¨åŒç«¯é˜Ÿåˆ—ã€‚</p>
                        <p><strong>è¯¦ç»†å¯¹æ¯”ï¼š</strong>â‘ <strong>æ•°ç»„é˜Ÿåˆ—ï¼š</strong>ç©ºé—´å›ºå®šï¼Œç¼“å­˜å‹å¥½ä½†å¯èƒ½æº¢å‡ºï¼›â‘¡<strong>é“¾è¡¨é˜Ÿåˆ—ï¼š</strong>åŠ¨æ€æ‰©å±•ï¼Œå†…å­˜å‹å¥½ä½†æŒ‡é’ˆå¼€é”€å¤§ï¼›â‘¢<strong>åŒç«¯é˜Ÿåˆ—ï¼š</strong>åŠŸèƒ½å¼ºå¤§ï¼Œé€‚åˆå¤æ‚BFSå˜ç§ï¼›â‘£<strong>å®é™…é€‰æ‹©ï¼š</strong>æ ‡å‡†BFSç”¨é“¾è¡¨é˜Ÿåˆ—ï¼Œç©ºé—´æ•æ„Ÿç”¨æ•°ç»„ï¼ŒåŒå‘BFSç”¨åŒç«¯é˜Ÿåˆ—ã€‚</p>
                    </div>
                </div>
            </div>

            <!-- è¿›é˜¶å­¦ä¹ å»ºè®® -->
            <div class="learning-progress">
                <h3>ğŸ“š è¿›é˜¶å­¦ä¹ è·¯å¾„</h3>
                <div class="progress-steps">
                    <div class="progress-step completed">
                        <span class="step-number">1</span>
                        <div class="step-content">
                            <h4>é˜Ÿåˆ—åŸºç¡€ä¸BFS</h4>
                            <p>ç†è§£FIFOä¸å±‚æ¬¡éå†</p>
                        </div>
                    </div>
                    <div class="progress-step next">
                        <span class="step-number">2</span>
                        <div class="step-content">
                            <h4>BFSå˜ç§ç®—æ³•</h4>
                            <p>åŒå‘BFSã€å¤šæºBFS</p>
                        </div>
                    </div>
                    <div class="progress-step">
                        <span class="step-number">3</span>
                        <div class="step-content">
                            <h4>æœ€çŸ­è·¯å¾„ç®—æ³•</h4>
                            <p>Dijkstraã€A*æœç´¢</p>
                        </div>
                    </div>
                    <div class="progress-step">
                        <span class="step-number">4</span>
                        <div class="step-content">
                            <h4>é«˜çº§åº”ç”¨</h4>
                            <p>çŠ¶æ€ç©ºé—´æœç´¢ã€æ¸¸æˆAI</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- å¯¼èˆªæŒ‰é’® -->
    <div style="text-align: center; margin-top: 40px;">
        <a href="{% url 'knowledge_app:index' %}" class="unified-btn unified-btn-primary">
            <span>ğŸ </span>
            è¿”å›é¦–é¡µ
        </a>
        <a href="{% url 'knowledge_app:cs_universe' %}" class="unified-btn unified-btn-secondary">
            <span>ğŸŒŒ</span>
            æ¢ç´¢CSå®‡å®™
        </a>
    </div>
</div>

<!-- CSSæ ·å¼ -->
<style>
.overview-content {
    margin-top: 20px;
}

.concept-intro {
    background: linear-gradient(135deg, #e3f2fd, #f3e5f5);
    padding: 20px;
    border-radius: 10px;
    margin-bottom: 20px;
    border-left: 4px solid #2196F3;
}

.badge {
    padding: 4px 12px;
    border-radius: 20px;
    font-size: 12px;
    font-weight: bold;
    color: white;
}

.badge-medium {
    background: #FF9800;
}

.concept-details {
    margin-top: 20px;
}

.concept-item {
    margin-bottom: 30px;
    padding: 20px;
    background: #fafafa;
    border-radius: 8px;
    border-left: 4px solid #4CAF50;
}

.fifo-demo {
    margin-top: 15px;
    text-align: center;
}

.queue-visual {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 10px;
}

.queue-container {
    display: flex;
    gap: 2px;
    background: #f5f5f5;
    padding: 10px;
    border-radius: 8px;
    box-shadow: 0 2px 4px rgba(0,0,0,0.1);
}

.queue-element {
    width: 50px;
    height: 50px;
    background: linear-gradient(135deg, #4CAF50, #66BB6A);
    color: white;
    display: flex;
    align-items: center;
    justify-content: center;
    border-radius: 6px;
    font-weight: bold;
    font-size: 18px;
}

.queue-label {
    font-size: 14px;
    color: #666;
    font-weight: bold;
}

.bfs-strategy {
    margin-top: 15px;
}

.strategy-explanation h4 {
    color: #FF5722;
    margin-bottom: 10px;
}

.ripple-demo {
    margin-top: 20px;
    display: flex;
    justify-content: center;
}

.ripple-container {
    position: relative;
    width: 300px;
    height: 300px;
    display: flex;
    align-items: center;
    justify-content: center;
}

.ripple-layer {
    position: absolute;
    border-radius: 50%;
    border: 2px solid;
    display: flex;
    align-items: center;
    justify-content: center;
    font-weight: bold;
    font-size: 12px;
}

.layer-1 {
    width: 60px;
    height: 60px;
    border-color: #4CAF50;
    background: rgba(76, 175, 80, 0.2);
    color: #2E7D32;
}

.layer-2 {
    width: 120px;
    height: 120px;
    border-color: #2196F3;
    background: rgba(33, 150, 243, 0.1);
    color: #1976D2;
}

.layer-3 {
    width: 180px;
    height: 180px;
    border-color: #FF9800;
    background: rgba(255, 152, 0, 0.1);
    color: #F57C00;
}

.layer-4 {
    width: 240px;
    height: 240px;
    border-color: #9C27B0;
    background: rgba(156, 39, 176, 0.1);
    color: #7B1FA2;
}

.perfect-match {
    margin-top: 15px;
}

.match-explanation h4 {
    color: #FF9800;
    margin-bottom: 15px;
}

.reason-cards {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
    gap: 15px;
    margin-top: 15px;
}

.reason-card {
    background: white;
    padding: 15px;
    border-radius: 8px;
    text-align: center;
    box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    border-top: 4px solid #4CAF50;
}

.reason-icon {
    font-size: 2em;
    display: block;
    margin-bottom: 10px;
}

.reason-card h5 {
    margin: 0 0 8px 0;
    color: #333;
}

.reason-card p {
    margin: 0;
    color: #666;
    font-size: 14px;
}

.comparison-table {
    margin-top: 15px;
    overflow-x: auto;
}

.comparison-table table {
    width: 100%;
    border-collapse: collapse;
    background: white;
    border-radius: 8px;
    overflow: hidden;
    box-shadow: 0 2px 8px rgba(0,0,0,0.1);
}

.comparison-table th,
.comparison-table td {
    border: 1px solid #ddd;
    padding: 12px 15px;
    text-align: center;
}

.comparison-table th {
    background: #f5f5f5;
    font-weight: bold;
    color: #333;
}

.queue-row {
    background: rgba(76, 175, 80, 0.1);
    border-left: 4px solid #4CAF50;
}

.stack-row {
    background: rgba(244, 67, 54, 0.1);
    border-left: 4px solid #f44336;
}

.visualization-container {
    margin-top: 20px;
}

.demo-controls {
    background: white;
    padding: 20px;
    border-radius: 8px;
    box-shadow: 0 2px 8px rgba(0,0,0,0.1);
    margin-bottom: 20px;
}

.control-panel {
    display: flex;
    gap: 10px;
    margin-bottom: 15px;
    flex-wrap: wrap;
}

.graph-selector {
    display: flex;
    gap: 15px;
    align-items: center;
    margin-bottom: 15px;
    flex-wrap: wrap;
}

.graph-selector label {
    font-weight: bold;
    color: #333;
}

.graph-selector select {
    padding: 8px 12px;
    border: 1px solid #ddd;
    border-radius: 4px;
    background: white;
}

.speed-control {
    display: flex;
    gap: 10px;
    align-items: center;
}

.speed-control input[type="range"] {
    width: 150px;
}

.demo-info {
    text-align: center;
    padding: 15px;
    background: #e3f2fd;
    border-radius: 6px;
    font-weight: bold;
    color: #1976D2;
    margin-bottom: 20px;
}

.visualization-area {
    display: grid;
    grid-template-columns: 1fr 300px;
    gap: 20px;
    margin-bottom: 20px;
}

.graph-area, .queue-area {
    background: white;
    padding: 20px;
    border-radius: 8px;
    box-shadow: 0 2px 8px rgba(0,0,0,0.1);
}

.graph-area h4, .queue-area h4 {
    margin: 0 0 15px 0;
    color: #333;
    text-align: center;
}

#graphCanvas {
    border: 1px solid #ddd;
    border-radius: 4px;
    display: block;
    margin: 0 auto;
}

.graph-legend {
    display: flex;
    justify-content: center;
    gap: 15px;
    margin-top: 15px;
    flex-wrap: wrap;
}

.legend-item {
    display: flex;
    align-items: center;
    gap: 5px;
    font-size: 12px;
}

.legend-dot {
    width: 12px;
    height: 12px;
    border-radius: 50%;
    border: 1px solid #333;
}

.legend-dot.unvisited {
    background: #e0e0e0;
}

.legend-dot.current {
    background: #FF5722;
}

.legend-dot.visited {
    background: #4CAF50;
}

.legend-dot.queued {
    background: #2196F3;
}

.queue-display {
    margin-bottom: 15px;
}

.queue-header {
    display: flex;
    justify-content: space-between;
    margin-bottom: 10px;
    font-size: 12px;
    color: #666;
}

.queue-body {
    min-height: 60px;
    border: 2px dashed #ddd;
    border-radius: 8px;
    padding: 10px;
    display: flex;
    gap: 5px;
    overflow-x: auto;
    align-items: center;
}

.empty-queue {
    color: #999;
    font-style: italic;
    text-align: center;
    width: 100%;
}

.queue-item {
    min-width: 40px;
    height: 40px;
    background: #2196F3;
    color: white;
    border-radius: 6px;
    display: flex;
    align-items: center;
    justify-content: center;
    font-weight: bold;
    flex-shrink: 0;
}

.queue-stats {
    display: flex;
    flex-direction: column;
    gap: 8px;
}

.queue-stats div {
    padding: 8px 12px;
    background: #f5f5f5;
    border-radius: 4px;
    font-size: 14px;
    display: flex;
    justify-content: space-between;
}

.queue-stats span {
    font-weight: bold;
    color: #2196F3;
}

.step-details {
    background: white;
    padding: 20px;
    border-radius: 8px;
    box-shadow: 0 2px 8px rgba(0,0,0,0.1);
}

.step-details h4 {
    margin: 0 0 15px 0;
    color: #333;
}

.step-list {
    max-height: 300px;
    overflow-y: auto;
}

.step-item {
    padding: 10px 15px;
    border-left: 4px solid #e0e0e0;
    margin-bottom: 8px;
    background: #f9f9f9;
    border-radius: 0 4px 4px 0;
    font-size: 14px;
}

.step-item.active {
    border-left-color: #FF5722;
    background: #fff3e0;
    font-weight: bold;
}

.step-item.completed {
    border-left-color: #4CAF50;
    background: #e8f5e8;
    color: #2E7D32;
}

.algorithm-pseudocode {
    margin-top: 30px;
}

.pseudocode-container {
    position: relative;
    background: #1e1e1e;
    border-radius: 8px;
    overflow: hidden;
}

.pseudocode {
    color: #f8f8f2;
    font-family: 'Monaco', 'Consolas', monospace;
    font-size: 14px;
    line-height: 1.6;
    padding: 20px;
    margin: 0;
    overflow-x: auto;
}

.keyword {
    color: #66d9ef;
    font-weight: bold;
}

.function {
    color: #a6e22e;
}

.param {
    color: #fd971f;
}

.variable {
    color: #f92672;
}

.comment {
    color: #75715e;
    font-style: italic;
}

.highlight-line {
    position: absolute;
    left: 0;
    width: 100%;
    height: 25px;
    background: rgba(255, 255, 0, 0.2);
    transition: top 0.3s ease;
    pointer-events: none;
    display: none;
}

.applications {
    margin-top: 20px;
}

.application-item {
    margin-bottom: 25px;
    padding: 20px;
    background: #f8f9fa;
    border-radius: 8px;
    border-left: 4px solid #FF5722;
}

.application-item.featured {
    background: linear-gradient(135deg, #fff3e0, #ffffff);
    border-left-color: #FF9800;
    box-shadow: 0 4px 12px rgba(0,0,0,0.1);
}

.application-details {
    margin-top: 15px;
    padding: 15px;
    background: white;
    border-radius: 6px;
    border: 1px solid #e0e0e0;
}

.application-details h4 {
    margin-top: 0;
    color: #FF9800;
}

.use-case {
    margin-top: 10px;
    padding: 10px;
    background: #f0f7ff;
    border-radius: 4px;
    border-left: 3px solid #2196F3;
}

.mini-example {
    margin-top: 10px;
    padding: 8px 12px;
    background: #e8f5e8;
    border-radius: 4px;
    font-size: 14px;
}

.code-examples {
    margin-top: 30px;
}

.code-tabs {
    display: flex;
    margin-bottom: 0;
    border-bottom: 2px solid #e0e0e0;
}

.tab-btn {
    padding: 12px 24px;
    background: #f5f5f5;
    border: none;
    border-bottom: 2px solid transparent;
    cursor: pointer;
    font-weight: bold;
    transition: all 0.2s;
}

.tab-btn.active {
    background: #2196F3;
    color: white;
    border-bottom-color: #2196F3;
}

.unified-btn-success {
    background: linear-gradient(135deg, #4CAF50, #45a049);
    color: white;
    font-weight: bold;
    border: none;
    padding: 10px 20px;
    border-radius: 6px;
    cursor: pointer;
    transition: all 0.3s;
    box-shadow: 0 2px 4px rgba(0,0,0,0.2);
}

.unified-btn-success:hover {
    background: linear-gradient(135deg, #45a049, #4CAF50);
    transform: translateY(-2px);
    box-shadow: 0 4px 8px rgba(0,0,0,0.3);
}

.code-content {
    display: none;
    background: #1e1e1e;
    border-radius: 0 0 8px 8px;
    overflow: hidden;
}

.code-content.active {
    display: block;
}

.code-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 10px 15px;
    background: #333;
    color: white;
    font-size: 14px;
}

.copy-btn {
    background: #4CAF50;
    color: white;
    border: none;
    padding: 5px 10px;
    border-radius: 4px;
    cursor: pointer;
    font-size: 12px;
    transition: background 0.2s;
}

.copy-btn:hover {
    background: #45a049;
}

pre {
    margin: 0;
    overflow-x: auto;
}

code {
    color: #f8f8f2;
    font-family: 'Monaco', 'Consolas', monospace;
    font-size: 14px;
    line-height: 1.5;
    display: block;
    padding: 20px;
}

.quiz-container {
    margin-top: 20px;
}

.quiz-item {
    margin-bottom: 25px;
    padding: 20px;
    background: white;
    border-radius: 8px;
    border: 1px solid #e0e0e0;
    box-shadow: 0 2px 4px rgba(0,0,0,0.05);
}

.quiz-item h3 {
    color: #1976D2;
    margin-top: 0;
}

.answer-btn {
    background: #4CAF50;
    color: white;
    border: none;
    padding: 10px 20px;
    border-radius: 5px;
    cursor: pointer;
    margin: 10px 0;
    font-weight: bold;
    transition: background 0.2s;
}

.answer-btn:hover {
    background: #45a049;
}

.answer-content {
    display: none;
    margin-top: 15px;
    padding: 15px;
    background: #e8f5e8;
    border-radius: 5px;
    border-left: 4px solid #4CAF50;
}

.answer-content.show {
    display: block;
    animation: fadeIn 0.3s ease-in;
}

@keyframes fadeIn {
    from { opacity: 0; transform: translateY(-10px); }
    to { opacity: 1; transform: translateY(0); }
}

.learning-progress {
    margin-top: 30px;
    padding: 20px;
    background: linear-gradient(135deg, #e3f2fd, #f3e5f5);
    border-radius: 10px;
}

.progress-steps {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
    gap: 20px;
    margin-top: 20px;
}

.progress-step {
    display: flex;
    align-items: center;
    padding: 15px;
    background: white;
    border-radius: 8px;
    box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    opacity: 0.6;
    transition: all 0.3s;
}

.progress-step.completed {
    opacity: 1;
    border-left: 4px solid #4CAF50;
}

.progress-step.next {
    opacity: 1;
    border-left: 4px solid #FF9800;
    transform: scale(1.05);
}

.step-number {
    display: flex;
    align-items: center;
    justify-content: center;
    width: 30px;
    height: 30px;
    background: #e0e0e0;
    color: white;
    border-radius: 50%;
    margin-right: 15px;
    font-weight: bold;
}

.progress-step.completed .step-number {
    background: #4CAF50;
}

.progress-step.next .step-number {
    background: #FF9800;
}

.step-content h4 {
    margin: 0 0 5px 0;
    color: #333;
}

.step-content p {
    margin: 0;
    color: #666;
    font-size: 14px;
}

@media (max-width: 1200px) {
    .visualization-area {
        grid-template-columns: 1fr;
    }
}

@media (max-width: 768px) {
    .reason-cards {
        grid-template-columns: 1fr;
    }

    .control-panel {
        flex-direction: column;
        align-items: stretch;
    }

    .graph-selector {
        flex-direction: column;
        align-items: stretch;
    }

    .progress-steps {
        grid-template-columns: 1fr;
    }

    .code-tabs {
        flex-wrap: wrap;
    }

    .tab-btn {
        flex: 1;
        min-width: 80px;
    }

    .queue-visual {
        overflow-x: auto;
    }
}
</style>

<!-- JavaScript -->
<script>
// BFSå¯è§†åŒ–ç›¸å…³å˜é‡
let canvas, ctx;
let demoInProgress = false;
let stepByStep = false;
let currentStep = 0;
let animationSpeed = 1500;

// å›¾æ•°æ®ç»“æ„
let graphs = {
    simple: {
        nodes: [
            {id: 0, x: 100, y: 100, label: '0'},
            {id: 1, x: 250, y: 60, label: '1'},
            {id: 2, x: 250, y: 140, label: '2'},
            {id: 3, x: 400, y: 100, label: '3'},
            {id: 4, x: 350, y: 200, label: '4'},
            {id: 5, x: 100, y: 250, label: '5'}
        ],
        edges: [
            [0, 1], [0, 2], [1, 3], [2, 3], [2, 4], [3, 5], [4, 5]
        ]
    },
    maze: {
        nodes: [
            {id: 0, x: 50, y: 50, label: 'S'},
            {id: 1, x: 150, y: 50, label: '1'},
            {id: 2, x: 250, y: 50, label: '2'},
            {id: 3, x: 350, y: 50, label: '3'},
            {id: 4, x: 50, y: 150, label: '4'},
            {id: 5, x: 250, y: 150, label: '5'},
            {id: 6, x: 350, y: 150, label: 'E'},
            {id: 7, x: 150, y: 250, label: '7'}
        ],
        edges: [
            [0, 1], [1, 2], [2, 3], [3, 6], [0, 4], [2, 5], [4, 7], [7, 5], [5, 6]
        ]
    },
    tree: {
        nodes: [
            {id: 0, x: 250, y: 50, label: 'A'},
            {id: 1, x: 150, y: 120, label: 'B'},
            {id: 2, x: 350, y: 120, label: 'C'},
            {id: 3, x: 100, y: 190, label: 'D'},
            {id: 4, x: 200, y: 190, label: 'E'},
            {id: 5, x: 300, y: 190, label: 'F'},
            {id: 6, x: 400, y: 190, label: 'G'}
        ],
        edges: [
            [0, 1], [0, 2], [1, 3], [1, 4], [2, 5], [2, 6]
        ]
    },
    social: {
        nodes: [
            {id: 0, x: 250, y: 100, label: 'æº'},
            {id: 1, x: 150, y: 180, label: 'A'},
            {id: 2, x: 250, y: 200, label: 'B'},
            {id: 3, x: 350, y: 180, label: 'C'},
            {id: 4, x: 100, y: 280, label: 'D'},
            {id: 5, x: 200, y: 300, label: 'E'},
            {id: 6, x: 300, y: 300, label: 'F'},
            {id: 7, x: 400, y: 280, label: 'G'}
        ],
        edges: [
            [0, 1], [0, 2], [0, 3], [1, 4], [2, 5], [3, 6], [3, 7], [4, 5], [6, 7]
        ]
    }
};

// BFSçŠ¶æ€
let bfsState = {
    queue: [],
    visited: new Set(),
    current: null,
    adjacencyList: {},
    nodeStates: {}, // unvisited, queued, current, visited
    steps: [],
    currentLevel: 0
};

// åˆå§‹åŒ–
document.addEventListener('DOMContentLoaded', function() {
    canvas = document.getElementById('graphCanvas');
    ctx = canvas.getContext('2d');

    initializeDemo();

    // ç»‘å®šäº‹ä»¶
    document.getElementById('autoDemo').addEventListener('click', startAutoDemo);
    document.getElementById('stepDemo').addEventListener('click', startStepDemo);
    document.getElementById('resetDemo').addEventListener('click', resetDemo);

    document.getElementById('graphType').addEventListener('change', function() {
        resetDemo();
        updateStartNodeOptions();
    });

    document.getElementById('speedSlider').addEventListener('input', function() {
        animationSpeed = parseInt(this.value);
        updateSpeedLabel();
    });

    updateStartNodeOptions();
    updateSpeedLabel();
});

function initializeDemo() {
    const graphType = document.getElementById('graphType').value;
    const startNode = parseInt(document.getElementById('startNode').value) || 0;

    // é‡ç½®BFSçŠ¶æ€
    bfsState = {
        queue: [],
        visited: new Set(),
        current: null,
        adjacencyList: {},
        nodeStates: {},
        steps: [],
        currentLevel: 0
    };

    // æ„å»ºé‚»æ¥è¡¨
    const graph = graphs[graphType];
    for (let node of graph.nodes) {
        bfsState.adjacencyList[node.id] = [];
        bfsState.nodeStates[node.id] = 'unvisited';
    }

    for (let [u, v] of graph.edges) {
        bfsState.adjacencyList[u].push(v);
        bfsState.adjacencyList[v].push(u);
    }

    drawGraph();
    updateQueueDisplay();
    updateStepsDisplay();
}

function drawGraph() {
    ctx.clearRect(0, 0, canvas.width, canvas.height);

    const graphType = document.getElementById('graphType').value;
    const graph = graphs[graphType];

    // ç»˜åˆ¶è¾¹
    ctx.strokeStyle = '#ddd';
    ctx.lineWidth = 2;
    for (let [u, v] of graph.edges) {
        const nodeU = graph.nodes.find(n => n.id === u);
        const nodeV = graph.nodes.find(n => n.id === v);

        ctx.beginPath();
        ctx.moveTo(nodeU.x, nodeU.y);
        ctx.lineTo(nodeV.x, nodeV.y);
        ctx.stroke();
    }

    // ç»˜åˆ¶èŠ‚ç‚¹
    for (let node of graph.nodes) {
        const state = bfsState.nodeStates[node.id] || 'unvisited';
        let color;

        switch (state) {
            case 'unvisited':
                color = '#e0e0e0';
                break;
            case 'queued':
                color = '#2196F3';
                break;
            case 'current':
                color = '#FF5722';
                break;
            case 'visited':
                color = '#4CAF50';
                break;
        }

        // ç»˜åˆ¶åœ†åœˆ
        ctx.beginPath();
        ctx.arc(node.x, node.y, 25, 0, 2 * Math.PI);
        ctx.fillStyle = color;
        ctx.fill();
        ctx.strokeStyle = '#333';
        ctx.lineWidth = 2;
        ctx.stroke();

        // ç»˜åˆ¶æ ‡ç­¾
        ctx.fillStyle = state === 'unvisited' ? '#333' : 'white';
        ctx.font = 'bold 14px Arial';
        ctx.textAlign = 'center';
        ctx.textBaseline = 'middle';
        ctx.fillText(node.label, node.x, node.y);
    }
}

function updateQueueDisplay() {
    const queueBody = document.getElementById('queueBody');
    const queueLength = document.getElementById('queueLength');
    const visitedCount = document.getElementById('visitedCount');
    const currentLevel = document.getElementById('currentLevel');

    // æ›´æ–°é˜Ÿåˆ—æ˜¾ç¤º
    if (bfsState.queue.length === 0) {
        queueBody.innerHTML = '<div class="empty-queue">é˜Ÿåˆ—ä¸ºç©º</div>';
    } else {
        queueBody.innerHTML = bfsState.queue
            .map(nodeId => `<div class="queue-item">${graphs[document.getElementById('graphType').value].nodes.find(n => n.id === nodeId).label}</div>`)
            .join('');
    }

    // æ›´æ–°ç»Ÿè®¡ä¿¡æ¯
    queueLength.textContent = bfsState.queue.length;
    visitedCount.textContent = bfsState.visited.size;
    currentLevel.textContent = bfsState.currentLevel;
}

function updateStepsDisplay() {
    const stepList = document.getElementById('stepList');

    if (bfsState.steps.length === 0) {
        stepList.innerHTML = '<div class="step-item">å‡†å¤‡å¼€å§‹BFSéå†...</div>';
    } else {
        stepList.innerHTML = bfsState.steps
            .map((step, index) => {
                let className = 'step-item';
                if (index === bfsState.steps.length - 1) {
                    className += ' active';
                } else if (index < bfsState.steps.length - 1) {
                    className += ' completed';
                }
                return `<div class="${className}">${step}</div>`;
            })
            .join('');

        // æ»šåŠ¨åˆ°æœ€æ–°æ­¥éª¤
        stepList.scrollTop = stepList.scrollHeight;
    }
}

function addStep(message) {
    bfsState.steps.push(message);
    updateStepsDisplay();
}

async function startAutoDemo() {
    if (demoInProgress) return;

    demoInProgress = true;
    stepByStep = false;
    currentStep = 0;

    // ç¦ç”¨æ§åˆ¶æŒ‰é’®
    document.getElementById('autoDemo').textContent = 'æ¼”ç¤ºè¿›è¡Œä¸­...';
    document.getElementById('autoDemo').disabled = true;
    document.getElementById('stepDemo').disabled = true;

    await performBFS();

    // é‡æ–°å¯ç”¨æŒ‰é’®
    document.getElementById('autoDemo').textContent = 'ğŸš€ è‡ªåŠ¨BFSæ¼”ç¤º';
    document.getElementById('autoDemo').disabled = false;
    document.getElementById('stepDemo').disabled = false;
    demoInProgress = false;
}

async function startStepDemo() {
    if (demoInProgress) return;

    if (!stepByStep) {
        stepByStep = true;
        currentStep = 0;
        document.getElementById('stepDemo').textContent = 'â–¶ï¸ ä¸‹ä¸€æ­¥';

        // åˆå§‹åŒ–BFS
        const startNode = parseInt(document.getElementById('startNode').value) || 0;
        bfsState.queue.push(startNode);
        bfsState.visited.add(startNode);
        bfsState.nodeStates[startNode] = 'queued';

        addStep(`åˆå§‹åŒ–ï¼šå°†èµ·ç‚¹${startNode}åŠ å…¥é˜Ÿåˆ—`);
        drawGraph();
        updateQueueDisplay();
    } else {
        await performBFSStep();

        if (bfsState.queue.length === 0) {
            document.getElementById('stepDemo').textContent = 'ğŸ‘† å•æ­¥æ‰§è¡Œ';
            stepByStep = false;
            addStep('BFSéå†å®Œæˆï¼');
        }
    }
}

function resetDemo() {
    demoInProgress = false;
    stepByStep = false;
    currentStep = 0;

    document.getElementById('autoDemo').textContent = 'ğŸš€ è‡ªåŠ¨BFSæ¼”ç¤º';
    document.getElementById('autoDemo').disabled = false;
    document.getElementById('stepDemo').textContent = 'ğŸ‘† å•æ­¥æ‰§è¡Œ';
    document.getElementById('stepDemo').disabled = false;

    document.getElementById('demoInfo').textContent = 'ç‚¹å‡»"è‡ªåŠ¨BFSæ¼”ç¤º"è§‚çœ‹å®Œæ•´çš„å¹¿åº¦ä¼˜å…ˆæœç´¢è¿‡ç¨‹';

    initializeDemo();
}

async function performBFS() {
    const startNode = parseInt(document.getElementById('startNode').value) || 0;

    // åˆå§‹åŒ–
    bfsState.queue.push(startNode);
    bfsState.visited.add(startNode);
    bfsState.nodeStates[startNode] = 'queued';

    addStep(`åˆå§‹åŒ–ï¼šå°†èµ·ç‚¹${startNode}åŠ å…¥é˜Ÿåˆ—`);
    drawGraph();
    updateQueueDisplay();

    await sleep(animationSpeed);

    while (bfsState.queue.length > 0) {
        await performBFSStep();
        if (!stepByStep) {
            await sleep(animationSpeed);
        }
    }

    addStep('BFSéå†å®Œæˆï¼æ‰€æœ‰å¯è¾¾èŠ‚ç‚¹éƒ½å·²è®¿é—®');
    document.getElementById('demoInfo').textContent = 'BFSæ¼”ç¤ºå®Œæˆï¼ğŸ‰';
}

async function performBFSStep() {
    if (bfsState.queue.length === 0) return;

    // å‡ºé˜Ÿ
    const current = bfsState.queue.shift();
    bfsState.current = current;
    bfsState.nodeStates[current] = 'current';

    const graphType = document.getElementById('graphType').value;
    const currentLabel = graphs[graphType].nodes.find(n => n.id === current).label;

    addStep(`å‡ºé˜Ÿï¼šå¤„ç†èŠ‚ç‚¹${currentLabel}(${current})`);
    drawGraph();
    updateQueueDisplay();

    if (!stepByStep) await sleep(animationSpeed / 2);

    // è®¿é—®æ‰€æœ‰æœªè®¿é—®çš„é‚»å±…
    const neighbors = bfsState.adjacencyList[current];
    const newNeighbors = [];

    for (let neighbor of neighbors) {
        if (!bfsState.visited.has(neighbor)) {
            bfsState.queue.push(neighbor);
            bfsState.visited.add(neighbor);
            bfsState.nodeStates[neighbor] = 'queued';
            newNeighbors.push(neighbor);
        }
    }

    if (newNeighbors.length > 0) {
        const neighborLabels = newNeighbors.map(id => graphs[graphType].nodes.find(n => n.id === id).label);
        addStep(`å…¥é˜Ÿï¼šå°†${currentLabel}çš„é‚»å±…[${neighborLabels.join(', ')}]åŠ å…¥é˜Ÿåˆ—`);
    } else {
        addStep(`èŠ‚ç‚¹${currentLabel}çš„æ‰€æœ‰é‚»å±…éƒ½å·²è®¿é—®è¿‡`);
    }

    // æ ‡è®°å½“å‰èŠ‚ç‚¹ä¸ºå·²è®¿é—®
    bfsState.nodeStates[current] = 'visited';

    drawGraph();
    updateQueueDisplay();
}

function sleep(ms) {
    return new Promise(resolve => setTimeout(resolve, ms));
}

function updateStartNodeOptions() {
    const graphType = document.getElementById('graphType').value;
    const startNodeSelect = document.getElementById('startNode');
    const graph = graphs[graphType];

    startNodeSelect.innerHTML = '';
    for (let node of graph.nodes) {
        const option = document.createElement('option');
        option.value = node.id;
        option.textContent = `èŠ‚ç‚¹ ${node.label}`;
        startNodeSelect.appendChild(option);
    }
}

function updateSpeedLabel() {
    const speed = parseInt(document.getElementById('speedSlider').value);
    const label = document.getElementById('speedLabel');

    if (speed <= 750) {
        label.textContent = 'å¾ˆå¿«';
    } else if (speed <= 1250) {
        label.textContent = 'è¾ƒå¿«';
    } else if (speed <= 1750) {
        label.textContent = 'æ­£å¸¸';
    } else if (speed <= 2250) {
        label.textContent = 'è¾ƒæ…¢';
    } else {
        label.textContent = 'å¾ˆæ…¢';
    }
}

// ä»£ç æ ‡ç­¾é¡µåˆ‡æ¢
document.querySelectorAll('.tab-btn').forEach(btn => {
    btn.addEventListener('click', function() {
        document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
        document.querySelectorAll('.code-content').forEach(c => c.classList.remove('active'));

        this.classList.add('active');
        const lang = this.getAttribute('data-lang');
        document.querySelector(`.code-content[data-lang="${lang}"]`).classList.add('active');
    });
});

// å¤åˆ¶ä»£ç åŠŸèƒ½
document.querySelectorAll('.copy-btn').forEach(btn => {
    btn.addEventListener('click', function() {
        const targetId = this.getAttribute('data-clipboard-target');
        const codeElement = document.getElementById(targetId);

        if (codeElement) {
            const textarea = document.createElement('textarea');
            textarea.value = codeElement.textContent;
            document.body.appendChild(textarea);
            textarea.select();
            document.execCommand('copy');
            document.body.removeChild(textarea);

            const originalText = this.textContent;
            this.textContent = 'âœ… å·²å¤åˆ¶';
            setTimeout(() => {
                this.textContent = originalText;
            }, 2000);
        }
    });
});

// ç­”æ¡ˆåˆ‡æ¢åŠŸèƒ½
function toggleAnswer(answerId) {
    const answerElement = document.getElementById(answerId);
    const button = answerElement.previousElementSibling;

    if (answerElement.classList.contains('show')) {
        answerElement.classList.remove('show');
        button.textContent = 'ç‚¹å‡»æŸ¥çœ‹ç­”æ¡ˆ';
    } else {
        answerElement.classList.add('show');
        button.textContent = 'éšè—ç­”æ¡ˆ';
    }
}
</script>

{% endblock %}