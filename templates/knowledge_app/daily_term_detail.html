{% extends 'knowledge_app/base.html' %}

{% block title %}{{ term.term }} - 每日名词详情 - 计算机科学学习平台{% endblock %}

{% block extra_css %}
<style>* {box-sizing:border-box}body {font-family:-apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Helvetica Neue', Arial, sans-serif;line-height:1.6;color:var(--text-primary);background:linear-gradient(135deg, var(--primary-color) 0%, var(--secondary-color) 100%);min-height:100vh;margin:0;padding:0}.page-layout {min-height:100vh;display:flex;flex-direction:column}.main-content {flex:1;width:100%}.detail-container {max-width:1200px;margin:0 auto;padding:40px 40px;min-height:100vh;position:relative;z-index:1}.breadcrumb {display:flex;align-items:center;gap:10px;font-size:0.9rem;margin-bottom:32px;flex-wrap:wrap}.breadcrumb-item {color:rgba(255, 255, 255, 0.9);text-decoration:none;transition:all 0.3s cubic-bezier(0.4, 0, 0.2, 1);padding:6px 12px;border-radius:16px;background:rgba(255, 255, 255, 0.12);backdrop-filter:blur(8px);border:1px solid rgba(255, 255, 255, 0.1)}.breadcrumb-item:hover {color:var(--text-inverse);background:rgba(255, 255, 255, 0.25);transform:translateY(-2px);box-shadow:var(--shadow-md)}.breadcrumb-separator {color:rgba(255, 255, 255, 0.7);font-weight:500;font-size:1.1rem}.breadcrumb-current {color:var(--text-inverse);font-weight:600;background:rgba(255, 255, 255, 0.2);padding:6px 12px;border-radius:16px}.term-detail {background:var(--bg-card);border-radius:24px;padding:48px;box-shadow:var(--shadow-md);position:relative;overflow:hidden;border:1px solid rgba(0,0,0,0.06);margin-bottom:40px}.term-detail::before {content:'';position:absolute;top:0;left:0;right:0;height:4px;background:linear-gradient(135deg, var(--accent-color), #44a08d, var(--primary-color));border-radius:24px 24px 0 0}.term-header {display:flex;justify-content:space-between;align-items:flex-start;margin-bottom:32px;flex-wrap:wrap;gap:20px}.term-info {flex:1;min-width:0}.term-title {font-size:3rem;font-weight:800;color:#2c3e50;margin-bottom:16px;letter-spacing:-0.02em;line-height:1.2}.term-meta {display:flex;gap:16px;margin-bottom:24px;flex-wrap:wrap}.meta-badge {padding:8px 16px;border-radius:16px;font-size:0.9rem;font-weight:600;display:flex;align-items:center;gap:6px}.category-badge {background:linear-gradient(135deg, #e3f2fd, #bbdefb);color:#1976d2;border:1px solid #90caf9}.difficulty-badge {background:linear-gradient(135deg, #f3e5f5, #e1bee7);color:#7b1fa2;border:1px solid #ce93d8}.difficulty-beginner {background:linear-gradient(135deg, #e8f5e8, #c8e6c9);color:#2e7d32;border:1px solid #a5d6a7}.difficulty-intermediate {background:linear-gradient(135deg, #fff3e0, #ffe0b2);color:#f57c00;border:1px solid #ffcc02}.difficulty-advanced {background:linear-gradient(135deg, #ffebee, #ffcdd2);color:#d32f2f;border:1px solid #ef9a9a}.date-badge {background:linear-gradient(135deg, #f8fafc, #f1f5f9);color:var(--text-secondary);border:1px solid var(--border-color)}.term-actions {display:flex;gap:12px;align-items:center}.action-btn {padding:12px 20px;border-radius:16px;border:none;font-weight:600;cursor:pointer;transition:all 0.3s cubic-bezier(0.4, 0, 0.2, 1);display:flex;align-items:center;gap:8px;font-size:0.9rem;text-decoration:none}.like-btn {background:linear-gradient(135deg, #ff6b6b, #ee5a52);color:var(--text-inverse)}.like-btn:hover {transform:translateY(-2px);box-shadow:0 8px 24px rgba(255, 107, 107, 0.3)}.like-btn.liked {background:linear-gradient(135deg, var(--accent-color), #44a08d)}.share-btn {background:linear-gradient(135deg, var(--primary-color), var(--secondary-color));color:var(--text-inverse)}.share-btn:hover {transform:translateY(-2px);box-shadow:0 8px 24px rgba(102, 126, 234, 0.3);text-decoration:none;color:var(--text-inverse)}.pdf-btn {background:linear-gradient(135deg, #e74c3c, #c0392b);color:var(--text-inverse);text-decoration:none}.pdf-btn:hover {background:linear-gradient(135deg, #c0392b, #a93226);transform:translateY(-2px);box-shadow:0 8px 24px rgba(231, 76, 60, 0.3);color:var(--text-inverse);text-decoration:none}.term-content {margin-bottom:40px}.term-explanation {font-size:1.1rem;line-height:1.8;color:var(--text-secondary);margin-bottom:32px;text-align:justify}.extended-info {display:grid;grid-template-columns:repeat(auto-fit, minmax(300px, 1fr));gap:24px;margin-bottom:40px}.info-section {background:#f8fafc;border-radius:16px;padding:24px;border:1px solid var(--border-color)}.info-title {font-size:1.2rem;font-weight:700;color:#2c3e50;margin-bottom:16px;display:flex;align-items:center;gap:8px}.info-list {list-style:none;padding:0;margin:0}.info-list li {padding:8px 0;color:var(--text-secondary);position:relative;padding-left:20px;border-bottom:1px solid #e2e8f0}.info-list li:last-child {border-bottom:none}.info-list li::before {content:'•';position:absolute;left:0;top:8px;color:var(--accent-color);font-weight:bold}.term-stats {display:flex;justify-content:space-between;align-items:center;padding:20px 0;border-top:1px solid #e2e8f0;margin-bottom:40px}.stats-left {display:flex;gap:24px;font-size:0.9rem;color:var(--text-muted)}.stat-item {display:flex;align-items:center;gap:6px}.related-terms {background:var(--bg-card);border-radius:24px;padding:48px;box-shadow:var(--shadow-md);border:1px solid rgba(0,0,0,0.06)}.related-terms::before {content:'';position:absolute;top:0;left:0;right:0;height:4px;background:linear-gradient(135deg, var(--primary-color), var(--secondary-color));border-radius:24px 24px 0 0}.related-title {font-size:2rem;font-weight:700;color:#2c3e50;margin-bottom:32px;display:flex;align-items:center;gap:12px}.related-grid {display:grid;grid-template-columns:repeat(auto-fit, minmax(280px, 1fr));gap:24px}.related-card {background:linear-gradient(135deg, #f8fafc 0%, #ffffff 100%);border-radius:16px;padding:24px;border:1px solid var(--border-color);transition:all 0.3s ease;text-decoration:none;color:inherit;cursor:pointer}.related-card:hover {transform:translateY(-4px);box-shadow:var(--shadow-md);text-decoration:none;color:inherit}.related-card-title {font-size:1.2rem;font-weight:700;color:#2c3e50;margin-bottom:8px}.related-card-date {font-size:0.8rem;color:var(--text-muted);margin-bottom:12px}.related-card-excerpt {color:var(--text-secondary);font-size:0.9rem;line-height:1.6;display:-webkit-box;-webkit-line-clamp:3;-webkit-box-orient:vertical;overflow:hidden}@media (max-width:768px) {.detail-container {padding:28px 20px}.term-detail, .related-terms {padding:36px 28px}.term-title {font-size:2.4rem}.term-header {flex-direction:column;align-items:flex-start}.term-actions {width:100%;justify-content:center}.extended-info {grid-template-columns:1fr;gap:16px}.related-grid {grid-template-columns:1fr;gap:16px}.term-stats {flex-direction:column;gap:16px;align-items:flex-start}}@keyframes fadeInUp {from {opacity:0;transform:translateY(30px)}to {opacity:1;transform:translateY(0)}}.detail-container {animation:fadeInUp 0.8s ease-out}.term-detail {animation:fadeInUp 0.6s ease-out 0.2s both}.related-terms {animation:fadeInUp 0.6s ease-out 0.4s both}</style>
{% endblock %}

{% block content %}
<main class="page-layout" role="main"><div class="main-content"><div class="detail-container"><!-- 面包屑导航 --><nav class="breadcrumb" aria-label="面包屑导航"><a href="{% url 'knowledge_app:index' %}" class="breadcrumb-item" aria-label="返回首页">
                    🏠 首页
                </a><span class="breadcrumb-separator" aria-hidden="true">›</span><a href="{% url 'knowledge_app:daily_term' %}" class="breadcrumb-item" aria-label="返回每日名词">
                    📚 每日名词
                </a><span class="breadcrumb-separator" aria-hidden="true">›</span><span class="breadcrumb-current" aria-current="page">{{ term.term }}</span></nav><!-- 名词详情 --><article class="term-detail"><header class="term-header"><div class="term-info"><h1 class="term-title">{{ term.term }}</h1><div class="term-meta"><span class="meta-badge date-badge">
                                📅 {{ term.display_date|date:"Y年m月d日" }}
                            </span>
                            {% if term.category %}
                            <span class="meta-badge category-badge">
                                🏷️ {{ term.category }}
                            </span>
                            {% endif %}
                            <span class="meta-badge difficulty-badge difficulty-{{ term.difficulty_level }}">
                                {% if term.difficulty_level == 'beginner' %}🟢 初级
                                {% elif term.difficulty_level == 'intermediate' %}🟡 中级
                                {% elif term.difficulty_level == 'advanced' %}🔴 高级
                                {% else %}{{ term.get_difficulty_level_display }}{% endif %}
                            </span></div></div><div class="term-actions"><button class="action-btn like-btn" onclick="toggleLike({{ term.id }})"><span>❤️</span><span id="likeCount">{{ term.like_count }}</span></button><button class="action-btn share-btn" onclick="shareContent()"><span>📤</span><span>分享</span></button><a href="{% url 'knowledge_app:export_daily_term_pdf' term.id %}"
                           class="action-btn pdf-btn"
                           target="_blank"
                           onclick="return handlePdfExport(this)"><span>📄</span><span>导出PDF</span></a></div></header><div class="term-content"><div class="term-explanation">{{ term.explanation }}</div>

                    {% if term.extended_info %}
                    <div class="extended-info">
                        {% if term.extended_info.examples %}
                        <div class="info-section"><h3 class="info-title"><span>💡</span><span>实例</span></h3><ul class="info-list">
                                {% for example in term.extended_info.examples %}
                                <li>{{ example }}</li>
                                {% endfor %}
                            </ul></div>
                        {% endif %}

                        {% if term.extended_info.related_concepts %}
                        <div class="info-section"><h3 class="info-title"><span>🔗</span><span>相关概念</span></h3><ul class="info-list">
                                {% for concept in term.extended_info.related_concepts %}
                                <li>{{ concept }}</li>
                                {% endfor %}
                            </ul></div>
                        {% endif %}

                        {% if term.extended_info.applications %}
                        <div class="info-section"><h3 class="info-title"><span>🚀</span><span>应用场景</span></h3><ul class="info-list">
                                {% for application in term.extended_info.applications %}
                                <li>{{ application }}</li>
                                {% endfor %}
                            </ul></div>
                        {% endif %}
                    </div>
                    {% endif %}
                </div><footer class="term-stats"><div class="stats-left"><div class="stat-item"><span>👀</span><span>{{ term.view_count }} 次浏览</span></div><div class="stat-item"><span>👍</span><span>{{ term.like_count }} 个赞</span></div><div class="stat-item"><span>📅</span><span>发布于 {{ term.display_date|date:"Y-m-d" }}</span></div></div></footer></article><!-- 相关名词 -->
            {% if related_terms %}
            <section class="related-terms"><h2 class="related-title"><span>🔗</span><span>相关名词</span></h2><div class="related-grid">
                    {% for related in related_terms %}
                    <a href="{% url 'knowledge_app:daily_term_detail' related.id %}" class="related-card"><h3 class="related-card-title">{{ related.term }}</h3><div class="related-card-date">{{ related.display_date|date:"m月d日" }}</div><p class="related-card-excerpt">{{ related.explanation|truncatewords:20 }}</p></a>
                    {% endfor %}
                </div></section>
            {% endif %}
        </div></div></main><script>async function toggleLike(termId) { try { const response = await fetch(`/api/daily-term/like/${termId}/`, { method: 'POST', headers: { 'X-CSRFToken': getCookie('csrftoken'), 'Content-Type': 'application/json', }, }); const data = await response.json(); if (data.success) { document.getElementById('likeCount').textContent = data.like_count; const likeBtn = document.querySelector('.like-btn'); if (data.liked) { likeBtn.classList.add('liked'); } else { likeBtn.classList.remove('liked'); } } } catch (error) { console.error('点赞失败:', error); } } function shareContent() { if (navigator.share) { navigator.share({ title: document.title, text: `学习计算机科学名词：${document.querySelector('.term-title').textContent}`, url: window.location.href }); } else { navigator.clipboard.writeText(window.location.href).then(() => { alert('链接已复制到剪贴板！'); }); } } function getCookie(name) { let cookieValue = null; if (document.cookie && document.cookie !== '') { const cookies = document.cookie.split(';'); for (let i = 0; i < cookies.length; i++) { const cookie = cookies[i].trim(); if (cookie.substring(0, name.length + 1) === (name + '=')) { cookieValue = decodeURIComponent(cookie.substring(name.length + 1)); break; } } } return cookieValue; } function handlePdfExport(element) { console.log('PDF导出按钮被点击'); console.log('导出URL:', element.href); const originalText = element.innerHTML; element.innerHTML = '<span>⏳</span><span>导出中...</span>'; element.style.pointerEvents = 'none'; setTimeout(() => { element.innerHTML = originalText; element.style.pointerEvents = 'auto'; }, 3000); return true; } document.addEventListener('DOMContentLoaded', function() { console.log('页面加载完成'); });</script>
{% endblock %}
