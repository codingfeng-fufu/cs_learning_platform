{% extends 'knowledge_app/base.html' %}

{% block title %}åŒç«¯é˜Ÿåˆ— - è®¡ç®—æœºç§‘å­¦å­¦ä¹ å¹³å°{% endblock %}

{% block content %}
<style>.page-container {max-width:1200px;margin:0 auto;padding:20px;font-family:'Arial', sans-serif}.knowledge-section {background:white;border-radius:12px;box-shadow:0 4px 6px rgba(0,0,0,0.1);margin-bottom:30px;padding:30px;border-left:5px solid #3498db}.section-header {display:flex;align-items:center;margin-bottom:25px;border-bottom:2px solid #ecf0f1;padding-bottom:15px}.section-icon {font-size:2em;margin-right:15px}.section-title {font-size:1.8em;color:#2c3e50;margin:0}.concept-grid {display:grid;grid-template-columns:repeat(auto-fit, minmax(250px, 1fr));gap:20px;margin:20px 0}.concept-card {background:#f8f9fa;border:1px solid #e9ecef;border-radius:8px;padding:20px;text-align:center;transition:transform 0.3s ease}.concept-card:hover {transform:translateY(-5px);box-shadow:0 4px 12px rgba(0,0,0,0.15)}.canvas-container {background:#f8f9fa;border:2px solid #dee2e6;border-radius:8px;padding:20px;margin:20px 0;text-align:center}.canvas-controls {margin:15px 0;display:flex;flex-wrap:wrap;justify-content:center;gap:10px}.control-group {display:flex;flex-direction:column;align-items:center;margin:0 10px}.control-label {font-size:14px;font-weight:bold;color:#2c3e50;margin-bottom:8px}.btn {background:#3498db;color:white;border:none;padding:10px 20px;border-radius:8px;cursor:pointer;margin:2px;font-size:13px;font-weight:bold;transition:all 0.3s ease;box-shadow:0 4px 15px rgba(52, 152, 219, 0.3);position:relative;overflow:hidden}.btn:hover {transform:translateY(-2px);box-shadow:0 6px 20px rgba(52, 152, 219, 0.4)}.btn:active {transform:translateY(0);box-shadow:0 2px 10px rgba(52, 152, 219, 0.2)}.btn:disabled {background:#95a5a6;cursor:not-allowed;transform:none;box-shadow:none}.btn-front {background:linear-gradient(135deg, #27ae60, #2ecc71)}.btn-front:hover {background:linear-gradient(135deg, #229954, #27ae60)}.btn-back {background:linear-gradient(135deg, #e74c3c, #ec7063)}.btn-back:hover {background:linear-gradient(135deg, #c0392b, #e74c3c)}.btn-reset {background:linear-gradient(135deg, #f39c12, #f7dc6f)}.btn-reset:hover {background:linear-gradient(135deg, #d68910, #f39c12)}.btn-demo {background:linear-gradient(135deg, #9b59b6, #bb8fce)}.btn-demo:hover {background:linear-gradient(135deg, #8e44ad, #9b59b6)}.btn::before {content:'';position:absolute;top:0;left:-100%;width:100%;height:100%;background:linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);transition:left 0.5s}.btn:hover::before {left:100%}.input-group {display:flex;align-items:center;margin:10px}.input-group input {padding:8px 12px;border-radius:6px;border:2px solid #3498db;font-size:14px;outline:none;transition:all 0.3s ease;width:80px;text-align:center}.input-group input:focus {border-color:#2980b9;box-shadow:0 0 10px rgba(52, 152, 219, 0.3)}.code-container {background:#2c3e50;color:#ecf0f1;border-radius:8px;margin:20px 0;overflow:hidden}.code-tabs {display:flex;background:#34495e}.code-tab {padding:12px 20px;cursor:pointer;border:none;background:transparent;color:#bdc3c7;font-weight:bold;transition:all 0.3s ease}.code-tab.active {background:#3498db;color:white}.code-content {position:relative;padding:20px;font-family:'Courier New', monospace;line-height:1.6;overflow-x:auto}.copy-btn {position:absolute;top:10px;right:10px;background:#27ae60;color:white;border:none;padding:5px 10px;border-radius:4px;cursor:pointer;font-size:12px}.copy-btn:hover {background:#229954}.quiz-question {background:#fff3cd;border:1px solid #ffeaa7;border-radius:8px;padding:20px;margin:15px 0}.quiz-answer {background:#d1ecf1;border:1px solid #bee5eb;border-radius:8px;padding:15px;margin-top:10px;display:none}.show-answer-btn {background:#17a2b8;color:white;border:none;padding:8px 16px;border-radius:4px;cursor:pointer;margin-top:10px}.analogy-box {background:linear-gradient(135deg, #667eea 0%, #764ba2 100%);color:white;padding:25px;border-radius:12px;margin:20px 0}.highlight {background:#ffffcc;padding:2px 4px;border-radius:3px;font-weight:bold}.difficulty-badge {display:inline-block;padding:5px 15px;border-radius:20px;font-size:0.9em;font-weight:bold;color:white;background:#9b59b6}.key-point {border-left:4px solid #e74c3c;background:#fdf2f2;padding:15px;margin:15px 0;border-radius:0 8px 8px 0}.comparison-grid {display:grid;grid-template-columns:1fr 1fr 1fr;gap:20px;margin:20px 0}.comparison-card {padding:20px;border-radius:8px;border:2px solid;text-align:center}.vs-stack {border-color:#e74c3c;background:#fdf2f2}.vs-queue {border-color:#f39c12;background:#fef9e7}.vs-deque {border-color:#27ae60;background:#eafaf1}.operation-grid {display:grid;grid-template-columns:1fr 1fr;gap:20px;margin:20px 0}.operation-card {padding:15px;border-radius:8px;border:2px solid #3498db;background:#f8f9fa}</style><div class="page-container fade-in"><!-- é¢åŒ…å±‘å¯¼èˆª --><div class="breadcrumb"><a href="{% url 'knowledge_app:index' %}">é¦–é¡µ</a><span>></span><span>æ•°æ®ç»“æ„</span><span>></span><span>åŒç«¯é˜Ÿåˆ—</span></div><!-- é¡µé¢å¤´éƒ¨ --><div class="page-header slide-in-left"><h1><span class="page-icon">âŸ·</span>
            åŒç«¯é˜Ÿåˆ— (Deque - Double-ended Queue)
        </h1><p>ä¸¤ç«¯éƒ½èƒ½æ“ä½œçš„å¼ºå¤§æ•°æ®ç»“æ„ï¼Œé›†æ ˆå’Œé˜Ÿåˆ—åŠŸèƒ½äºä¸€ä½“</p></div><!-- ğŸ“‹ çŸ¥è¯†ç‚¹æ¦‚è¿° --><div class="knowledge-section slide-in-right"><div class="section-header"><span class="section-icon">ğŸ“‹</span><h2 class="section-title">çŸ¥è¯†ç‚¹æ¦‚è¿°</h2></div><div class="key-point"><strong>æ ¸å¿ƒæ¦‚å¿µï¼š</strong>åŒç«¯é˜Ÿåˆ—æ˜¯ä¸€ç§å…è®¸åœ¨å‰ç«¯ï¼ˆfrontï¼‰å’Œåç«¯ï¼ˆbackï¼‰éƒ½å¯ä»¥è¿›è¡Œæ’å…¥å’Œåˆ é™¤æ“ä½œçš„çº¿æ€§æ•°æ®ç»“æ„ï¼Œæ˜¯æ ˆå’Œé˜Ÿåˆ—çš„æ³›åŒ–ã€‚
        </div><div class="concept-grid"><div class="concept-card"><h3>â¬…ï¸ å‰ç«¯æ“ä½œ</h3><p>addFirst() - å‰ç«¯æ’å…¥<br>removeFirst() - å‰ç«¯åˆ é™¤</p></div><div class="concept-card"><h3>â¡ï¸ åç«¯æ“ä½œ</h3><p>addLast() - åç«¯æ’å…¥<br>removeLast() - åç«¯åˆ é™¤</p></div><div class="concept-card"><h3>ğŸ” æŸ¥çœ‹æ“ä½œ</h3><p>peekFirst() - æŸ¥çœ‹å‰ç«¯<br>peekLast() - æŸ¥çœ‹åç«¯</p></div><div class="concept-card"><h3>âš¡ é«˜æ•ˆæ€§</h3><p>æ‰€æœ‰åŸºæœ¬æ“ä½œéƒ½æ˜¯O(1)æ—¶é—´å¤æ‚åº¦</p></div></div><p><span class="difficulty-badge">é«˜çº§</span><strong>å‰ç½®çŸ¥è¯†ï¼š</strong>æ ˆã€é˜Ÿåˆ—ã€æ•°ç»„æˆ–é“¾è¡¨åŸºç¡€æ“ä½œ</p></div><!-- ğŸ” æ¦‚å¿µè¯¦è§£ --><div class="knowledge-section"><div class="section-header"><span class="section-icon">ğŸ”</span><h2 class="section-title">æ¦‚å¿µè¯¦è§£</h2></div><div class="analogy-box"><h3>ğŸšª ç”Ÿæ´»ç±»æ¯”ï¼šåŒå¼€é—¨ç”µæ¢¯</h3><p>æƒ³è±¡ä¸€ä¸ªä¸¤è¾¹éƒ½æœ‰é—¨çš„ç”µæ¢¯ï¼š</p><ul><li><strong>å‰é—¨</strong> = frontç«¯ï¼ˆå¯ä»¥è¿›äººï¼Œä¹Ÿå¯ä»¥å‡ºäººï¼‰</li><li><strong>åé—¨</strong> = backç«¯ï¼ˆä¹Ÿå¯ä»¥è¿›äººï¼Œä¹Ÿå¯ä»¥å‡ºäººï¼‰</li><li><strong>ä¹˜å®¢</strong> = æ•°æ®å…ƒç´ </li><li><strong>çµæ´»è¿›å‡º</strong> = å¯ä»¥ä»ä»»ä¸€ç«¯è¿›å‡ºï¼Œé€‚åº”ä¸åŒåœºæ™¯</li></ul><p>ğŸ’¡ å…³é”®ï¼š<span class="highlight">åŒç«¯é˜Ÿåˆ—æä¾›äº†æœ€å¤§çš„æ“ä½œçµæ´»æ€§ï¼</span></p></div><h3>ğŸ†š ä¸æ ˆå’Œé˜Ÿåˆ—çš„å…³ç³»</h3><div class="comparison-grid"><div class="comparison-card vs-stack"><h4>ğŸ“š æ ˆ (Stack)</h4><p><strong>LIFO</strong></p><ul><li>åªèƒ½ä¸€ç«¯æ“ä½œ</li><li>push/pop</li><li>å—é™çš„åŒç«¯é˜Ÿåˆ—</li></ul></div><div class="comparison-card vs-queue"><h4>ğŸš€ é˜Ÿåˆ— (Queue)</h4><p><strong>FIFO</strong></p><ul><li>ä¸¤ç«¯å„å¸å…¶èŒ</li><li>enqueue/dequeue</li><li>å—é™çš„åŒç«¯é˜Ÿåˆ—</li></ul></div><div class="comparison-card vs-deque"><h4>âŸ· åŒç«¯é˜Ÿåˆ— (Deque)</h4><p><strong>çµæ´»</strong></p><ul><li>ä¸¤ç«¯éƒ½å¯æ“ä½œ</li><li>å››ç§åŸºæœ¬æ“ä½œ</li><li>æ ˆ+é˜Ÿåˆ—çš„åŠŸèƒ½</li></ul></div></div><h3>ğŸ¯ å››ç§æ ¸å¿ƒæ“ä½œ</h3><div class="operation-grid"><div class="operation-card"><h4>â¬…ï¸ å‰ç«¯æ“ä½œ</h4><ul><li><strong>addFirst(x)</strong>ï¼šåœ¨å‰ç«¯æ’å…¥å…ƒç´ x</li><li><strong>removeFirst()</strong>ï¼šåˆ é™¤å¹¶è¿”å›å‰ç«¯å…ƒç´ </li><li><strong>peekFirst()</strong>ï¼šæŸ¥çœ‹å‰ç«¯å…ƒç´ ä½†ä¸åˆ é™¤</li></ul></div><div class="operation-card"><h4>â¡ï¸ åç«¯æ“ä½œ</h4><ul><li><strong>addLast(x)</strong>ï¼šåœ¨åç«¯æ’å…¥å…ƒç´ x</li><li><strong>removeLast()</strong>ï¼šåˆ é™¤å¹¶è¿”å›åç«¯å…ƒç´ </li><li><strong>peekLast()</strong>ï¼šæŸ¥çœ‹åç«¯å…ƒç´ ä½†ä¸åˆ é™¤</li></ul></div></div><div class="key-point"><strong>âš ï¸ åˆå­¦è€…æ˜“æ··æ·†ç‚¹ï¼š</strong><ul><li>ç†è§£"åŒç«¯"ï¼šä¸æ˜¯ä¸¤ä¸ªé˜Ÿåˆ—ï¼Œè€Œæ˜¯ä¸€ä¸ªé˜Ÿåˆ—çš„ä¸¤ç«¯éƒ½èƒ½æ“ä½œ</li><li>æ“ä½œå¯¹ç§°æ€§ï¼šaddFirstå¯¹åº”removeLastï¼ŒaddLastå¯¹åº”removeFirst</li><li>å®ç°å¤æ‚åº¦ï¼šéœ€è¦åŒæ—¶ç»´æŠ¤å‰åä¸¤ä¸ªæŒ‡é’ˆæˆ–ç´¢å¼•</li><li>ç©ºé˜Ÿåˆ—åˆ¤æ–­ï¼šå½“sizeä¸º0æˆ–frontä¸backç›¸é‡æ—¶</li></ul></div></div><!-- ğŸ“Š å¯è§†åŒ–å±•ç¤º --><div class="knowledge-section"><div class="section-header"><span class="section-icon">ğŸ“Š</span><h2 class="section-title">å¯è§†åŒ–å±•ç¤º</h2></div><div class="canvas-container"><h3>âŸ· åŒç«¯é˜Ÿåˆ—åŠ¨æ€æ¼”ç¤º</h3><canvas id="dequeCanvas" width="900" height="350" style="border: 2px solid #3498db; border-radius: 8px; box-shadow: 0 4px 15px rgba(52, 152, 219, 0.2);"></canvas><div class="canvas-controls"><div class="control-group"><div class="control-label">ğŸ”¢ è¾“å…¥æ•°æ®</div><div class="input-group"><input type="number" id="inputValue" placeholder="1-99" min="1" max="99"></div></div><div class="control-group"><div class="control-label">â¬…ï¸ å‰ç«¯æ“ä½œ</div><div><button class="btn btn-front" onclick="addFirst()">â¬…ï¸ å‰ç«¯æ’å…¥</button><button class="btn btn-front" onclick="removeFirst()">â¬…ï¸ å‰ç«¯åˆ é™¤</button></div></div><div class="control-group"><div class="control-label">â¡ï¸ åç«¯æ“ä½œ</div><div><button class="btn btn-back" onclick="addLast()">åç«¯æ’å…¥ â¡ï¸</button><button class="btn btn-back" onclick="removeLast()">åç«¯åˆ é™¤ â¡ï¸</button></div></div><div class="control-group"><div class="control-label">ğŸ® æ§åˆ¶</div><div><button class="btn btn-reset" onclick="resetDeque()">ğŸ”„ é‡ç½®</button><button class="btn btn-demo" onclick="startDemo()">âœ¨ æ¼”ç¤º</button></div></div></div><div id="dequeStatus" style="margin-top: 15px; font-weight: bold; color: #2c3e50; padding: 10px; background: #f8f9fa; border-radius: 8px; border-left: 4px solid #3498db;"></div></div></div><!-- ğŸ’» ä»£ç å®ç° --><div class="knowledge-section"><div class="section-header"><span class="section-icon">ğŸ’»</span><h2 class="section-title">ä»£ç å®ç°</h2></div><div class="code-container"><div class="code-tabs"><button class="code-tab active" onclick="showCode('cpp')">C++</button><button class="code-tab" onclick="showCode('java')">Java</button><button class="code-tab" onclick="showCode('python')">Python</button></div><div id="cpp-code" class="code-content"><button class="copy-btn" onclick="copyCode('cpp', this)">ğŸ“‹ å¤åˆ¶</button><pre><code>#include &lt;iostream&gt;
#include &lt;vector&gt;
using namespace std;

template&lt;typename T&gt;
class Deque {
private:
    vector&lt;T&gt; data;
    int frontIndex;
    int backIndex;
    int size;
    int capacity;

public:
    Deque(int cap = 10) {
        capacity = cap;
        data.resize(capacity);
        frontIndex = 0;
        backIndex = 0;
        size = 0;
    }

    // å‰ç«¯æ’å…¥
    bool addFirst(T element) {
        if (isFull()) {
            cout << "åŒç«¯é˜Ÿåˆ—å·²æ»¡!" << endl;
            return false;
        }

        frontIndex = (frontIndex - 1 + capacity) % capacity;
        data[frontIndex] = element;
        size++;
        cout << "å‰ç«¯æ’å…¥: " << element << endl;
        return true;
    }

    // åç«¯æ’å…¥
    bool addLast(T element) {
        if (isFull()) {
            cout << "åŒç«¯é˜Ÿåˆ—å·²æ»¡!" << endl;
            return false;
        }

        data[backIndex] = element;
        backIndex = (backIndex + 1) % capacity;
        size++;
        cout << "åç«¯æ’å…¥: " << element << endl;
        return true;
    }

    // å‰ç«¯åˆ é™¤
    T removeFirst() {
        if (isEmpty()) {
            cout << "åŒç«¯é˜Ÿåˆ—ä¸ºç©º!" << endl;
            return T();
        }

        T element = data[frontIndex];
        frontIndex = (frontIndex + 1) % capacity;
        size--;
        cout << "å‰ç«¯åˆ é™¤: " << element << endl;
        return element;
    }

    // åç«¯åˆ é™¤
    T removeLast() {
        if (isEmpty()) {
            cout << "åŒç«¯é˜Ÿåˆ—ä¸ºç©º!" << endl;
            return T();
        }

        backIndex = (backIndex - 1 + capacity) % capacity;
        T element = data[backIndex];
        size--;
        cout << "åç«¯åˆ é™¤: " << element << endl;
        return element;
    }

    // æŸ¥çœ‹å‰ç«¯å…ƒç´ 
    T peekFirst() {
        if (isEmpty()) {
            cout << "åŒç«¯é˜Ÿåˆ—ä¸ºç©º!" << endl;
            return T();
        }
        return data[frontIndex];
    }

    // æŸ¥çœ‹åç«¯å…ƒç´ 
    T peekLast() {
        if (isEmpty()) {
            cout << "åŒç«¯é˜Ÿåˆ—ä¸ºç©º!" << endl;
            return T();
        }
        return data[(backIndex - 1 + capacity) % capacity];
    }

    // åˆ¤æ–­æ˜¯å¦ä¸ºç©º
    bool isEmpty() {
        return size == 0;
    }

    // åˆ¤æ–­æ˜¯å¦å·²æ»¡
    bool isFull() {
        return size == capacity;
    }

    // è·å–å¤§å°
    int getSize() {
        return size;
    }

    // æ˜¾ç¤ºåŒç«¯é˜Ÿåˆ—
    void display() {
        if (isEmpty()) {
            cout << "åŒç«¯é˜Ÿåˆ—ä¸ºç©º" << endl;
            return;
        }

        cout << "åŒç«¯é˜Ÿåˆ—å†…å®¹: ";
        for (int i = 0; i < size; i++) {
            int index = (frontIndex + i) % capacity;
            cout << data[index] << " ";
        }
        cout << endl;
    }
};</code></pre></div><div id="java-code" class="code-content" style="display: none;"><button class="copy-btn" onclick="copyCode('java', this)">ğŸ“‹ å¤åˆ¶</button><pre><code>import java.util.ArrayList;

public class Deque&lt;T&gt; {
    private ArrayList&lt;T&gt; data;
    private int frontIndex;
    private int backIndex;
    private int size;
    private int capacity;

    public Deque(int capacity) {
        this.capacity = capacity;
        this.data = new ArrayList&lt;&gt;(capacity);
        for (int i = 0; i < capacity; i++) {
            this.data.add(null);
        }
        this.frontIndex = 0;
        this.backIndex = 0;
        this.size = 0;
    }

    // å‰ç«¯æ’å…¥
    public boolean addFirst(T element) {
        if (isFull()) {
            System.out.println("åŒç«¯é˜Ÿåˆ—å·²æ»¡!");
            return false;
        }

        frontIndex = (frontIndex - 1 + capacity) % capacity;
        data.set(frontIndex, element);
        size++;
        System.out.println("å‰ç«¯æ’å…¥: " + element);
        return true;
    }

    // åç«¯æ’å…¥
    public boolean addLast(T element) {
        if (isFull()) {
            System.out.println("åŒç«¯é˜Ÿåˆ—å·²æ»¡!");
            return false;
        }

        data.set(backIndex, element);
        backIndex = (backIndex + 1) % capacity;
        size++;
        System.out.println("åç«¯æ’å…¥: " + element);
        return true;
    }

    // å‰ç«¯åˆ é™¤
    public T removeFirst() {
        if (isEmpty()) {
            System.out.println("åŒç«¯é˜Ÿåˆ—ä¸ºç©º!");
            return null;
        }

        T element = data.get(frontIndex);
        frontIndex = (frontIndex + 1) % capacity;
        size--;
        System.out.println("å‰ç«¯åˆ é™¤: " + element);
        return element;
    }

    // åç«¯åˆ é™¤
    public T removeLast() {
        if (isEmpty()) {
            System.out.println("åŒç«¯é˜Ÿåˆ—ä¸ºç©º!");
            return null;
        }

        backIndex = (backIndex - 1 + capacity) % capacity;
        T element = data.get(backIndex);
        size--;
        System.out.println("åç«¯åˆ é™¤: " + element);
        return element;
    }

    // æŸ¥çœ‹å‰ç«¯å…ƒç´ 
    public T peekFirst() {
        if (isEmpty()) {
            System.out.println("åŒç«¯é˜Ÿåˆ—ä¸ºç©º!");
            return null;
        }
        return data.get(frontIndex);
    }

    // æŸ¥çœ‹åç«¯å…ƒç´ 
    public T peekLast() {
        if (isEmpty()) {
            System.out.println("åŒç«¯é˜Ÿåˆ—ä¸ºç©º!");
            return null;
        }
        return data.get((backIndex - 1 + capacity) % capacity);
    }

    // åˆ¤æ–­æ˜¯å¦ä¸ºç©º
    public boolean isEmpty() {
        return size == 0;
    }

    // åˆ¤æ–­æ˜¯å¦å·²æ»¡
    public boolean isFull() {
        return size == capacity;
    }

    // è·å–å¤§å°
    public int getSize() {
        return size;
    }

    // æ˜¾ç¤ºåŒç«¯é˜Ÿåˆ—
    public void display() {
        if (isEmpty()) {
            System.out.println("åŒç«¯é˜Ÿåˆ—ä¸ºç©º");
            return;
        }

        System.out.print("åŒç«¯é˜Ÿåˆ—å†…å®¹: ");
        for (int i = 0; i < size; i++) {
            int index = (frontIndex + i) % capacity;
            System.out.print(data.get(index) + " ");
        }
        System.out.println();
    }
}</code></pre></div><div id="python-code" class="code-content" style="display: none;"><button class="copy-btn" onclick="copyCode('python', this)">ğŸ“‹ å¤åˆ¶</button><pre><code>class Deque:
    """åŒç«¯é˜Ÿåˆ—ç±»"""

    def __init__(self, capacity=10):
        self.capacity = capacity
        self.data = [None] * capacity
        self.front_index = 0
        self.back_index = 0
        self.size = 0

    def add_first(self, element):
        """å‰ç«¯æ’å…¥"""
        if self.is_full():
            print("åŒç«¯é˜Ÿåˆ—å·²æ»¡!")
            return False

        self.front_index = (self.front_index - 1 + self.capacity) % self.capacity
        self.data[self.front_index] = element
        self.size += 1
        print(f"å‰ç«¯æ’å…¥: {element}")
        return True

    def add_last(self, element):
        """åç«¯æ’å…¥"""
        if self.is_full():
            print("åŒç«¯é˜Ÿåˆ—å·²æ»¡!")
            return False

        self.data[self.back_index] = element
        self.back_index = (self.back_index + 1) % self.capacity
        self.size += 1
        print(f"åç«¯æ’å…¥: {element}")
        return True

    def remove_first(self):
        """å‰ç«¯åˆ é™¤"""
        if self.is_empty():
            print("åŒç«¯é˜Ÿåˆ—ä¸ºç©º!")
            return None

        element = self.data[self.front_index]
        self.front_index = (self.front_index + 1) % self.capacity
        self.size -= 1
        print(f"å‰ç«¯åˆ é™¤: {element}")
        return element

    def remove_last(self):
        """åç«¯åˆ é™¤"""
        if self.is_empty():
            print("åŒç«¯é˜Ÿåˆ—ä¸ºç©º!")
            return None

        self.back_index = (self.back_index - 1 + self.capacity) % self.capacity
        element = self.data[self.back_index]
        self.size -= 1
        print(f"åç«¯åˆ é™¤: {element}")
        return element

    def peek_first(self):
        """æŸ¥çœ‹å‰ç«¯å…ƒç´ """
        if self.is_empty():
            print("åŒç«¯é˜Ÿåˆ—ä¸ºç©º!")
            return None
        return self.data[self.front_index]

    def peek_last(self):
        """æŸ¥çœ‹åç«¯å…ƒç´ """
        if self.is_empty():
            print("åŒç«¯é˜Ÿåˆ—ä¸ºç©º!")
            return None
        return self.data[(self.back_index - 1 + self.capacity) % self.capacity]

    def is_empty(self):
        """åˆ¤æ–­æ˜¯å¦ä¸ºç©º"""
        return self.size == 0

    def is_full(self):
        """åˆ¤æ–­æ˜¯å¦å·²æ»¡"""
        return self.size == self.capacity

    def get_size(self):
        """è·å–å¤§å°"""
        return self.size

    def display(self):
        """æ˜¾ç¤ºåŒç«¯é˜Ÿåˆ—"""
        if self.is_empty():
            print("åŒç«¯é˜Ÿåˆ—ä¸ºç©º")
            return

        result = []
        for i in range(self.size):
            index = (self.front_index + i) % self.capacity
            result.append(str(self.data[index]))

        print("åŒç«¯é˜Ÿåˆ—å†…å®¹:", " ".join(result))

# ä½¿ç”¨ç¤ºä¾‹
if __name__ == "__main__":
    deque = Deque(6)

    # æµ‹è¯•å„ç§æ“ä½œ
    deque.add_last(10)
    deque.add_last(20)
    deque.add_first(5)
    deque.add_first(1)

    deque.display()

    print(f"å‰ç«¯å…ƒç´ : {deque.peek_first()}")
    print(f"åç«¯å…ƒç´ : {deque.peek_last()}")

    deque.remove_first()
    deque.remove_last()

    deque.display()

    print(f"é˜Ÿåˆ—å¤§å°: {deque.get_size()}")
    print(f"æ˜¯å¦ä¸ºç©º: {deque.is_empty()}")
    print(f"æ˜¯å¦å·²æ»¡: {deque.is_full()}")</code></pre></div></div></div><!-- ğŸŒŸ å®é™…åº”ç”¨ --><div class="knowledge-section"><div class="section-header"><span class="section-icon">ğŸŒŸ</span><h2 class="section-title">å®é™…åº”ç”¨</h2></div><div class="concept-grid"><div class="concept-card"><h3>ğŸŒ æµè§ˆå™¨å†å²</h3><p><strong>å‰è¿›åé€€åŠŸèƒ½</strong></p><p>ç”¨æˆ·å¯ä»¥åœ¨æµè§ˆå†å²ä¸­å‰è¿›å’Œåé€€ï¼ŒåŒç«¯æ“ä½œå¾ˆè‡ªç„¶</p></div><div class="concept-card"><h3>âœ‚ï¸ æ’¤é”€é‡åš</h3><p><strong>æ“ä½œå†å²ç®¡ç†</strong></p><p>ç¼–è¾‘å™¨ä¸­çš„æ’¤é”€(undo)å’Œé‡åš(redo)åŠŸèƒ½å®ç°</p></div><div class="concept-card"><h3>ğŸ® æ¸¸æˆå¼€å‘</h3><p><strong>æŠ€èƒ½å†·å´é˜Ÿåˆ—</strong></p><p>ç®¡ç†æ¸¸æˆä¸­çš„æŠ€èƒ½å†·å´æ—¶é—´å’Œä¼˜å…ˆçº§å¤„ç†</p></div></div><div class="key-point"><h3>ğŸ” æ·±åº¦æ¡ˆä¾‹ï¼šå·¥ä½œçªƒå–è°ƒåº¦</h3><p>åœ¨å¤šçº¿ç¨‹ç¨‹åºä¸­ï¼ŒåŒç«¯é˜Ÿåˆ—æ˜¯å·¥ä½œçªƒå–è°ƒåº¦ç®—æ³•çš„æ ¸å¿ƒï¼š</p><ul><li>ğŸ­ <strong>å·¥ä½œçº¿ç¨‹</strong>ï¼šä»è‡ªå·±é˜Ÿåˆ—çš„ä¸€ç«¯å–ä»»åŠ¡ï¼ˆé€šå¸¸æ˜¯é˜Ÿå°¾ï¼‰</li><li>ğŸ”„ <strong>çªƒå–çº¿ç¨‹</strong>ï¼šä»å…¶ä»–çº¿ç¨‹é˜Ÿåˆ—çš„å¦ä¸€ç«¯çªƒå–ä»»åŠ¡ï¼ˆé€šå¸¸æ˜¯é˜Ÿå¤´ï¼‰</li><li>âš¡ <strong>å‡å°‘ç«äº‰</strong>ï¼šä¸¤ç«¯æ“ä½œå‡å°‘äº†çº¿ç¨‹é—´çš„é”ç«äº‰</li><li>ğŸ“Š <strong>è´Ÿè½½å‡è¡¡</strong>ï¼šç©ºé—²çº¿ç¨‹èƒ½å¤Ÿä»å¿™ç¢Œçº¿ç¨‹é‚£é‡Œåˆ†æ‹…å·¥ä½œ</li><li>ğŸ¯ <strong>æ€§èƒ½ä¼˜åŒ–</strong>ï¼šJavaçš„ForkJoinPoolå°±ä½¿ç”¨äº†è¿™ç§æœºåˆ¶</li></ul></div><h3>ğŸ’¡ åŒç«¯é˜Ÿåˆ—çš„ç‹¬ç‰¹ä¼˜åŠ¿</h3><div class="comparison-grid"><div class="comparison-card vs-deque"><h4>ğŸ”„ æ›¿ä»£æ ˆ</h4><ul><li>åªä½¿ç”¨ä¸€ç«¯æ“ä½œ</li><li>addFirst + removeFirst</li><li>LIFOè¡Œä¸º</li></ul></div><div class="comparison-card vs-deque"><h4>ğŸ”„ æ›¿ä»£é˜Ÿåˆ—</h4><ul><li>ä¸€ç«¯æ’å…¥ï¼Œå¦ä¸€ç«¯åˆ é™¤</li><li>addLast + removeFirst</li><li>FIFOè¡Œä¸º</li></ul></div><div class="comparison-card vs-deque"><h4>âš¡ ç‹¬ç‰¹åŠŸèƒ½</h4><ul><li>æ»‘åŠ¨çª—å£æœ€å€¼</li><li>å›æ–‡æ£€æŸ¥</li><li>åŒå‘BFS</li></ul></div></div></div><!-- âœ… å­¦ä¹ æ£€éªŒ --><div class="knowledge-section"><div class="section-header"><span class="section-icon">âœ…</span><h2 class="section-title">å­¦ä¹ æ£€éªŒ</h2></div><div class="quiz-question"><h4>ğŸ¤” é—®é¢˜1ï¼šåŒç«¯é˜Ÿåˆ—å¦‚ä½•å®ç°æ ˆçš„åŠŸèƒ½ï¼Ÿ</h4><button class="show-answer-btn" onclick="toggleAnswer('answer1')">æ˜¾ç¤ºç­”æ¡ˆ</button><div id="answer1" class="quiz-answer"><strong>ç­”æ¡ˆï¼š</strong>åªä½¿ç”¨åŒç«¯é˜Ÿåˆ—çš„ä¸€ç«¯è¿›è¡Œæ“ä½œ<br><strong>å®ç°æ–¹å¼ï¼š</strong><ul><li><strong>æ–¹æ¡ˆ1</strong>ï¼šåªä½¿ç”¨å‰ç«¯ - addFirst()ä½œä¸ºpushï¼ŒremoveFirst()ä½œä¸ºpop</li><li><strong>æ–¹æ¡ˆ2</strong>ï¼šåªä½¿ç”¨åç«¯ - addLast()ä½œä¸ºpushï¼ŒremoveLast()ä½œä¸ºpop</li><li><strong>æ•ˆæœ</strong>ï¼šå®ç°äº†æ ˆçš„LIFOï¼ˆåè¿›å…ˆå‡ºï¼‰ç‰¹æ€§</li><li><strong>ä¼˜åŠ¿</strong>ï¼šä¸€ä¸ªæ•°æ®ç»“æ„åŒæ—¶å…·å¤‡æ ˆå’Œé˜Ÿåˆ—åŠŸèƒ½</li></ul></div></div><div class="quiz-question"><h4>ğŸ¤” é—®é¢˜2ï¼šåŒç«¯é˜Ÿåˆ—å¦‚ä½•å®ç°é˜Ÿåˆ—çš„åŠŸèƒ½ï¼Ÿ</h4><button class="show-answer-btn" onclick="toggleAnswer('answer2')">æ˜¾ç¤ºç­”æ¡ˆ</button><div id="answer2" class="quiz-answer"><strong>ç­”æ¡ˆï¼š</strong>ä¸€ç«¯æ’å…¥ï¼Œå¦ä¸€ç«¯åˆ é™¤<br><strong>å®ç°æ–¹å¼ï¼š</strong><ul><li><strong>æ ‡å‡†æ–¹æ¡ˆ</strong>ï¼šaddLast()ä½œä¸ºenqueueï¼ŒremoveFirst()ä½œä¸ºdequeue</li><li><strong>åå‘æ–¹æ¡ˆ</strong>ï¼šaddFirst()ä½œä¸ºenqueueï¼ŒremoveLast()ä½œä¸ºdequeue</li><li><strong>æ•ˆæœ</strong>ï¼šå®ç°äº†é˜Ÿåˆ—çš„FIFOï¼ˆå…ˆè¿›å…ˆå‡ºï¼‰ç‰¹æ€§</li><li><strong>é€‰æ‹©å»ºè®®</strong>ï¼šé€šå¸¸é€‰æ‹©æ ‡å‡†æ–¹æ¡ˆï¼Œç¬¦åˆç›´è§‰</li></ul></div></div><div class="quiz-question"><h4>ğŸ¤” é—®é¢˜3ï¼šå¯¹ç©ºçš„åŒç«¯é˜Ÿåˆ—æ‰§è¡Œï¼šaddFirst(1), addLast(2), addFirst(3), removeLast(), removeFirst()ï¼Œæœ€ç»ˆç»“æœï¼Ÿ</h4><button class="show-answer-btn" onclick="toggleAnswer('answer3')">æ˜¾ç¤ºç­”æ¡ˆ</button><div id="answer3" class="quiz-answer"><strong>ç­”æ¡ˆï¼š</strong>é˜Ÿåˆ—ä¸­åªå‰©ä¸‹å…ƒç´ 1<br><strong>æ­¥éª¤åˆ†æï¼š</strong><ul><li>åˆå§‹ï¼š[] (ç©ºé˜Ÿåˆ—)</li><li>addFirst(1)ï¼š[1]</li><li>addLast(2)ï¼š[1, 2]</li><li>addFirst(3)ï¼š[3, 1, 2]</li><li>removeLast()ï¼š[3, 1] (åˆ é™¤äº†2)</li><li>removeFirst()ï¼š[1] (åˆ é™¤äº†3)</li></ul></div></div><div class="quiz-question"><h4>ğŸ¤” é—®é¢˜4ï¼šåŒç«¯é˜Ÿåˆ—ç›¸æ¯”å•ç‹¬ä½¿ç”¨æ ˆå’Œé˜Ÿåˆ—çš„ä¼˜åŠ¿æ˜¯ä»€ä¹ˆï¼Ÿ</h4><button class="show-answer-btn" onclick="toggleAnswer('answer4')">æ˜¾ç¤ºç­”æ¡ˆ</button><div id="answer4" class="quiz-answer"><strong>ä¸»è¦ä¼˜åŠ¿ï¼š</strong><ul><li><strong>ç»Ÿä¸€æ¥å£</strong>ï¼šä¸€ä¸ªæ•°æ®ç»“æ„æä¾›æ ˆå’Œé˜Ÿåˆ—çš„æ‰€æœ‰åŠŸèƒ½</li><li><strong>å†…å­˜æ•ˆç‡</strong>ï¼šä¸éœ€è¦ç»´æŠ¤ä¸¤ä¸ªä¸åŒçš„æ•°æ®ç»“æ„</li><li><strong>æ“ä½œçµæ´»</strong>ï¼šå¯ä»¥æ ¹æ®éœ€è¦åœ¨ä»»ä¸€ç«¯æ“ä½œï¼Œé€‚åº”æ€§å¼º</li><li><strong>ç®—æ³•æ”¯æŒ</strong>ï¼šæŸäº›ç®—æ³•ï¼ˆå¦‚æ»‘åŠ¨çª—å£æœ€å€¼ï¼‰éœ€è¦åŒç«¯æ“ä½œ</li><li><strong>æ€§èƒ½ä¼˜åŒ–</strong>ï¼šé¿å…æ•°æ®åœ¨ä¸åŒç»“æ„é—´å¤åˆ¶è½¬ç§»</li></ul></div></div><div class="quiz-question"><h4>ğŸ¤” é—®é¢˜5ï¼šä»€ä¹ˆæ˜¯æ»‘åŠ¨çª—å£æœ€å€¼é—®é¢˜ï¼ŒåŒç«¯é˜Ÿåˆ—å¦‚ä½•è§£å†³ï¼Ÿ</h4><button class="show-answer-btn" onclick="toggleAnswer('answer5')">æ˜¾ç¤ºç­”æ¡ˆ</button><div id="answer5" class="quiz-answer"><strong>é—®é¢˜æè¿°ï¼š</strong>ç»™å®šæ•°ç»„å’Œçª—å£å¤§å°kï¼Œæ±‚æ¯ä¸ªçª—å£çš„æœ€å¤§å€¼<br><strong>åŒç«¯é˜Ÿåˆ—è§£æ³•ï¼š</strong><ul><li><strong>å­˜å‚¨ç­–ç•¥</strong>ï¼šé˜Ÿåˆ—ä¸­å­˜å‚¨æ•°ç»„ç´¢å¼•ï¼ŒæŒ‰å€¼çš„å¤§å°æ’åº</li><li><strong>ç»´æŠ¤å•è°ƒæ€§</strong>ï¼šä¿æŒé˜Ÿåˆ—ä¸­çš„å€¼å•è°ƒé€’å‡</li><li><strong>å‰ç«¯æ“ä½œ</strong>ï¼šremoveFirst()ç§»é™¤è¿‡æœŸçš„ç´¢å¼•</li><li><strong>åç«¯æ“ä½œ</strong>ï¼šremoveLast()ç§»é™¤è¾ƒå°çš„å€¼ï¼ŒaddLast()æ·»åŠ æ–°ç´¢å¼•</li><li><strong>æŸ¥è¯¢æœ€å€¼</strong>ï¼špeekFirst()å¾—åˆ°å½“å‰çª—å£æœ€å¤§å€¼çš„ç´¢å¼•</li><li><strong>æ—¶é—´å¤æ‚åº¦</strong>ï¼šO(n)ï¼Œæ¯ä¸ªå…ƒç´ æœ€å¤šè¿›å‡ºé˜Ÿåˆ—ä¸€æ¬¡</li></ul></div></div><h3>ğŸ“š è¿›ä¸€æ­¥å­¦ä¹ å»ºè®®</h3><ul><li>ğŸ”„ <strong>å•è°ƒé˜Ÿåˆ—</strong>ï¼šä½¿ç”¨åŒç«¯é˜Ÿåˆ—è§£å†³æ»‘åŠ¨çª—å£é—®é¢˜</li><li>ğŸŒ³ <strong>åŒç«¯é˜Ÿåˆ—çš„æ ‘éå†</strong>ï¼šå±‚åºéå†çš„å˜ç§ç®—æ³•</li><li>ğŸ§µ <strong>å¹¶å‘åŒç«¯é˜Ÿåˆ—</strong>ï¼šçº¿ç¨‹å®‰å…¨çš„å®ç°æ–¹å¼</li><li>ğŸ¯ <strong>STLä¸­çš„deque</strong>ï¼šC++æ ‡å‡†åº“ä¸­åŒç«¯é˜Ÿåˆ—çš„å®ç°åŸç†</li></ul></div><!-- å¯¼èˆªæŒ‰é’® --><div style="text-align: center; margin-top: 40px;"><a href="{% url 'knowledge_app:index' %}" class="unified-btn unified-btn-primary"><span>ğŸ </span>
            è¿”å›é¦–é¡µ
        </a><a href="{% url 'knowledge_app:cs_universe' %}" class="unified-btn unified-btn-secondary"><span>ğŸŒŒ</span>
            æ¢ç´¢CSå®‡å®™
        </a></div></div><script>class Particle { constructor(x, y, color) { this.x = x; this.y = y; this.vx = (Math.random() - 0.5) * 6; this.vy = (Math.random() - 0.5) * 6; this.life = 1.0; this.decay = 0.02; this.color = color; this.size = Math.random() * 4 + 2; } update() { this.x += this.vx; this.y += this.vy; this.life -= this.decay; this.size *= 0.98; } draw(ctx) { ctx.save(); ctx.globalAlpha = this.life; ctx.fillStyle = this.color; ctx.beginPath(); ctx.arc(this.x, this.y, this.size, 0, Math.PI * 2); ctx.fill(); ctx.restore(); } isDead() { return this.life <= 0 || this.size <= 0.1; } } class DequeVisual { constructor(canvasId, capacity = 8) { this.canvas = document.getElementById(canvasId); this.ctx = this.canvas.getContext('2d'); this.capacity = capacity; this.data = new Array(capacity); this.frontIndex = 0; this.backIndex = 0; this.size = 0; this.animating = false; this.particles = []; this.cellWidth = 70; this.cellHeight = 60; this.spacing = 10; this.startX = (this.canvas.width - (this.cellWidth + this.spacing) * capacity) / 2; this.startY = this.canvas.height / 2 - this.cellHeight / 2; this.hoveredIndex = -1; this.glowIntensity = 0; this.glowDirection = 1; this.startAnimationLoop(); this.draw(); this.canvas.addEventListener('mousemove', (e) => this.handleMouseMove(e)); this.canvas.addEventListener('mouseleave', () => this.hoveredIndex = -1); } handleMouseMove(e) { const rect = this.canvas.getBoundingClientRect(); const x = e.clientX - rect.left; const y = e.clientY - rect.top; this.hoveredIndex = -1; for (let i = 0; i < this.capacity; i++) { const cellX = this.startX + i * (this.cellWidth + this.spacing); if (x >= cellX && x <= cellX + this.cellWidth && y >= this.startY && y <= this.startY + this.cellHeight) { this.hoveredIndex = i; break; } } } startAnimationLoop() { const animate = () => { this.glowIntensity += this.glowDirection * 0.02; if (this.glowIntensity >= 1) { this.glowIntensity = 1; this.glowDirection = -1; } else if (this.glowIntensity <= 0) { this.glowIntensity = 0; this.glowDirection = 1; } this.particles = this.particles.filter(particle => { particle.update(); return !particle.isDead(); }); if (!this.animating) { this.draw(); } requestAnimationFrame(animate); }; animate(); } createParticles(x, y, color, count = 15) { for (let i = 0; i < count; i++) { this.particles.push(new Particle(x, y, color)); } } draw() { this.ctx.clearRect(0, 0, this.canvas.width, this.canvas.height); const gradient = this.ctx.createLinearGradient(0, 0, 0, this.canvas.height); gradient.addColorStop(0, '#f8f9fa'); gradient.addColorStop(1, '#e9ecef'); this.ctx.fillStyle = gradient; this.ctx.fillRect(0, 0, this.canvas.width, this.canvas.height); this.ctx.fillStyle = '#2c3e50'; this.ctx.font = 'bold 20px Arial'; this.ctx.textAlign = 'center'; this.ctx.fillText('âŸ· åŒç«¯é˜Ÿåˆ—å¯è§†åŒ– - ä¸¤ç«¯éƒ½èƒ½æ“ä½œ', this.canvas.width / 2, 35); this.ctx.font = '14px Arial'; this.ctx.fillStyle = '#7f8c8d'; this.ctx.fillText('ç»¿è‰²=å‰ç«¯åŒºåŸŸ | æ©™è‰²=åç«¯åŒºåŸŸ | è“è‰²=æ•°æ®å…ƒç´  | ç°è‰²=ç©ºä½', this.canvas.width / 2, 55); this.drawDequeFramework(); this.drawPointers(); this.drawOperationIndicators(); this.particles.forEach(particle => particle.draw(this.ctx)); this.updateStatus(); } drawDequeFramework() { for (let i = 0; i < this.capacity; i++) { this.drawCell(i); } } drawCell(index) { const x = this.startX + index * (this.cellWidth + this.spacing); const y = this.startY; const isInDeque = this.isIndexInDeque(index); const isHovered = this.hoveredIndex === index; const isFrontRegion = this.isFrontRegion(index); const isBackRegion = this.isBackRegion(index); let fillColor, strokeColor; if (isInDeque) { if (index === this.frontIndex) { fillColor = '#27ae60'; strokeColor = '#229954'; } else if (index === (this.backIndex - 1 + this.capacity) % this.capacity && this.size > 0) { fillColor = '#e74c3c'; strokeColor = '#c0392b'; } else { fillColor = '#3498db'; strokeColor = '#2980b9'; } } else { if (isFrontRegion) { fillColor = '#d5f4e6'; strokeColor = '#27ae60'; } else if (isBackRegion) { fillColor = '#fdeaea'; strokeColor = '#e74c3c'; } else { fillColor = '#ffffff'; strokeColor = '#bdc3c7'; } } if (isHovered || isInDeque) { this.ctx.shadowColor = 'rgba(0, 0, 0, 0.2)'; this.ctx.shadowBlur = isHovered ? 15 : 8; this.ctx.shadowOffsetX = 2; this.ctx.shadowOffsetY = 2; } this.ctx.fillStyle = fillColor; this.ctx.strokeStyle = strokeColor; this.ctx.lineWidth = isHovered ? 3 : 2; this.ctx.fillRect(x, y, this.cellWidth, this.cellHeight); this.ctx.strokeRect(x, y, this.cellWidth, this.cellHeight); this.ctx.shadowBlur = 0; this.ctx.shadowOffsetX = 0; this.ctx.shadowOffsetY = 0; if (isInDeque && this.glowIntensity > 0) { this.ctx.save(); this.ctx.globalAlpha = this.glowIntensity * 0.3; this.ctx.strokeStyle = fillColor; this.ctx.lineWidth = 4; this.ctx.strokeRect(x - 2, y - 2, this.cellWidth + 4, this.cellHeight + 4); this.ctx.restore(); } if (isInDeque && this.data[index] !== undefined) { this.ctx.fillStyle = '#ffffff'; this.ctx.font = 'bold 18px Arial'; this.ctx.textAlign = 'center'; this.ctx.fillText(this.data[index].toString(), x + this.cellWidth/2, y + this.cellHeight/2 + 6); } this.ctx.fillStyle = '#7f8c8d'; this.ctx.font = 'bold 12px Arial'; this.ctx.textAlign = 'center'; this.ctx.fillText(`[${index}]`, x + this.cellWidth/2, y + this.cellHeight + 20); if (isHovered) { this.drawTooltip(x, y, index); } } drawPointers() { if (this.size === 0) return; const frontX = this.startX + this.frontIndex * (this.cellWidth + this.spacing) + this.cellWidth/2; const frontY = this.startY - 30; this.ctx.fillStyle = '#27ae60'; this.ctx.font = 'bold 16px Arial'; this.ctx.textAlign = 'center'; this.ctx.fillText('â¬…ï¸ Front', frontX, frontY); this.drawArrow(frontX, frontY + 5, frontX, this.startY - 5, '#27ae60'); const backX = this.startX + this.backIndex * (this.cellWidth + this.spacing) + this.cellWidth/2; const backY = this.startY + this.cellHeight + 50; this.ctx.fillStyle = '#e74c3c'; this.ctx.fillText('Back â¡ï¸', backX, backY); this.drawArrow(backX, backY - 15, backX, this.startY + this.cellHeight + 5, '#e74c3c'); } drawOperationIndicators() { this.ctx.fillStyle = 'rgba(39, 174, 96, 0.1)'; this.ctx.fillRect(this.startX - 20, this.startY - 10, this.cellWidth + 40, this.cellHeight + 20); this.ctx.strokeStyle = '#27ae60'; this.ctx.lineWidth = 2; this.ctx.setLineDash([5, 5]); this.ctx.strokeRect(this.startX - 20, this.startY - 10, this.cellWidth + 40, this.cellHeight + 20); this.ctx.fillStyle = '#27ae60'; this.ctx.font = 'bold 12px Arial'; this.ctx.textAlign = 'center'; this.ctx.fillText('å‰ç«¯æ“ä½œåŒº', this.startX + this.cellWidth/2, this.startY - 15); const lastCellX = this.startX + (this.capacity - 1) * (this.cellWidth + this.spacing); this.ctx.fillStyle = 'rgba(231, 76, 60, 0.1)'; this.ctx.fillRect(lastCellX - 20, this.startY - 10, this.cellWidth + 40, this.cellHeight + 20); this.ctx.strokeStyle = '#e74c3c'; this.ctx.lineWidth = 2; this.ctx.setLineDash([5, 5]); this.ctx.strokeRect(lastCellX - 20, this.startY - 10, this.cellWidth + 40, this.cellHeight + 20); this.ctx.fillStyle = '#e74c3c'; this.ctx.fillText('åç«¯æ“ä½œåŒº', lastCellX + this.cellWidth/2, this.startY - 15); this.ctx.setLineDash([]); } drawArrow(fromX, fromY, toX, toY, color) { this.ctx.strokeStyle = color; this.ctx.fillStyle = color; this.ctx.lineWidth = 3; this.ctx.beginPath(); this.ctx.moveTo(fromX, fromY); this.ctx.lineTo(toX, toY); this.ctx.stroke(); const headSize = 8; const angle = Math.atan2(toY - fromY, toX - fromX); this.ctx.beginPath(); this.ctx.moveTo(toX, toY); this.ctx.lineTo(toX - headSize * Math.cos(angle - Math.PI/6), toY - headSize * Math.sin(angle - Math.PI/6)); this.ctx.lineTo(toX - headSize * Math.cos(angle + Math.PI/6), toY - headSize * Math.sin(angle + Math.PI/6)); this.ctx.closePath(); this.ctx.fill(); } drawTooltip(x, y, index) { const isInDeque = this.isIndexInDeque(index); let text = `ç´¢å¼• ${index}`; if (isInDeque) { text += `\næ•°æ®: ${this.data[index]}`; if (index === this.frontIndex) { text += '\nä½ç½®: å‰ç«¯ (Front)'; } else if (index === (this.backIndex - 1 + this.capacity) % this.capacity && this.size > 0) { text += '\nä½ç½®: åç«¯ (Back-1)'; } else { text += '\nä½ç½®: ä¸­é—´å…ƒç´ '; } } else { if (index === this.backIndex) { text += '\nçŠ¶æ€: ä¸‹ä¸€ä¸ªåç«¯æ’å…¥ä½ç½®'; } else if (this.isFrontRegion(index)) { text += '\nçŠ¶æ€: å‰ç«¯æ“ä½œåŒºåŸŸ'; } else if (this.isBackRegion(index)) { text += '\nçŠ¶æ€: åç«¯æ“ä½œåŒºåŸŸ'; } else { text += '\nçŠ¶æ€: ç©ºé—²ä½ç½®'; } } const lines = text.split('\n'); const padding = 10; const lineHeight = 16; const tooltipWidth = 160; const tooltipHeight = lines.length * lineHeight + padding * 2; let tooltipX = x + this.cellWidth/2 - tooltipWidth/2; let tooltipY = y - tooltipHeight - 10; if (tooltipX < 0) tooltipX = 0; if (tooltipX + tooltipWidth > this.canvas.width) tooltipX = this.canvas.width - tooltipWidth; if (tooltipY < 0) tooltipY = y + this.cellHeight + 10; this.ctx.fillStyle = 'rgba(44, 62, 80, 0.95)'; this.ctx.fillRect(tooltipX, tooltipY, tooltipWidth, tooltipHeight); this.ctx.fillStyle = '#ffffff'; this.ctx.font = '12px Arial'; this.ctx.textAlign = 'center'; lines.forEach((line, i) => { this.ctx.fillText(line, tooltipX + tooltipWidth/2, tooltipY + padding + (i + 1) * lineHeight); }); } isIndexInDeque(index) { if (this.size === 0) return false; if (this.frontIndex <= this.backIndex - 1) { return index >= this.frontIndex && index < this.backIndex; } else { return index >= this.frontIndex || index < this.backIndex; } } isFrontRegion(index) { return index <= 1; } isBackRegion(index) { return index >= this.capacity - 2; } async addFirst(value) { if (this.animating) return false; if (this.size >= this.capacity) { this.showMessage('åŒç«¯é˜Ÿåˆ—å·²æ»¡ï¼', '#e74c3c'); return false; } this.animating = true; const newFrontIndex = (this.frontIndex - 1 + this.capacity) % this.capacity; const cellX = this.startX + newFrontIndex * (this.cellWidth + this.spacing) + this.cellWidth/2; const cellY = this.startY + this.cellHeight/2; this.createParticles(cellX, cellY, '#27ae60', 12); await this.animateAddFirst(value, newFrontIndex); this.frontIndex = newFrontIndex; this.data[this.frontIndex] = value; this.size++; this.animating = false; this.showMessage(`å‰ç«¯æ’å…¥: ${value}`, '#27ae60'); return true; } async addLast(value) { if (this.animating) return false; if (this.size >= this.capacity) { this.showMessage('åŒç«¯é˜Ÿåˆ—å·²æ»¡ï¼', '#e74c3c'); return false; } this.animating = true; const cellX = this.startX + this.backIndex * (this.cellWidth + this.spacing) + this.cellWidth/2; const cellY = this.startY + this.cellHeight/2; this.createParticles(cellX, cellY, '#e74c3c', 12); await this.animateAddLast(value); this.data[this.backIndex] = value; this.backIndex = (this.backIndex + 1) % this.capacity; this.size++; this.animating = false; this.showMessage(`åç«¯æ’å…¥: ${value}`, '#e74c3c'); return true; } async removeFirst() { if (this.animating) return null; if (this.size === 0) { this.showMessage('åŒç«¯é˜Ÿåˆ—ä¸ºç©ºï¼', '#e74c3c'); return null; } this.animating = true; const value = this.data[this.frontIndex]; const cellX = this.startX + this.frontIndex * (this.cellWidth + this.spacing) + this.cellWidth/2; const cellY = this.startY + this.cellHeight/2; this.createParticles(cellX, cellY, '#f39c12', 12); await this.animateRemoveFirst(); delete this.data[this.frontIndex]; this.frontIndex = (this.frontIndex + 1) % this.capacity; this.size--; this.animating = false; this.showMessage(`å‰ç«¯åˆ é™¤: ${value}`, '#f39c12'); return value; } async removeLast() { if (this.animating) return null; if (this.size === 0) { this.showMessage('åŒç«¯é˜Ÿåˆ—ä¸ºç©ºï¼', '#e74c3c'); return null; } this.animating = true; const lastIndex = (this.backIndex - 1 + this.capacity) % this.capacity; const value = this.data[lastIndex]; const cellX = this.startX + lastIndex * (this.cellWidth + this.spacing) + this.cellWidth/2; const cellY = this.startY + this.cellHeight/2; this.createParticles(cellX, cellY, '#9b59b6', 12); await this.animateRemoveLast(); delete this.data[lastIndex]; this.backIndex = lastIndex; this.size--; this.animating = false; this.showMessage(`åç«¯åˆ é™¤: ${value}`, '#9b59b6'); return value; } async animateAddFirst(value, targetIndex) { return new Promise(resolve => { let step = 0; const maxSteps = 30; const animate = () => { this.draw(); const targetX = this.startX + targetIndex * (this.cellWidth + this.spacing); const progress = this.easeOutCubic(step / maxSteps); const currentX = targetX - 100 + 100 * progress; const currentY = this.startY - 20 + 20 * progress; this.ctx.save(); this.ctx.globalAlpha = Math.min(1, step / 10); this.ctx.shadowColor = 'rgba(39, 174, 96, 0.5)'; this.ctx.shadowBlur = 15; this.ctx.shadowOffsetX = 3; this.ctx.shadowOffsetY = 3; this.ctx.fillStyle = '#27ae60'; this.ctx.strokeStyle = '#229954'; this.ctx.lineWidth = 3; this.ctx.fillRect(currentX, currentY, this.cellWidth, this.cellHeight); this.ctx.strokeRect(currentX, currentY, this.cellWidth, this.cellHeight); this.ctx.shadowBlur = 0; this.ctx.shadowOffsetX = 0; this.ctx.shadowOffsetY = 0; this.ctx.fillStyle = '#ffffff'; this.ctx.font = 'bold 18px Arial'; this.ctx.textAlign = 'center'; this.ctx.fillText(value.toString(), currentX + this.cellWidth/2, currentY + this.cellHeight/2 + 6); this.ctx.restore(); step++; if (step <= maxSteps) { setTimeout(animate, 30); } else { resolve(); } }; animate(); }); } async animateAddLast(value) { return new Promise(resolve => { let step = 0; const maxSteps = 30; const animate = () => { this.draw(); const targetX = this.startX + this.backIndex * (this.cellWidth + this.spacing); const progress = this.easeOutCubic(step / maxSteps); const currentX = targetX + 100 - 100 * progress; const currentY = this.startY - 20 + 20 * progress; this.ctx.save(); this.ctx.globalAlpha = Math.min(1, step / 10); this.ctx.shadowColor = 'rgba(231, 76, 60, 0.5)'; this.ctx.shadowBlur = 15; this.ctx.shadowOffsetX = 3; this.ctx.shadowOffsetY = 3; this.ctx.fillStyle = '#e74c3c'; this.ctx.strokeStyle = '#c0392b'; this.ctx.lineWidth = 3; this.ctx.fillRect(currentX, currentY, this.cellWidth, this.cellHeight); this.ctx.strokeRect(currentX, currentY, this.cellWidth, this.cellHeight); this.ctx.shadowBlur = 0; this.ctx.shadowOffsetX = 0; this.ctx.shadowOffsetY = 0; this.ctx.fillStyle = '#ffffff'; this.ctx.font = 'bold 18px Arial'; this.ctx.textAlign = 'center'; this.ctx.fillText(value.toString(), currentX + this.cellWidth/2, currentY + this.cellHeight/2 + 6); this.ctx.restore(); step++; if (step <= maxSteps) { setTimeout(animate, 30); } else { resolve(); } }; animate(); }); } async animateRemoveFirst() { return new Promise(resolve => { let step = 0; const maxSteps = 30; const animate = () => { this.draw(); const startX = this.startX + this.frontIndex * (this.cellWidth + this.spacing); const progress = this.easeInCubic(step / maxSteps); const currentX = startX - 100 * progress; const currentY = this.startY - 20 * progress; this.ctx.save(); this.ctx.globalAlpha = 1 - progress; this.ctx.fillStyle = '#f39c12'; this.ctx.strokeStyle = '#d68910'; this.ctx.lineWidth = 3; this.ctx.fillRect(currentX, currentY, this.cellWidth, this.cellHeight); this.ctx.strokeRect(currentX, currentY, this.cellWidth, this.cellHeight); this.ctx.fillStyle = '#ffffff'; this.ctx.font = 'bold 18px Arial'; this.ctx.textAlign = 'center'; this.ctx.fillText(this.data[this.frontIndex].toString(), currentX + this.cellWidth/2, currentY + this.cellHeight/2 + 6); this.ctx.restore(); step++; if (step <= maxSteps) { setTimeout(animate, 30); } else { resolve(); } }; animate(); }); } async animateRemoveLast() { return new Promise(resolve => { let step = 0; const maxSteps = 30; const lastIndex = (this.backIndex - 1 + this.capacity) % this.capacity; const animate = () => { this.draw(); const startX = this.startX + lastIndex * (this.cellWidth + this.spacing); const progress = this.easeInCubic(step / maxSteps); const currentX = startX + 100 * progress; const currentY = this.startY - 20 * progress; this.ctx.save(); this.ctx.globalAlpha = 1 - progress; this.ctx.fillStyle = '#9b59b6'; this.ctx.strokeStyle = '#8e44ad'; this.ctx.lineWidth = 3; this.ctx.fillRect(currentX, currentY, this.cellWidth, this.cellHeight); this.ctx.strokeRect(currentX, currentY, this.cellWidth, this.cellHeight); this.ctx.fillStyle = '#ffffff'; this.ctx.font = 'bold 18px Arial'; this.ctx.textAlign = 'center'; this.ctx.fillText(this.data[lastIndex].toString(), currentX + this.cellWidth/2, currentY + this.cellHeight/2 + 6); this.ctx.restore(); step++; if (step <= maxSteps) { setTimeout(animate, 30); } else { resolve(); } }; animate(); }); } easeOutCubic(t) { return 1 - Math.pow(1 - t, 3); } easeInCubic(t) { return t * t * t; } showMessage(message, color) { const statusDiv = document.getElementById('dequeStatus'); statusDiv.innerHTML += `<div style="color: ${color}; margin-top: 5px;">ğŸ”” ${message}</div>`; setTimeout(() => { this.updateStatus(); }, 3000); } updateStatus() { const statusDiv = document.getElementById('dequeStatus'); const frontData = this.size > 0 ? this.data[this.frontIndex] : 'N/A'; const lastIndex = this.size > 0 ? (this.backIndex - 1 + this.capacity) % this.capacity : -1; const backData = lastIndex >= 0 ? this.data[lastIndex] : 'N/A'; statusDiv.innerHTML = ` <div style="display: flex; justify-content: space-around; align-items: center; flex-wrap: wrap;"><span><strong>é˜Ÿåˆ—å¤§å°:</strong> ${this.size}/${this.capacity}</span><span><strong>Frontç´¢å¼•:</strong> ${this.frontIndex}</span><span><strong>Backç´¢å¼•:</strong> ${this.backIndex}</span><span><strong>å‰ç«¯æ•°æ®:</strong> ${frontData}</span><span><strong>åç«¯æ•°æ®:</strong> ${backData}</span></div><div style="margin-top: 10px; font-size: 14px; color: #7f8c8d;"><strong>æ“ä½œè¯´æ˜:</strong> å‰ç«¯æ“ä½œå½±å“FrontæŒ‡é’ˆï¼Œåç«¯æ“ä½œå½±å“BackæŒ‡é’ˆï¼Œä¸¤ç«¯éƒ½å¯ä»¥æ’å…¥å’Œåˆ é™¤ </div> `; } reset() { this.data = new Array(this.capacity); this.frontIndex = 0; this.backIndex = 0; this.size = 0; this.particles = []; this.showMessage('åŒç«¯é˜Ÿåˆ—å·²é‡ç½®', '#3498db'); } async demo() { if (this.animating) return; this.reset(); await new Promise(resolve => setTimeout(resolve, 500)); this.showMessage('æ¼”ç¤ºå¼€å§‹ï¼šå±•ç¤ºåŒç«¯é˜Ÿåˆ—çš„çµæ´»æ“ä½œ', '#9b59b6'); await this.addLast(10); await new Promise(resolve => setTimeout(resolve, 800)); await this.addLast(20); await new Promise(resolve => setTimeout(resolve, 800)); await this.addFirst(5); await new Promise(resolve => setTimeout(resolve, 800)); await this.addFirst(1); await new Promise(resolve => setTimeout(resolve, 800)); this.showMessage('ç°åœ¨é˜Ÿåˆ—ï¼š[1, 5, 10, 20]', '#3498db'); await new Promise(resolve => setTimeout(resolve, 1000)); await this.removeFirst(); await new Promise(resolve => setTimeout(resolve, 800)); await this.removeLast(); await new Promise(resolve => setTimeout(resolve, 800)); await this.addLast(30); await new Promise(resolve => setTimeout(resolve, 800)); await this.addFirst(2); await new Promise(resolve => setTimeout(resolve, 800)); this.showMessage('æ¼”ç¤ºå®Œæˆï¼ä½“éªŒåŒç«¯é˜Ÿåˆ—çš„å¼ºå¤§çµæ´»æ€§', '#27ae60'); } } let deque = new DequeVisual('dequeCanvas', 8); async function addFirst() { const input = document.getElementById('inputValue'); const value = parseInt(input.value); if (isNaN(value) || value < 1 || value > 99) { alert('è¯·è¾“å…¥1-99ä¹‹é—´çš„æœ‰æ•ˆæ•°å­—ï¼'); return; } const success = await deque.addFirst(value); if (success) { input.value = ''; } } async function addLast() { const input = document.getElementById('inputValue'); const value = parseInt(input.value); if (isNaN(value) || value < 1 || value > 99) { alert('è¯·è¾“å…¥1-99ä¹‹é—´çš„æœ‰æ•ˆæ•°å­—ï¼'); return; } const success = await deque.addLast(value); if (success) { input.value = ''; } } async function removeFirst() { await deque.removeFirst(); } async function removeLast() { await deque.removeLast(); } function resetDeque() { deque.reset(); } async function startDemo() { await deque.demo(); } function showCode(language) { document.querySelectorAll('.code-content').forEach(el => el.style.display = 'none'); document.querySelectorAll('.code-tab').forEach(el => el.classList.remove('active')); document.getElementById(language + '-code').style.display = 'block'; event.target.classList.add('active'); } function copyCode(language, button) { const codeElement = document.querySelector(`#${language}-code pre code`); const text = codeElement.textContent; if (navigator.clipboard && window.isSecureContext) { navigator.clipboard.writeText(text).then(() => { showCopySuccess(button); }).catch(() => { fallbackCopyText(text, button); }); } else { fallbackCopyText(text, button); } } function fallbackCopyText(text, button) { const textArea = document.createElement('textarea'); textArea.value = text; textArea.style.position = 'fixed'; textArea.style.left = '-999999px'; textArea.style.top = '-999999px'; document.body.appendChild(textArea); textArea.focus(); textArea.select(); try { document.execCommand('copy'); showCopySuccess(button); } catch (err) { console.error('å¤åˆ¶å¤±è´¥:', err); alert('å¤åˆ¶å¤±è´¥ï¼Œè¯·æ‰‹åŠ¨å¤åˆ¶ä»£ç '); } document.body.removeChild(textArea); } function showCopySuccess(button) { const originalText = button.textContent; const originalBg = button.style.background; button.textContent = 'âœ… å·²å¤åˆ¶'; button.style.background = '#27ae60'; button.style.transform = 'scale(1.1)'; setTimeout(() => { button.textContent = originalText; button.style.background = originalBg; button.style.transform = 'scale(1)'; }, 2000); } function toggleAnswer(answerId) { const answer = document.getElementById(answerId); const btn = event.target; if (answer.style.display === 'none' || answer.style.display === '') { answer.style.display = 'block'; btn.textContent = 'éšè—ç­”æ¡ˆ'; btn.style.background = '#e74c3c'; } else { answer.style.display = 'none'; btn.textContent = 'æ˜¾ç¤ºç­”æ¡ˆ'; btn.style.background = '#17a2b8'; } } document.getElementById('inputValue').addEventListener('keypress', function(e) { if (e.key === 'Enter') { addLast(); } }); document.getElementById('inputValue').addEventListener('focus', function() { this.style.borderColor = '#3498db'; this.style.boxShadow = '0 0 10px rgba(52, 152, 219, 0.3)'; }); document.getElementById('inputValue').addEventListener('blur', function() { this.style.borderColor = '#3498db'; this.style.boxShadow = 'none'; });</script>
{% endblock %}