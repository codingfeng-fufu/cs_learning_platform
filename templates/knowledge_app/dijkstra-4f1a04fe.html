{% extends 'knowledge_app/base.html' %}

{% block title %}Dijkstraæœ€çŸ­è·¯å¾„ç®—æ³• - è®¡ç®—æœºç§‘å­¦å­¦ä¹ å¹³å°{% endblock %}

{% block content %}
<style>
    .visualization-container {
        background: #f8f9fa;
        border-radius: 12px;
        padding: 30px;
        margin: 20px 0;
        box-shadow: 0 2px 8px rgba(0,0,0,0.1);
    }

    .concept-card {
        background: white;
        border-radius: 8px;
        padding: 20px;
        margin: 15px 0;
        border-left: 4px solid #28a745;
    }

    .key-term {
        display: inline-block;
        background: #d4edda;
        padding: 4px 8px;
        border-radius: 4px;
        margin: 2px;
        font-weight: 600;
    }

    .difficulty-badge {
        display: inline-block;
        padding: 6px 12px;
        border-radius: 20px;
        font-weight: bold;
        margin: 10px 0;
    }

    .difficulty-hard {
        background: #f8d7da;
        color: #721c24;
    }

    .code-tabs {
        display: flex;
        gap: 10px;
        margin-bottom: 10px;
        border-bottom: 2px solid #e0e0e0;
    }

    .code-tab {
        padding: 10px 20px;
        cursor: pointer;
        background: #f5f5f5;
        border: none;
        border-radius: 8px 8px 0 0;
        transition: all 0.3s;
    }

    .code-tab.active {
        background: #28a745;
        color: white;
    }

    .code-content {
        display: none;
        background: #2d2d2d;
        color: #f8f8f2;
        padding: 20px;
        border-radius: 0 8px 8px 8px;
        position: relative;
        font-family: 'Courier New', monospace;
        overflow-x: auto;
    }

    .code-content.active {
        display: block;
    }

    .copy-btn {
        position: absolute;
        top: 10px;
        right: 10px;
        padding: 6px 12px;
        background: #28a745;
        color: white;
        border: none;
        border-radius: 4px;
        cursor: pointer;
        font-size: 12px;
    }

    .copy-btn:hover {
        background: #218838;
    }

    #dijkstraCanvas {
        border: 2px solid #ddd;
        border-radius: 8px;
        margin: 20px auto;
        display: block;
        background: linear-gradient(to bottom, #f8f9fa, #e9ecef);
        cursor: crosshair;
        box-shadow: 0 4px 6px rgba(0,0,0,0.1);
    }

    .info-panel {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
        gap: 15px;
        margin: 20px 0;
    }

    .info-card {
        background: white;
        padding: 10px;
        border-radius: 8px;
        text-align: center;
        box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    }

    .info-card .value {
        font-size: 24px;
        font-weight: bold;
        color: #007bff;
    }

    .info-card .label {
        font-size: 12px;
        color: #666;
        margin-top: 5px;
    }

    @keyframes pulse {
        0% { transform: scale(1); }
        50% { transform: scale(1.1); }
        100% { transform: scale(1); }
    }

    @keyframes glow {
        0% { box-shadow: 0 0 5px rgba(40, 167, 69, 0.5); }
        50% { box-shadow: 0 0 20px rgba(40, 167, 69, 0.8); }
        100% { box-shadow: 0 0 5px rgba(40, 167, 69, 0.5); }
    }

    .control-panel {
        text-align: center;
        margin: 20px 0;
    }

    .control-btn {
        padding: 10px 20px;
        margin: 0 5px;
        background: #007bff;
        color: white;
        border: none;
        border-radius: 6px;
        cursor: pointer;
        font-size: 14px;
        transition: all 0.3s;
    }

    .control-btn:hover {
        background: #0056b3;
        transform: translateY(-2px);
    }

    .control-btn.danger {
        background: #dc3545;
    }

    .control-btn.danger:hover {
        background: #c82333;
    }

    .speed-control {
        display: inline-block;
        margin: 0 15px;
    }

    .speed-control label {
        margin-right: 10px;
        font-weight: 600;
    }

    .quiz-item {
        background: #f8f9fa;
        padding: 20px;
        margin: 15px 0;
        border-radius: 8px;
        border: 2px solid #e9ecef;
    }

    .quiz-question {
        font-weight: 600;
        margin-bottom: 10px;
        color: #333;
    }

    .show-answer-btn {
        padding: 8px 16px;
        background: #17a2b8;
        color: white;
        border: none;
        border-radius: 4px;
        cursor: pointer;
        margin-top: 10px;
    }

    .quiz-answer {
        display: none;
        background: #d4edda;
        padding: 15px;
        border-radius: 6px;
        margin-top: 10px;
        border-left: 4px solid #28a745;
    }

    .analogy-box {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
        padding: 25px;
        border-radius: 12px;
        margin: 20px 0;
    }

    .application-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
        gap: 20px;
        margin: 20px 0;
    }

    .app-card {
        background: white;
        padding: 20px;
        border-radius: 8px;
        box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        transition: transform 0.3s;
    }

    .app-card:hover {
        transform: translateY(-5px);
        box-shadow: 0 4px 8px rgba(0,0,0,0.15);
    }

    .highlight {
        background: #ffeb3b;
        padding: 2px 4px;
        border-radius: 3px;
    }

    .distance-table {
        margin: 20px auto;
        border-collapse: collapse;
        background: white;
    }

    .distance-table th, .distance-table td {
        border: 1px solid #ddd;
        padding: 8px 12px;
        text-align: center;
    }

    .distance-table th {
        background: #f0f0f0;
        font-weight: 600;
    }

    .node-visited {
        background: #d4edda !important;
    }

    .node-current {
        background: #fff3cd !important;
    }

    .algorithm-step {
        background: #f8f9fa;
        padding: 15px;
        margin: 10px 0;
        border-radius: 8px;
        border-left: 4px solid #007bff;
    }

    .step-number {
        display: inline-block;
        width: 30px;
        height: 30px;
        background: #007bff;
        color: white;
        border-radius: 50%;
        text-align: center;
        line-height: 30px;
        margin-right: 10px;
        font-weight: bold;
    }
</style>

<div class="page-container fade-in">
    <!-- é¢åŒ…å±‘å¯¼èˆª -->
    <div class="breadcrumb">
        <a href="{% url 'knowledge_app:index' %}">é¦–é¡µ</a>
        <span>></span>
        <span>ç®—æ³•</span>
        <span>></span>
        <span>Dijkstraæœ€çŸ­è·¯å¾„ç®—æ³•</span>
    </div>

    <!-- é¡µé¢å¤´éƒ¨ -->
    <div class="page-header slide-in-left">
        <h1>
            <span class="page-icon">ğŸ›¤ï¸</span>
            Dijkstraæœ€çŸ­è·¯å¾„ç®—æ³•
        </h1>
        <p>æ‰¾åˆ°æœ€ä¼˜è·¯çº¿çš„æ™ºèƒ½å¯¼èˆªç®—æ³• - è®©æ¯ä¸€æ­¥éƒ½æ˜¯æœ€ä½³é€‰æ‹©</p>
    </div>

    <!-- çŸ¥è¯†ç‚¹æ¦‚è¿° -->
    <div class="content-card slide-in-right">
        <h2 class="section-title">
            <span class="section-icon">ğŸ“‹</span>
            çŸ¥è¯†ç‚¹æ¦‚è¿°
        </h2>

        <div class="concept-card">
            <p style="font-size: 18px; line-height: 1.6;">
                <strong>æ ¸å¿ƒæ¦‚å¿µï¼š</strong>Dijkstraç®—æ³•å°±åƒä¸€ä¸ª<span class="highlight">æ™ºèƒ½å¯¼èˆªç³»ç»Ÿ</span>ï¼Œä»èµ·ç‚¹å¼€å§‹ï¼Œé€æ­¥æ¢ç´¢æ‰€æœ‰å¯èƒ½çš„è·¯å¾„ï¼Œå§‹ç»ˆé€‰æ‹©å½“å‰æœ€çŸ­çš„è·¯å¾„å‰è¿›ï¼Œæœ€ç»ˆæ‰¾åˆ°åˆ°è¾¾æ‰€æœ‰åœ°ç‚¹çš„æœ€çŸ­è·¯çº¿ï¼
            </p>

            <div style="margin: 20px 0;">
                <h4>ğŸ”¤ å…³é”®æœ¯è¯­ï¼š</h4>
                <span class="key-term">æºç‚¹(Source)</span> - å‡ºå‘ç‚¹ï¼Œç®—æ³•å¼€å§‹çš„åœ°æ–¹<br>
                <span class="key-term">æ¾å¼›(Relaxation)</span> - å‘ç°æ›´çŸ­è·¯å¾„æ—¶æ›´æ–°è·ç¦»<br>
                <span class="key-term">è´ªå¿ƒç­–ç•¥</span> - æ¯æ¬¡é€‰æ‹©å½“å‰æœ€ä¼˜çš„èŠ‚ç‚¹<br>
                <span class="key-term">ä¼˜å…ˆé˜Ÿåˆ—</span> - æŒ‰è·ç¦»æ’åºçš„å¾…è®¿é—®èŠ‚ç‚¹é˜Ÿåˆ—<br>
                <span class="key-term">æœ€çŸ­è·¯å¾„æ ‘</span> - åŒ…å«æ‰€æœ‰æœ€çŸ­è·¯å¾„çš„æ ‘ç»“æ„
            </div>

            <div class="difficulty-badge difficulty-hard">
                ğŸ“Š å­¦ä¹ éš¾åº¦ï¼šé«˜çº§
            </div>

            <div style="margin-top: 15px;">
                <strong>å‰ç½®çŸ¥è¯†ï¼š</strong>å›¾è®ºåŸºç¡€ã€ä¼˜å…ˆé˜Ÿåˆ—ã€è´ªå¿ƒç®—æ³•æ€æƒ³
            </div>
        </div>
    </div>

    <!-- æ¦‚å¿µè¯¦è§£ -->
    <div class="content-card">
        <h2 class="section-title">
            <span class="section-icon">ğŸ”</span>
            æ¦‚å¿µè¯¦è§£
        </h2>

        <div class="analogy-box">
            <h3>ğŸšš ç”Ÿæ´»ç±»æ¯”ï¼šå¿«é€’é…é€è·¯çº¿è§„åˆ’</h3>
            <p>æƒ³è±¡ä½ æ˜¯ä¸€ä¸ªå¿«é€’å‘˜ï¼Œè¦ä»é…é€ä¸­å¿ƒå‡ºå‘é€è´§ï¼š</p>
            <ul style="list-style: none; padding-left: 0;">
                <li>ğŸ“ é…é€ä¸­å¿ƒæ˜¯èµ·ç‚¹ï¼ˆæºç‚¹ï¼‰</li>
                <li>ğŸ˜ï¸ æ¯ä¸ªå®¢æˆ·æ˜¯ä¸€ä¸ªèŠ‚ç‚¹</li>
                <li>ğŸ›£ï¸ é“è·¯é•¿åº¦æ˜¯è¾¹çš„æƒé‡</li>
                <li>ğŸ“‹ ä½ æœ‰ä¸€ä¸ªè¡¨æ ¼è®°å½•åˆ°æ¯ä¸ªåœ°ç‚¹çš„æœ€çŸ­è·ç¦»</li>
                <li>âœ… æ¯æ¬¡é€‰æ‹©æœ€è¿‘çš„æœªé€è¾¾åœ°ç‚¹</li>
                <li>ğŸ”„ å‘ç°æ›´è¿‘çš„è·¯çº¿å°±æ›´æ–°è®°å½•ï¼ˆæ¾å¼›æ“ä½œï¼‰</li>
            </ul>
        </div>

        <div class="concept-card">
            <h4>1ï¸âƒ£ ç®—æ³•æ ¸å¿ƒæ€æƒ³</h4>
            <p><strong>è´ªå¿ƒé€‰æ‹©ï¼š</strong>æ¯æ¬¡é€‰æ‹©è·ç¦»æºç‚¹æœ€è¿‘çš„æœªè®¿é—®èŠ‚ç‚¹ï¼Œè¿™ä¸ªé€‰æ‹©æ˜¯æœ€ä¼˜çš„ï¼Œä¸ä¼šå†æ”¹å˜ã€‚</p>
            <p><strong>ä¸ºä»€ä¹ˆæ˜¯æ­£ç¡®çš„ï¼Ÿ</strong></p>
            <ul>
                <li>å‡è®¾é€‰ä¸­èŠ‚ç‚¹Aï¼Œè·ç¦»æ˜¯d</li>
                <li>å¦‚æœå­˜åœ¨æ›´çŸ­è·¯å¾„ï¼Œå¿…é¡»ç»è¿‡å…¶ä»–æœªè®¿é—®èŠ‚ç‚¹B</li>
                <li>ä½†Bçš„è·ç¦»â‰¥dï¼ˆå¦åˆ™ä¼šé€‰Bè€Œä¸æ˜¯Aï¼‰</li>
                <li>æ‰€ä»¥ç»è¿‡Båˆ°Açš„è·¯å¾„å¿…ç„¶>d</li>
            </ul>
        </div>

        <div class="concept-card">
            <h4>2ï¸âƒ£ æ¾å¼›æ“ä½œçš„æœ¬è´¨</h4>
            <p>æ¾å¼›å°±åƒåœ¨é—®ï¼š"ç»è¿‡æˆ‘åˆ°è¾¾ä½ ï¼Œä¼šä¸ä¼šæ›´è¿‘ï¼Ÿ"</p>
            <pre style="background: #f0f0f0; padding: 10px; border-radius: 5px;">
if (distance[u] + weight(u,v) < distance[v]) {
    distance[v] = distance[u] + weight(u,v);  // æ‰¾åˆ°æ›´çŸ­è·¯å¾„ï¼
    previous[v] = u;  // è®°å½•è·¯å¾„
}
            </pre>
        </div>

        <div class="concept-card">
            <h4>3ï¸âƒ£ ç®—æ³•æ‰§è¡Œæ­¥éª¤</h4>
            <div class="algorithm-step">
                <span class="step-number">1</span>
                åˆå§‹åŒ–ï¼šæºç‚¹è·ç¦»ä¸º0ï¼Œå…¶ä»–èŠ‚ç‚¹è·ç¦»ä¸ºâˆ
            </div>
            <div class="algorithm-step">
                <span class="step-number">2</span>
                é€‰æ‹©æœªè®¿é—®èŠ‚ç‚¹ä¸­è·ç¦»æœ€å°çš„èŠ‚ç‚¹
            </div>
            <div class="algorithm-step">
                <span class="step-number">3</span>
                æ ‡è®°è¯¥èŠ‚ç‚¹ä¸ºå·²è®¿é—®
            </div>
            <div class="algorithm-step">
                <span class="step-number">4</span>
                æ›´æ–°æ‰€æœ‰é‚»å±…èŠ‚ç‚¹çš„è·ç¦»ï¼ˆæ¾å¼›æ“ä½œï¼‰
            </div>
            <div class="algorithm-step">
                <span class="step-number">5</span>
                é‡å¤æ­¥éª¤2-4ï¼Œç›´åˆ°æ‰€æœ‰èŠ‚ç‚¹éƒ½è¢«è®¿é—®
            </div>
        </div>

        <div class="concept-card" style="background: #fff3cd; border-left-color: #ffc107;">
            <h4>âš ï¸ åˆå­¦è€…æ˜“æ··æ·†ç‚¹</h4>
            <ul>
                <li>Dijkstraç®—æ³•<strong>ä¸èƒ½å¤„ç†è´Ÿæƒè¾¹</strong>ï¼ˆéœ€è¦ç”¨Bellman-Fordï¼‰</li>
                <li>è´ªå¿ƒé€‰æ‹©æ˜¯å…¨å±€æœ€ä¼˜çš„ï¼Œä¸€æ—¦ç¡®å®šå°±ä¸ä¼šæ”¹å˜</li>
                <li>æ—¶é—´å¤æ‚åº¦å–å†³äºæ•°æ®ç»“æ„ï¼šO(VÂ²)æˆ–O((V+E)logV)</li>
                <li>éœ€è¦è®°å½•å‰é©±èŠ‚ç‚¹æ‰èƒ½é‡å»ºè·¯å¾„</li>
            </ul>
        </div>
    </div>

    <!-- å¯è§†åŒ–å±•ç¤º -->
    <div class="content-card">
        <h2 class="section-title">
            <span class="section-icon">ğŸ“Š</span>
            å¯è§†åŒ–å±•ç¤º
        </h2>

        <div class="visualization-container">
            <h3 style="text-align: center;">ğŸ¯ Dijkstraç®—æ³•åŠ¨æ€æ¼”ç¤º</h3>

            <div class="info-panel">
                <div class="info-card">
                    <div class="value" id="nodeCount">0</div>
                    <div class="label">èŠ‚ç‚¹æ•°</div>
                </div>
                <div class="info-card">
                    <div class="value" id="edgeCount">0</div>
                    <div class="label">è¾¹æ•°</div>
                </div>
                <div class="info-card">
                    <div class="value" id="visitedCount">0</div>
                    <div class="label">å·²è®¿é—®</div>
                </div>
                <div class="info-card">
                    <div class="value" id="currentDist">-</div>
                    <div class="label">å½“å‰è·ç¦»</div>
                </div>
            </div>

            <canvas id="dijkstraCanvas" width="800" height="500"></canvas>

            <div class="control-panel">
                <button class="control-btn" onclick="startAlgorithm()">â–¶ï¸ å¼€å§‹ç®—æ³•</button>
                <button class="control-btn" onclick="pauseAlgorithm()">â¸ï¸ æš‚åœ</button>
                <button class="control-btn" onclick="resetGraph()">ğŸ”„ é‡ç½®</button>
                <button class="control-btn" onclick="generateRandomGraph()">ğŸ² éšæœºå›¾</button>
                <button class="control-btn danger" onclick="clearGraph()">ğŸ—‘ï¸ æ¸…ç©º</button>

                <div class="speed-control">
                    <label for="speedSlider">åŠ¨ç”»é€Ÿåº¦ï¼š</label>
                    <input type="range" id="speedSlider" min="100" max="2000" value="1000" step="100">
                    <span id="speedValue">1000ms</span>
                </div>
            </div>

            <div style="margin-top: 20px;">
                <table class="distance-table" id="distanceTable">
                    <thead>
                        <tr>
                            <th>èŠ‚ç‚¹</th>
                            <th>è·ç¦»</th>
                            <th>å‰é©±</th>
                            <th>çŠ¶æ€</th>
                        </tr>
                    </thead>
                    <tbody id="distanceTableBody">
                        <!-- åŠ¨æ€ç”Ÿæˆ -->
                    </tbody>
                </table>
            </div>

            <div id="operationLog" style="margin-top: 20px; padding: 15px; background: #f8f9fa; border-radius: 8px; min-height: 60px;">
                <strong>æ“ä½œæ—¥å¿—ï¼š</strong><span id="logText">ç‚¹å‡»èŠ‚ç‚¹è®¾ç½®èµ·ç‚¹ï¼Œæˆ–ä½¿ç”¨"éšæœºå›¾"ç”Ÿæˆç¤ºä¾‹</span>
            </div>
        </div>
    </div>

    <!-- ä»£ç ç¤ºä¾‹ -->
    <div class="content-card">
        <h2 class="section-title">
            <span class="section-icon">ğŸ’»</span>
            ä»£ç å®ç°
        </h2>

        <div class="code-tabs">
            <button class="code-tab active" onclick="switchCode('cpp', event)">C++</button>
            <button class="code-tab" onclick="switchCode('java', event)">Java</button>
            <button class="code-tab" onclick="switchCode('python', event)">Python</button>
        </div>

        <div id="cpp-code" class="code-content active">
            <button class="copy-btn" onclick="copyCode('cpp', event)">ğŸ“‹ å¤åˆ¶ä»£ç </button>
            <pre><code>#include &lt;iostream&gt;
#include &lt;vector&gt;
#include &lt;queue&gt;
#include &lt;limits&gt;
using namespace std;

const int INF = numeric_limits&lt;int&gt;::max();

class Graph {
private:
    int V;  // é¡¶ç‚¹æ•°
    vector&lt;vector&lt;pair&lt;int, int&gt;&gt;&gt; adj;  // é‚»æ¥è¡¨ (èŠ‚ç‚¹, æƒé‡)

public:
    Graph(int vertices) : V(vertices), adj(vertices) {}

    // æ·»åŠ è¾¹
    void addEdge(int u, int v, int weight) {
        adj[u].push_back({v, weight});
        adj[v].push_back({u, weight});  // æ— å‘å›¾
    }

    // Dijkstraç®—æ³•
    vector&lt;int&gt; dijkstra(int source) {
        // è·ç¦»æ•°ç»„ï¼Œåˆå§‹åŒ–ä¸ºæ— ç©·å¤§
        vector&lt;int&gt; dist(V, INF);
        // å‰é©±èŠ‚ç‚¹æ•°ç»„ï¼Œç”¨äºé‡å»ºè·¯å¾„
        vector&lt;int&gt; parent(V, -1);
        // è®¿é—®æ ‡è®°
        vector&lt;bool&gt; visited(V, false);

        // ä¼˜å…ˆé˜Ÿåˆ—ï¼š(è·ç¦», èŠ‚ç‚¹)
        priority_queue&lt;pair&lt;int, int&gt;,
                      vector&lt;pair&lt;int, int&gt;&gt;,
                      greater&lt;pair&lt;int, int&gt;&gt;&gt; pq;

        // æºç‚¹è·ç¦»ä¸º0
        dist[source] = 0;
        pq.push({0, source});

        while (!pq.empty()) {
            int u = pq.top().second;
            int d = pq.top().first;
            pq.pop();

            // å¦‚æœå·²è®¿é—®ï¼Œè·³è¿‡
            if (visited[u]) continue;
            visited[u] = true;

            // å¦‚æœå½“å‰è·ç¦»å¤§äºå·²çŸ¥è·ç¦»ï¼Œè·³è¿‡
            if (d > dist[u]) continue;

            // æ¾å¼›æ“ä½œï¼šæ›´æ–°æ‰€æœ‰é‚»å±…
            for (auto& edge : adj[u]) {
                int v = edge.first;
                int weight = edge.second;

                // å¦‚æœæ‰¾åˆ°æ›´çŸ­è·¯å¾„
                if (dist[u] + weight < dist[v]) {
                    dist[v] = dist[u] + weight;
                    parent[v] = u;
                    pq.push({dist[v], v});
                }
            }
        }

        return dist;
    }

    // é‡å»ºä»æºç‚¹åˆ°ç›®æ ‡çš„è·¯å¾„
    vector&lt;int&gt; getPath(int source, int target,
                        const vector&lt;int&gt;& parent) {
        vector&lt;int&gt; path;

        if (parent[target] == -1 && target != source) {
            return path;  // æ— æ³•åˆ°è¾¾
        }

        // ä»ç›®æ ‡å›æº¯åˆ°æºç‚¹
        int current = target;
        while (current != -1) {
            path.push_back(current);
            current = parent[current];
        }

        // åè½¬è·¯å¾„
        reverse(path.begin(), path.end());
        return path;
    }

    // æ‰“å°æœ€çŸ­è·¯å¾„
    void printShortestPaths(int source) {
        vector&lt;int&gt; dist = dijkstra(source);

        cout &lt;&lt; "ä»èŠ‚ç‚¹ " &lt;&lt; source &lt;&lt; " å‡ºå‘çš„æœ€çŸ­è·ç¦»ï¼š\n";
        for (int i = 0; i &lt; V; i++) {
            cout &lt;&lt; "åˆ°èŠ‚ç‚¹ " &lt;&lt; i &lt;&lt; ": ";
            if (dist[i] == INF) {
                cout &lt;&lt; "æ— æ³•åˆ°è¾¾\n";
            } else {
                cout &lt;&lt; dist[i] &lt;&lt; "\n";
            }
        }
    }
};

int main() {
    // åˆ›å»ºç¤ºä¾‹å›¾
    Graph g(6);

    // æ·»åŠ è¾¹ (èŠ‚ç‚¹1, èŠ‚ç‚¹2, æƒé‡)
    g.addEdge(0, 1, 4);
    g.addEdge(0, 2, 3);
    g.addEdge(1, 2, 1);
    g.addEdge(1, 3, 2);
    g.addEdge(2, 3, 4);
    g.addEdge(3, 4, 2);
    g.addEdge(4, 5, 6);

    // è¿è¡ŒDijkstraç®—æ³•
    g.printShortestPaths(0);

    return 0;
}</code></pre>
        </div>

        <div id="java-code" class="code-content">
            <button class="copy-btn" onclick="copyCode('java', event)">ğŸ“‹ å¤åˆ¶ä»£ç </button>
            <pre><code>import java.util.*;

public class DijkstraAlgorithm {

    static class Edge {
        int target, weight;

        Edge(int target, int weight) {
            this.target = target;
            this.weight = weight;
        }
    }

    static class Node implements Comparable&lt;Node&gt; {
        int vertex, distance;

        Node(int vertex, int distance) {
            this.vertex = vertex;
            this.distance = distance;
        }

        @Override
        public int compareTo(Node other) {
            return Integer.compare(this.distance, other.distance);
        }
    }

    private int V;  // é¡¶ç‚¹æ•°
    private List&lt;List&lt;Edge&gt;&gt; adj;  // é‚»æ¥è¡¨

    public DijkstraAlgorithm(int vertices) {
        this.V = vertices;
        this.adj = new ArrayList&lt;&gt;(vertices);
        for (int i = 0; i &lt; vertices; i++) {
            adj.add(new ArrayList&lt;&gt;());
        }
    }

    // æ·»åŠ è¾¹
    public void addEdge(int u, int v, int weight) {
        adj.get(u).add(new Edge(v, weight));
        adj.get(v).add(new Edge(u, weight));  // æ— å‘å›¾
    }

    // Dijkstraç®—æ³•å®ç°
    public int[] dijkstra(int source) {
        // åˆå§‹åŒ–è·ç¦»æ•°ç»„
        int[] dist = new int[V];
        Arrays.fill(dist, Integer.MAX_VALUE);
        dist[source] = 0;

        // å‰é©±èŠ‚ç‚¹æ•°ç»„
        int[] parent = new int[V];
        Arrays.fill(parent, -1);

        // è®¿é—®æ ‡è®°
        boolean[] visited = new boolean[V];

        // ä¼˜å…ˆé˜Ÿåˆ—
        PriorityQueue&lt;Node&gt; pq = new PriorityQueue&lt;&gt;();
        pq.offer(new Node(source, 0));

        while (!pq.isEmpty()) {
            Node current = pq.poll();
            int u = current.vertex;

            // å¦‚æœå·²è®¿é—®ï¼Œè·³è¿‡
            if (visited[u]) continue;
            visited[u] = true;

            // æ¾å¼›æ“ä½œ
            for (Edge edge : adj.get(u)) {
                int v = edge.target;
                int weight = edge.weight;

                // å¦‚æœæ‰¾åˆ°æ›´çŸ­è·¯å¾„
                if (dist[u] != Integer.MAX_VALUE &&
                    dist[u] + weight &lt; dist[v]) {
                    dist[v] = dist[u] + weight;
                    parent[v] = u;
                    pq.offer(new Node(v, dist[v]));
                }
            }
        }

        return dist;
    }

    // è·å–è·¯å¾„
    public List&lt;Integer&gt; getPath(int source, int target, int[] parent) {
        List&lt;Integer&gt; path = new ArrayList&lt;&gt;();

        if (parent[target] == -1 && target != source) {
            return path;  // æ— æ³•åˆ°è¾¾
        }

        // ä»ç›®æ ‡å›æº¯åˆ°æºç‚¹
        int current = target;
        while (current != -1) {
            path.add(current);
            current = parent[current];
        }

        // åè½¬è·¯å¾„
        Collections.reverse(path);
        return path;
    }

    // æ‰“å°æœ€çŸ­è·¯å¾„
    public void printShortestPaths(int source) {
        int[] dist = dijkstra(source);

        System.out.println("ä»èŠ‚ç‚¹ " + source + " å‡ºå‘çš„æœ€çŸ­è·ç¦»ï¼š");
        for (int i = 0; i &lt; V; i++) {
            System.out.print("åˆ°èŠ‚ç‚¹ " + i + ": ");
            if (dist[i] == Integer.MAX_VALUE) {
                System.out.println("æ— æ³•åˆ°è¾¾");
            } else {
                System.out.println(dist[i]);
            }
        }
    }

    public static void main(String[] args) {
        // åˆ›å»ºç¤ºä¾‹å›¾
        DijkstraAlgorithm g = new DijkstraAlgorithm(6);

        // æ·»åŠ è¾¹
        g.addEdge(0, 1, 4);
        g.addEdge(0, 2, 3);
        g.addEdge(1, 2, 1);
        g.addEdge(1, 3, 2);
        g.addEdge(2, 3, 4);
        g.addEdge(3, 4, 2);
        g.addEdge(4, 5, 6);

        // è¿è¡Œç®—æ³•
        g.printShortestPaths(0);
    }
}</code></pre>
        </div>

        <div id="python-code" class="code-content">
            <button class="copy-btn" onclick="copyCode('python', event)">ğŸ“‹ å¤åˆ¶ä»£ç </button>
            <pre><code>import heapq
from typing import List, Tuple, Dict

class Graph:
    def __init__(self, vertices: int):
        """åˆå§‹åŒ–å›¾
        Args:
            vertices: é¡¶ç‚¹æ•°
        """
        self.V = vertices
        self.adj = [[] for _ in range(vertices)]

    def add_edge(self, u: int, v: int, weight: int):
        """æ·»åŠ è¾¹ï¼ˆæ— å‘å›¾ï¼‰
        Args:
            u: èµ·ç‚¹
            v: ç»ˆç‚¹
            weight: æƒé‡
        """
        self.adj[u].append((v, weight))
        self.adj[v].append((u, weight))  # æ— å‘å›¾

    def dijkstra(self, source: int) -> Tuple[List[int], List[int]]:
        """Dijkstraç®—æ³•å®ç°
        Args:
            source: æºç‚¹
        Returns:
            (distances, parents): è·ç¦»æ•°ç»„å’Œå‰é©±èŠ‚ç‚¹æ•°ç»„
        """
        # åˆå§‹åŒ–
        distances = [float('inf')] * self.V
        parents = [-1] * self.V
        visited = [False] * self.V

        # æºç‚¹è·ç¦»ä¸º0
        distances[source] = 0

        # ä¼˜å…ˆé˜Ÿåˆ—: (è·ç¦», èŠ‚ç‚¹)
        pq = [(0, source)]

        while pq:
            # å–å‡ºè·ç¦»æœ€å°çš„èŠ‚ç‚¹
            current_dist, u = heapq.heappop(pq)

            # å¦‚æœå·²è®¿é—®ï¼Œè·³è¿‡
            if visited[u]:
                continue

            visited[u] = True

            # å¦‚æœå½“å‰è·ç¦»å¤§äºå·²çŸ¥è·ç¦»ï¼Œè·³è¿‡
            if current_dist > distances[u]:
                continue

            # æ¾å¼›æ“ä½œï¼šæ›´æ–°æ‰€æœ‰é‚»å±…
            for v, weight in self.adj[u]:
                # è®¡ç®—æ–°è·ç¦»
                new_dist = distances[u] + weight

                # å¦‚æœæ‰¾åˆ°æ›´çŸ­è·¯å¾„
                if new_dist < distances[v]:
                    distances[v] = new_dist
                    parents[v] = u
                    heapq.heappush(pq, (new_dist, v))

        return distances, parents

    def get_path(self, source: int, target: int, parents: List[int]) -> List[int]:
        """é‡å»ºä»æºç‚¹åˆ°ç›®æ ‡çš„è·¯å¾„
        Args:
            source: æºç‚¹
            target: ç›®æ ‡ç‚¹
            parents: å‰é©±èŠ‚ç‚¹æ•°ç»„
        Returns:
            è·¯å¾„åˆ—è¡¨
        """
        if parents[target] == -1 and target != source:
            return []  # æ— æ³•åˆ°è¾¾

        path = []
        current = target

        # ä»ç›®æ ‡å›æº¯åˆ°æºç‚¹
        while current != -1:
            path.append(current)
            current = parents[current]

        # åè½¬è·¯å¾„
        path.reverse()
        return path

    def print_shortest_paths(self, source: int):
        """æ‰“å°ä»æºç‚¹å‡ºå‘çš„æ‰€æœ‰æœ€çŸ­è·¯å¾„"""
        distances, parents = self.dijkstra(source)

        print(f"ä»èŠ‚ç‚¹ {source} å‡ºå‘çš„æœ€çŸ­è·¯å¾„ï¼š")
        print("-" * 40)

        for i in range(self.V):
            if distances[i] == float('inf'):
                print(f"åˆ°èŠ‚ç‚¹ {i}: æ— æ³•åˆ°è¾¾")
            else:
                path = self.get_path(source, i, parents)
                path_str = " -> ".join(map(str, path))
                print(f"åˆ°èŠ‚ç‚¹ {i}: è·ç¦» = {distances[i]}")
                print(f"  è·¯å¾„: {path_str}")

    def visualize_distances(self, source: int):
        """å¯è§†åŒ–è·ç¦»è¡¨"""
        distances, parents = self.dijkstra(source)

        print("\nè·ç¦»è¡¨ï¼š")
        print("èŠ‚ç‚¹\tè·ç¦»\tå‰é©±")
        print("-" * 30)

        for i in range(self.V):
            dist = "âˆ" if distances[i] == float('inf') else str(distances[i])
            parent = "-" if parents[i] == -1 else str(parents[i])
            print(f"{i}\t{dist}\t{parent}")


# ä½¿ç”¨ç¤ºä¾‹
if __name__ == "__main__":
    # åˆ›å»ºå›¾
    g = Graph(6)

    # æ·»åŠ è¾¹
    edges = [
        (0, 1, 4),
        (0, 2, 3),
        (1, 2, 1),
        (1, 3, 2),
        (2, 3, 4),
        (3, 4, 2),
        (4, 5, 6)
    ]

    for u, v, w in edges:
        g.add_edge(u, v, w)

    # è¿è¡ŒDijkstraç®—æ³•
    print("=== Dijkstraæœ€çŸ­è·¯å¾„ç®—æ³•æ¼”ç¤º ===\n")
    g.print_shortest_paths(0)
    g.visualize_distances(0)

    # æµ‹è¯•å…·ä½“è·¯å¾„
    print("\nå…·ä½“è·¯å¾„æŸ¥è¯¢ï¼š")
    distances, parents = g.dijkstra(0)

    for target in [3, 5]:
        path = g.get_path(0, target, parents)
        if path:
            print(f"ä» 0 åˆ° {target} çš„è·¯å¾„: {' -> '.join(map(str, path))}")
            print(f"æ€»è·ç¦»: {distances[target]}")
        else:
            print(f"ä» 0 åˆ° {target}: æ— æ³•åˆ°è¾¾")</code></pre>
        </div>
    </div>

    <!-- å®é™…åº”ç”¨ -->
    <div class="content-card">
        <h2 class="section-title">
            <span class="section-icon">ğŸŒŸ</span>
            å®é™…åº”ç”¨
        </h2>

        <div class="application-grid">
            <div class="app-card">
                <h3>ğŸ—ºï¸ GPSå¯¼èˆªç³»ç»Ÿ</h3>
                <p>Google Mapsã€é«˜å¾·åœ°å›¾ç­‰å¯¼èˆªè½¯ä»¶ä½¿ç”¨Dijkstraå˜ç§ç®—æ³•è®¡ç®—æœ€çŸ­è·¯çº¿</p>
            </div>

            <div class="app-card">
                <h3>ğŸŒ ç½‘ç»œè·¯ç”±åè®®</h3>
                <p>OSPFï¼ˆå¼€æ”¾æœ€çŸ­è·¯å¾„ä¼˜å…ˆï¼‰åè®®ä½¿ç”¨Dijkstraç®—æ³•è®¡ç®—è·¯ç”±è¡¨</p>
            </div>

            <div class="app-card">
                <h3>ğŸ® æ¸¸æˆAIå¯»è·¯</h3>
                <p>æ¸¸æˆä¸­NPCçš„è‡ªåŠ¨å¯»è·¯ï¼Œå¦‚é­”å…½ä¸–ç•Œã€è‹±é›„è”ç›Ÿçš„å°å…µç§»åŠ¨</p>
            </div>

            <div class="app-card">
                <h3>âœˆï¸ èˆªç­è·¯çº¿è§„åˆ’</h3>
                <p>èˆªç©ºå…¬å¸ç”¨äºè®¡ç®—æœ€ç»æµçš„é£è¡Œè·¯çº¿ï¼Œè€ƒè™‘æ²¹è€—å’Œè·ç¦»</p>
            </div>

            <div class="app-card">
                <h3>ğŸ“¦ ç‰©æµé…é€ä¼˜åŒ–</h3>
                <p>äº¬ä¸œã€é¡ºä¸°ç­‰ç‰©æµå…¬å¸ä¼˜åŒ–é…é€è·¯çº¿ï¼Œå‡å°‘è¿è¾“æˆæœ¬</p>
            </div>

            <div class="app-card">
                <h3>ğŸ¥ æ€¥æ•‘è·¯çº¿è§„åˆ’</h3>
                <p>120æ€¥æ•‘ç³»ç»Ÿè®¡ç®—æœ€å¿«åˆ°è¾¾åŒ»é™¢çš„è·¯çº¿ï¼ŒæŒ½æ•‘ç”Ÿå‘½</p>
            </div>
        </div>
    </div>

    <!-- å­¦ä¹ æ£€éªŒ -->
    <div class="content-card">
        <h2 class="section-title">
            <span class="section-icon">âœ…</span>
            å­¦ä¹ æ£€éªŒ
        </h2>

        <div class="quiz-item">
            <div class="quiz-question">
                â“ é—®é¢˜1ï¼šä¸ºä»€ä¹ˆDijkstraç®—æ³•ä¸èƒ½å¤„ç†è´Ÿæƒè¾¹ï¼Ÿ
            </div>
            <button class="show-answer-btn" onclick="toggleAnswer(1, event)">æŸ¥çœ‹ç­”æ¡ˆ</button>
            <div id="answer1" class="quiz-answer">
                <strong>ç­”æ¡ˆï¼š</strong>Dijkstraç®—æ³•çš„æ­£ç¡®æ€§åŸºäºä¸€ä¸ªå…³é”®å‡è®¾ï¼šä¸€æ—¦ç¡®å®šäº†åˆ°æŸä¸ªèŠ‚ç‚¹çš„æœ€çŸ­è·¯å¾„ï¼Œè¿™ä¸ªè·ç¦»å°±ä¸ä¼šå†æ”¹å˜ã€‚
                <p><strong>åä¾‹è¯´æ˜ï¼š</strong></p>
                <pre style="background: #f0f0f0; padding: 10px;">
å›¾ç»“æ„ï¼šA --1--> B --(-3)--> C
        A --------2--------> C
                </pre>
                <ul>
                    <li>Dijkstraä¼šå…ˆè®¿é—®Cï¼ˆè·ç¦»2ï¼‰ï¼Œæ ‡è®°ä¸ºå·²è®¿é—®</li>
                    <li>ç„¶åè®¿é—®Bï¼ˆè·ç¦»1ï¼‰ï¼Œä½†Cå·²è¢«è®¿é—®ï¼Œä¸ä¼šæ›´æ–°</li>
                    <li>å®é™…æœ€çŸ­è·¯å¾„ï¼šAâ†’Bâ†’C = 1+(-3) = -2</li>
                    <li>Dijkstraå¾—åˆ°ï¼šAâ†’C = 2ï¼ˆé”™è¯¯ï¼ï¼‰</li>
                </ul>
                <p><strong>è§£å†³æ–¹æ¡ˆï¼š</strong>ä½¿ç”¨Bellman-Fordç®—æ³•å¤„ç†è´Ÿæƒè¾¹</p>
            </div>
        </div>

        <div class="quiz-item">
            <div class="quiz-question">
                â“ é—®é¢˜2ï¼šDijkstraç®—æ³•çš„æ—¶é—´å¤æ‚åº¦æ˜¯å¤šå°‘ï¼Ÿå¦‚ä½•ä¼˜åŒ–ï¼Ÿ
            </div>
            <button class="show-answer-btn" onclick="toggleAnswer(2, event)">æŸ¥çœ‹ç­”æ¡ˆ</button>
            <div id="answer2" class="quiz-answer">
                <strong>ç­”æ¡ˆï¼š</strong>
                <table style="width: 100%; border-collapse: collapse;">
                    <tr style="background: #f0f0f0;">
                        <th style="padding: 10px; border: 1px solid #ddd;">å®ç°æ–¹å¼</th>
                        <th style="padding: 10px; border: 1px solid #ddd;">æ—¶é—´å¤æ‚åº¦</th>
                        <th style="padding: 10px; border: 1px solid #ddd;">é€‚ç”¨åœºæ™¯</th>
                    </tr>
                    <tr>
                        <td style="padding: 10px; border: 1px solid #ddd;">æš´åŠ›æœç´¢</td>
                        <td style="padding: 10px; border: 1px solid #ddd;">O(VÂ²)</td>
                        <td style="padding: 10px; border: 1px solid #ddd;">ç¨ å¯†å›¾ï¼ŒVè¾ƒå°</td>
                    </tr>
                    <tr>
                        <td style="padding: 10px; border: 1px solid #ddd;">äºŒå‰å †</td>
                        <td style="padding: 10px; border: 1px solid #ddd;">O((V+E)logV)</td>
                        <td style="padding: 10px; border: 1px solid #ddd;">ç¨€ç–å›¾ï¼Œæœ€å¸¸ç”¨</td>
                    </tr>
                    <tr>
                        <td style="padding: 10px; border: 1px solid #ddd;">æ–æ³¢é‚£å¥‘å †</td>
                        <td style="padding: 10px; border: 1px solid #ddd;">O(E + VlogV)</td>
                        <td style="padding: 10px; border: 1px solid #ddd;">ç†è®ºæœ€ä¼˜ï¼Œå®é™…å°‘ç”¨</td>
                    </tr>
                </table>
                <p><strong>ä¼˜åŒ–æŠ€å·§ï¼š</strong></p>
                <ul>
                    <li>ä½¿ç”¨ä¼˜å…ˆé˜Ÿåˆ—é¿å…é‡å¤éå†</li>
                    <li>åŒå‘Dijkstraï¼šä»èµ·ç‚¹å’Œç»ˆç‚¹åŒæ—¶æœç´¢</li>
                    <li>A*ç®—æ³•ï¼šåŠ å…¥å¯å‘å¼å‡½æ•°æŒ‡å¯¼æœç´¢æ–¹å‘</li>
                </ul>
            </div>
        </div>

        <div class="quiz-item">
            <div class="quiz-question">
                â“ é—®é¢˜3ï¼šå¦‚ä½•åˆ¤æ–­Dijkstraç®—æ³•æ‰¾åˆ°çš„ç¡®å®æ˜¯æœ€çŸ­è·¯å¾„ï¼Ÿ
            </div>
            <button class="show-answer-btn" onclick="toggleAnswer(3, event)">æŸ¥çœ‹ç­”æ¡ˆ</button>
            <div id="answer3" class="quiz-answer">
                <strong>ç­”æ¡ˆï¼š</strong>å¯ä»¥é€šè¿‡æ•°å­¦å½’çº³æ³•è¯æ˜ï¼š
                <p><strong>è¯æ˜æ€è·¯ï¼š</strong></p>
                <ol>
                    <li><strong>åŸºç¡€æƒ…å†µï¼š</strong>æºç‚¹åˆ°è‡ªå·±çš„è·ç¦»ä¸º0ï¼Œæ˜¾ç„¶æ­£ç¡®</li>
                    <li><strong>å½’çº³å‡è®¾ï¼š</strong>å‡è®¾å‰kä¸ªè¢«æ ‡è®°çš„èŠ‚ç‚¹éƒ½æ‰¾åˆ°äº†æœ€çŸ­è·¯å¾„</li>
                    <li><strong>å½’çº³æ­¥éª¤ï¼š</strong>ç¬¬k+1ä¸ªèŠ‚ç‚¹væ˜¯æœªæ ‡è®°ä¸­è·ç¦»æœ€å°çš„
                        <ul>
                            <li>å¦‚æœå­˜åœ¨æ›´çŸ­è·¯å¾„ï¼Œå¿…é¡»ç»è¿‡æŸä¸ªæœªæ ‡è®°èŠ‚ç‚¹u</li>
                            <li>ä½†dist[u] â‰¥ dist[v]ï¼ˆå¦åˆ™ä¼šé€‰uè€Œä¸æ˜¯vï¼‰</li>
                            <li>æ‰€ä»¥ç»è¿‡uåˆ°vçš„è·¯å¾„é•¿åº¦ â‰¥ dist[u] â‰¥ dist[v]</li>
                            <li>å› æ­¤å½“å‰çš„dist[v]å°±æ˜¯æœ€çŸ­è·ç¦»</li>
                        </ul>
                    </li>
                </ol>
                <p><strong>å…³é”®æ´å¯Ÿï¼š</strong>è´ªå¿ƒé€‰æ‹©çš„æ­£ç¡®æ€§ä¾èµ–äºè¾¹æƒéè´Ÿï¼</p>
            </div>
        </div>

        <div class="quiz-item">
            <div class="quiz-question">
                â“ é—®é¢˜4ï¼šDijkstraã€Bellman-Fordã€Floydç®—æ³•å„é€‚ç”¨ä»€ä¹ˆåœºæ™¯ï¼Ÿ
            </div>
            <button class="show-answer-btn" onclick="toggleAnswer(4, event)">æŸ¥çœ‹ç­”æ¡ˆ</button>
            <div id="answer4" class="quiz-answer">
                <strong>ç­”æ¡ˆï¼š</strong>
                <table style="width: 100%; border-collapse: collapse;">
                    <tr style="background: #f0f0f0;">
                        <th style="padding: 10px; border: 1px solid #ddd;">ç®—æ³•</th>
                        <th style="padding: 10px; border: 1px solid #ddd;">æ—¶é—´å¤æ‚åº¦</th>
                        <th style="padding: 10px; border: 1px solid #ddd;">ç‰¹ç‚¹</th>
                        <th style="padding: 10px; border: 1px solid #ddd;">ä½¿ç”¨åœºæ™¯</th>
                    </tr>
                    <tr>
                        <td style="padding: 10px; border: 1px solid #ddd;"><strong>Dijkstra</strong></td>
                        <td style="padding: 10px; border: 1px solid #ddd;">O((V+E)logV)</td>
                        <td style="padding: 10px; border: 1px solid #ddd;">ä¸èƒ½å¤„ç†è´Ÿæƒè¾¹</td>
                        <td style="padding: 10px; border: 1px solid #ddd;">å•æºæœ€çŸ­è·¯å¾„ï¼Œéè´Ÿæƒé‡</td>
                    </tr>
                    <tr>
                        <td style="padding: 10px; border: 1px solid #ddd;"><strong>Bellman-Ford</strong></td>
                        <td style="padding: 10px; border: 1px solid #ddd;">O(VE)</td>
                        <td style="padding: 10px; border: 1px solid #ddd;">å¯å¤„ç†è´Ÿæƒè¾¹ï¼Œæ£€æµ‹è´Ÿç¯</td>
                        <td style="padding: 10px; border: 1px solid #ddd;">æœ‰è´Ÿæƒè¾¹çš„å•æºæœ€çŸ­è·¯å¾„</td>
                    </tr>
                    <tr>
                        <td style="padding: 10px; border: 1px solid #ddd;"><strong>Floyd-Warshall</strong></td>
                        <td style="padding: 10px; border: 1px solid #ddd;">O(VÂ³)</td>
                        <td style="padding: 10px; border: 1px solid #ddd;">æ±‚æ‰€æœ‰ç‚¹å¯¹æœ€çŸ­è·¯å¾„</td>
                        <td style="padding: 10px; border: 1px solid #ddd;">å…¨æºæœ€çŸ­è·¯å¾„ï¼Œå›¾è¾ƒå°</td>
                    </tr>
                    <tr>
                        <td style="padding: 10px; border: 1px solid #ddd;"><strong>A*</strong></td>
                        <td style="padding: 10px; border: 1px solid #ddd;">å–å†³äºå¯å‘å‡½æ•°</td>
                        <td style="padding: 10px; border: 1px solid #ddd;">ä½¿ç”¨å¯å‘å¼åŠ é€Ÿ</td>
                        <td style="padding: 10px; border: 1px solid #ddd;">å·²çŸ¥ç»ˆç‚¹çš„è·¯å¾„æœç´¢</td>
                    </tr>
                </table>
                <p><strong>é€‰æ‹©å»ºè®®ï¼š</strong></p>
                <ul>
                    <li>ä¸€èˆ¬æƒ…å†µä¼˜å…ˆé€‰Dijkstraï¼ˆå¿«é€Ÿã€ç®€å•ï¼‰</li>
                    <li>æœ‰è´Ÿæƒè¾¹å¿…é¡»ç”¨Bellman-Ford</li>
                    <li>éœ€è¦æ‰€æœ‰ç‚¹å¯¹è·¯å¾„ä¸”å›¾å°ç”¨Floyd</li>
                    <li>æ¸¸æˆå¯»è·¯ç­‰å·²çŸ¥ç›®æ ‡åœºæ™¯ç”¨A*</li>
                </ul>
            </div>
        </div>

        <div style="margin-top: 30px; padding: 20px; background: #e3f2fd; border-radius: 8px;">
            <h4>ğŸ“š è¿›é˜¶å­¦ä¹ å»ºè®®</h4>
            <ol>
                <li><strong>å®ç°å˜ç§ï¼š</strong>åŒå‘Dijkstraã€kæ¡æœ€çŸ­è·¯å¾„</li>
                <li><strong>å­¦ä¹ A*ç®—æ³•ï¼š</strong>åŠ å…¥å¯å‘å‡½æ•°çš„Dijkstra</li>
                <li><strong>ç ”ç©¶åº”ç”¨ï¼š</strong>äº†è§£å®é™…åœ°å›¾è½¯ä»¶çš„è·¯å¾„è§„åˆ’</li>
                <li><strong>ä¸‹ä¸€æ­¥å­¦ä¹ ï¼š</strong>æœ€å°ç”Ÿæˆæ ‘ï¼ˆPrimã€Kruskalï¼‰ã€ç½‘ç»œæµç®—æ³•</li>
            </ol>
        </div>
    </div>

    <!-- è¿”å›å¯¼èˆª -->
    <div style="text-align: center; margin-top: 40px;">
        <a href="{% url 'knowledge_app:index' %}" class="unified-btn unified-btn-primary">
            <span>ğŸ </span>
            è¿”å›é¦–é¡µ
        </a>
        <a href="{% url 'knowledge_app:cs_universe' %}" class="unified-btn unified-btn-secondary">
            <span>ğŸŒŒ</span>
            æ¢ç´¢CSå®‡å®™
        </a>
    </div>
</div>

<script>
// CanvasåŠ¨ç”»ç›¸å…³ä»£ç 
const canvas = document.getElementById('dijkstraCanvas');
const ctx = canvas.getContext('2d');

// å›¾æ•°æ®ç»“æ„
class GraphVisualization {
    constructor() {
        this.nodes = [];
        this.edges = [];
        this.distances = {};
        this.parents = {};
        this.visited = new Set();
        this.currentNode = null;
        this.sourceNode = null;
        this.animationRunning = false;
        this.animationPaused = false;
        this.checkingNeighbor = null;  // æ­£åœ¨æ£€æŸ¥çš„é‚»å±…
        this.comparingEdge = null;     // æ­£åœ¨æ¯”è¾ƒçš„è¾¹
        this.step = 0;                 // ç®—æ³•æ­¥éª¤
    }

    addNode(x, y, id) {
        this.nodes.push({
            x, y, id,
            label: String.fromCharCode(65 + id)
        });
    }

    addEdge(from, to, weight) {
        this.edges.push({ from, to, weight });
    }

    clear() {
        this.nodes = [];
        this.edges = [];
        this.distances = {};
        this.parents = {};
        this.visited.clear();
        this.currentNode = null;
        this.sourceNode = null;
        this.animationRunning = false;
        this.animationPaused = false;
        this.checkingNeighbor = null;
        this.comparingEdge = null;
        this.step = 0;
    }

    findNode(x, y) {
        for (let node of this.nodes) {
            const dist = Math.sqrt((x - node.x) ** 2 + (y - node.y) ** 2);
            if (dist < 30) return node;
        }
        return null;
    }

    getNeighbors(nodeId) {
        const neighbors = [];
        for (let edge of this.edges) {
            if (edge.from === nodeId) {
                neighbors.push({ id: edge.to, weight: edge.weight, edge });
            } else if (edge.to === nodeId) {
                neighbors.push({ id: edge.from, weight: edge.weight, edge });
            }
        }
        return neighbors;
    }
}

const graph = new GraphVisualization();
let animationSpeed = 1500;

// ç»˜åˆ¶ç®­å¤´
function drawArrow(fromX, fromY, toX, toY, color = '#666') {
    const headlen = 10;
    const angle = Math.atan2(toY - fromY, toX - fromX);

    // è°ƒæ•´ç»ˆç‚¹ä½ç½®ï¼ˆä¸è¦ç”»åˆ°èŠ‚ç‚¹ä¸­å¿ƒï¼‰
    const adjustedToX = toX - 25 * Math.cos(angle);
    const adjustedToY = toY - 25 * Math.sin(angle);

    ctx.strokeStyle = color;
    ctx.lineWidth = 2;
    ctx.beginPath();
    ctx.moveTo(fromX + 25 * Math.cos(angle), fromY + 25 * Math.sin(angle));
    ctx.lineTo(adjustedToX, adjustedToY);
    ctx.stroke();

    // ç®­å¤´
    ctx.beginPath();
    ctx.moveTo(adjustedToX, adjustedToY);
    ctx.lineTo(adjustedToX - headlen * Math.cos(angle - Math.PI / 6),
               adjustedToY - headlen * Math.sin(angle - Math.PI / 6));
    ctx.lineTo(adjustedToX - headlen * Math.cos(angle + Math.PI / 6),
               adjustedToY - headlen * Math.sin(angle + Math.PI / 6));
    ctx.closePath();
    ctx.fillStyle = color;
    ctx.fill();
}

// ç»˜åˆ¶è¾¹
function drawEdge(from, to, weight, style = 'normal') {
    const dx = to.x - from.x;
    const dy = to.y - from.y;
    const midX = (from.x + to.x) / 2;
    const midY = (from.y + to.y) / 2;

    // æ ¹æ®æ ·å¼è®¾ç½®é¢œè‰²å’Œçº¿å®½
    let color = '#999';
    let lineWidth = 2;
    let isDashed = false;

    switch(style) {
        case 'shortest':  // æœ€çŸ­è·¯å¾„
            color = '#28a745';
            lineWidth = 4;
            break;
        case 'checking':  // æ­£åœ¨æ£€æŸ¥
            color = '#ffc107';
            lineWidth = 3;
            isDashed = true;
            break;
        case 'comparing':  // æ­£åœ¨æ¯”è¾ƒ
            color = '#ff6b6b';
            lineWidth = 4;
            break;
    }

    // ç»˜åˆ¶è¾¹
    ctx.save();
    ctx.strokeStyle = color;
    ctx.lineWidth = lineWidth;

    if (isDashed) {
        ctx.setLineDash([10, 5]);
    }

    ctx.beginPath();
    ctx.moveTo(from.x, from.y);
    ctx.lineTo(to.x, to.y);
    ctx.stroke();
    ctx.restore();

    // ç»˜åˆ¶æƒé‡æ ‡ç­¾
    ctx.fillStyle = style === 'comparing' ? '#ffe6e6' : 'white';
    ctx.strokeStyle = style === 'comparing' ? '#ff6b6b' : '#999';
    ctx.lineWidth = style === 'comparing' ? 2 : 1;

    // æƒé‡èƒŒæ™¯
    ctx.beginPath();
    ctx.arc(midX, midY, 18, 0, Math.PI * 2);
    ctx.fill();
    ctx.stroke();

    // æƒé‡æ–‡å­—
    ctx.fillStyle = '#333';
    ctx.font = style === 'comparing' ? 'bold 14px Arial' : '12px Arial';
    ctx.textAlign = 'center';
    ctx.textBaseline = 'middle';
    ctx.fillText(weight, midX, midY);
}

// ç»˜åˆ¶èŠ‚ç‚¹
function drawNode(node, style = 'normal') {
    const x = node.x;
    const y = node.y;
    const radius = 25;

    // æ ¹æ®æ ·å¼è®¾ç½®é¢œè‰²
    let fillColor = '#007bff';
    let strokeColor = '#0056b3';
    let labelColor = 'white';

    switch(style) {
        case 'source':
            fillColor = '#dc3545';
            strokeColor = '#a71d2a';
            break;
        case 'current':
            fillColor = '#ffc107';
            strokeColor = '#d39e00';
            labelColor = '#333';
            break;
        case 'visited':
            fillColor = '#28a745';
            strokeColor = '#1e7e34';
            break;
        case 'checking':
            fillColor = '#ff9800';
            strokeColor = '#cc7a00';
            break;
    }

    // ç»˜åˆ¶èŠ‚ç‚¹
    ctx.fillStyle = fillColor;
    ctx.strokeStyle = strokeColor;
    ctx.lineWidth = 3;

    ctx.beginPath();
    ctx.arc(x, y, radius, 0, Math.PI * 2);
    ctx.fill();
    ctx.stroke();

    // èŠ‚ç‚¹æ ‡ç­¾
    ctx.fillStyle = labelColor;
    ctx.font = 'bold 18px Arial';
    ctx.textAlign = 'center';
    ctx.textBaseline = 'middle';
    ctx.fillText(node.label, x, y);

    // æ˜¾ç¤ºè·ç¦»
    if (graph.distances[node.id] !== undefined) {
        const dist = graph.distances[node.id] === Infinity ? 'âˆ' : graph.distances[node.id];

        // è·ç¦»èƒŒæ™¯
        ctx.fillStyle = dist === Infinity ? '#f8f9fa' : '#e3f2fd';
        ctx.strokeStyle = dist === Infinity ? '#999' : '#007bff';
        ctx.lineWidth = 1;

        const distText = `${dist}`;
        const textWidth = ctx.measureText(distText).width;

        ctx.beginPath();
        ctx.roundRect(x - textWidth/2 - 8, y + radius + 8, textWidth + 16, 20, 5);
        ctx.fill();
        ctx.stroke();

        // è·ç¦»æ–‡å­—
        ctx.fillStyle = dist === Infinity ? '#999' : '#007bff';
        ctx.font = 'bold 14px Arial';
        ctx.fillText(distText, x, y + radius + 18);
    }
}

// ç»˜åˆ¶ç®—æ³•æ­¥éª¤è¯´æ˜
function drawStepInfo() {
    // èƒŒæ™¯
    ctx.fillStyle = 'rgba(255, 255, 255, 0.95)';
    ctx.strokeStyle = '#007bff';
    ctx.lineWidth = 2;
    ctx.beginPath();
    ctx.roundRect(10, 10, 250, 80, 10);
    ctx.fill();
    ctx.stroke();

    // æ ‡é¢˜
    ctx.fillStyle = '#007bff';
    ctx.font = 'bold 14px Arial';
    ctx.textAlign = 'left';
    ctx.fillText('ç®—æ³•æ­¥éª¤ ' + graph.step, 20, 30);

    // å½“å‰æ“ä½œ
    ctx.fillStyle = '#333';
    ctx.font = '12px Arial';

    let stepText = '';
    if (graph.currentNode) {
        stepText = `æ­£åœ¨å¤„ç†èŠ‚ç‚¹ ${graph.currentNode.label}`;
        if (graph.checkingNeighbor) {
            const neighbor = graph.nodes[graph.checkingNeighbor];
            const currentDist = graph.distances[graph.currentNode.id];
            const edgeDist = graph.comparingEdge ? graph.comparingEdge.weight : 0;
            const oldDist = graph.distances[graph.checkingNeighbor];
            const newDist = currentDist + edgeDist;

            ctx.fillText(stepText, 20, 50);
            ctx.fillText(`æ£€æŸ¥é‚»å±… ${neighbor.label}:`, 20, 65);
            ctx.fillText(`${currentDist} + ${edgeDist} = ${newDist} ${newDist < oldDist ? '<' : 'â‰¥'} ${oldDist === Infinity ? 'âˆ' : oldDist}`, 20, 80);
        } else {
            ctx.fillText(stepText, 20, 50);
            ctx.fillText(`è·ç¦»: ${graph.distances[graph.currentNode.id]}`, 20, 65);
        }
    } else if (graph.sourceNode) {
        ctx.fillText(`èµ·ç‚¹: ${graph.sourceNode.label}`, 20, 50);
        ctx.fillText('ç‚¹å‡»"å¼€å§‹ç®—æ³•"è¿è¡Œ', 20, 65);
    } else {
        ctx.fillText('ç‚¹å‡»èŠ‚ç‚¹è®¾ç½®èµ·ç‚¹', 20, 50);
    }
}

// ç»˜åˆ¶å›¾ä¾‹
function drawLegend() {
    const legendX = canvas.width - 150;
    const legendY = 10;

    // èƒŒæ™¯
    ctx.fillStyle = 'rgba(255, 255, 255, 0.95)';
    ctx.strokeStyle = '#999';
    ctx.lineWidth = 1;
    ctx.beginPath();
    ctx.roundRect(legendX, legendY, 140, 140, 10);
    ctx.fill();
    ctx.stroke();

    // æ ‡é¢˜
    ctx.fillStyle = '#333';
    ctx.font = 'bold 12px Arial';
    ctx.textAlign = 'left';
    ctx.fillText('å›¾ä¾‹', legendX + 10, legendY + 20);

    // å›¾ä¾‹é¡¹
    const items = [
        { color: '#dc3545', label: 'èµ·ç‚¹' },
        { color: '#ffc107', label: 'å½“å‰èŠ‚ç‚¹' },
        { color: '#ff9800', label: 'æ£€æŸ¥ä¸­' },
        { color: '#28a745', label: 'å·²è®¿é—®' },
        { color: '#007bff', label: 'æœªè®¿é—®' }
    ];

    ctx.font = '11px Arial';
    items.forEach((item, index) => {
        const y = legendY + 35 + index * 20;

        // é¢œè‰²åœ†ç‚¹
        ctx.fillStyle = item.color;
        ctx.beginPath();
        ctx.arc(legendX + 15, y, 6, 0, Math.PI * 2);
        ctx.fill();

        // æ ‡ç­¾
        ctx.fillStyle = '#333';
        ctx.fillText(item.label, legendX + 30, y + 3);
    });
}

// ä¸»ç»˜åˆ¶å‡½æ•°
function drawGraph() {
    ctx.clearRect(0, 0, canvas.width, canvas.height);

    // ç»˜åˆ¶æ ‡é¢˜
    ctx.fillStyle = '#333';
    ctx.font = 'bold 20px Arial';
    ctx.textAlign = 'center';
    ctx.fillText('Dijkstra æœ€çŸ­è·¯å¾„ç®—æ³•', canvas.width / 2, 30);

    // ç»˜åˆ¶æ‰€æœ‰è¾¹ï¼ˆç¬¬ä¸€å±‚ï¼šæ™®é€šè¾¹ï¼‰
    for (let edge of graph.edges) {
        const from = graph.nodes[edge.from];
        const to = graph.nodes[edge.to];

        // åˆ¤æ–­æ˜¯å¦æ˜¯æœ€çŸ­è·¯å¾„çš„ä¸€éƒ¨åˆ†
        const isShortestPath = (graph.parents[to.id] === from.id || graph.parents[from.id] === to.id);
        const isComparing = graph.comparingEdge === edge;

        if (!isShortestPath && !isComparing) {
            drawEdge(from, to, edge.weight, 'normal');
        }
    }

    // ç»˜åˆ¶æœ€çŸ­è·¯å¾„æ ‘ï¼ˆç¬¬äºŒå±‚ï¼šå·²ç¡®å®šçš„æœ€çŸ­è·¯å¾„ï¼‰
    ctx.save();
    ctx.strokeStyle = '#28a745';
    ctx.lineWidth = 4;

    for (let node of graph.nodes) {
        if (graph.parents[node.id] !== undefined && graph.parents[node.id] !== -1) {
            const parent = graph.nodes[graph.parents[node.id]];
            // ç»˜åˆ¶æœ€çŸ­è·¯å¾„ç®­å¤´
            drawArrow(parent.x, parent.y, node.x, node.y, '#28a745');
        }
    }
    ctx.restore();

    // ç»˜åˆ¶æ­£åœ¨æ¯”è¾ƒçš„è¾¹ï¼ˆç¬¬ä¸‰å±‚ï¼šé«˜äº®æ˜¾ç¤ºï¼‰
    if (graph.comparingEdge) {
        const from = graph.nodes[graph.comparingEdge.from];
        const to = graph.nodes[graph.comparingEdge.to];
        drawEdge(from, to, graph.comparingEdge.weight, 'comparing');
    }

    // ç»˜åˆ¶æ‰€æœ‰èŠ‚ç‚¹
    for (let node of graph.nodes) {
        let style = 'normal';

        if (node === graph.sourceNode) {
            style = 'source';
        } else if (node === graph.currentNode) {
            style = 'current';
        } else if (node.id === graph.checkingNeighbor) {
            style = 'checking';
        } else if (graph.visited.has(node.id)) {
            style = 'visited';
        }

        drawNode(node, style);
    }

    // ç»˜åˆ¶æ­¥éª¤ä¿¡æ¯å’Œå›¾ä¾‹
    drawStepInfo();
    drawLegend();
}

// ç”Ÿæˆç¤ºä¾‹å›¾
function generateRandomGraph() {
    graph.clear();

    // åˆ›å»ºä¸€ä¸ªç®€å•çš„ç¤ºä¾‹å›¾
    const positions = [
        { x: 200, y: 200 },  // A
        { x: 350, y: 150 },  // B
        { x: 500, y: 200 },  // C
        { x: 350, y: 300 },  // D
        { x: 650, y: 250 },  // E
        { x: 500, y: 400 }   // F
    ];

    for (let i = 0; i < positions.length; i++) {
        graph.addNode(positions[i].x, positions[i].y, i);
    }

    // æ·»åŠ è¾¹ï¼ˆç¡®ä¿å›¾æ˜¯è¿é€šçš„ï¼‰
    const edges = [
        [0, 1, 7],   // A-B: 7
        [0, 3, 9],   // A-D: 9
        [1, 2, 10],  // B-C: 10
        [1, 3, 15],  // B-D: 15
        [2, 4, 11],  // C-E: 11
        [2, 5, 2],   // C-F: 2
        [3, 5, 6],   // D-F: 6
        [4, 5, 9]    // E-F: 9
    ];

    for (let [from, to, weight] of edges) {
        graph.addEdge(from, to, weight);
    }

    updateDistanceTable();
    drawGraph();
    updateLog('ğŸ“Š å·²ç”Ÿæˆç¤ºä¾‹å›¾ï¼Œç‚¹å‡»ä»»æ„èŠ‚ç‚¹è®¾ç½®ä¸ºèµ·ç‚¹');
}

// Dijkstraç®—æ³•å®ç°ï¼ˆåˆ†æ­¥å±•ç¤ºï¼‰
async function dijkstra(sourceId) {
    // åˆå§‹åŒ–
    graph.distances = {};
    graph.parents = {};
    graph.visited.clear();
    graph.step = 0;

    for (let node of graph.nodes) {
        graph.distances[node.id] = Infinity;
        graph.parents[node.id] = -1;
    }

    graph.distances[sourceId] = 0;

    updateLog(`ğŸš€ ç®—æ³•å¼€å§‹ï¼èµ·ç‚¹ ${graph.sourceNode.label} çš„è·ç¦»è®¾ä¸º 0ï¼Œå…¶ä»–èŠ‚ç‚¹è®¾ä¸º âˆ`);
    updateDistanceTable();
    drawGraph();
    await sleep(animationSpeed);

    // ä¼˜å…ˆé˜Ÿåˆ—
    const pq = [];
    pq.push({ id: sourceId, dist: 0 });

    while (pq.length > 0 && !graph.animationPaused) {
        // æ‰¾åˆ°è·ç¦»æœ€å°çš„æœªè®¿é—®èŠ‚ç‚¹
        pq.sort((a, b) => a.dist - b.dist);
        const current = pq.shift();

        if (graph.visited.has(current.id)) continue;

        graph.step++;
        graph.currentNode = graph.nodes[current.id];
        graph.visited.add(current.id);

        updateLog(`ğŸ“ æ­¥éª¤ ${graph.step}: é€‰æ‹©æœªè®¿é—®èŠ‚ç‚¹ä¸­è·ç¦»æœ€å°çš„ ${graph.currentNode.label} (è·ç¦»: ${current.dist})`);
        updateDistanceTable();
        drawGraph();
        await sleep(animationSpeed);

        // æ£€æŸ¥æ‰€æœ‰é‚»å±…
        const neighbors = graph.getNeighbors(current.id);

        for (let neighbor of neighbors) {
            if (graph.visited.has(neighbor.id)) continue;

            graph.checkingNeighbor = neighbor.id;
            graph.comparingEdge = neighbor.edge;

            const oldDist = graph.distances[neighbor.id];
            const newDist = graph.distances[current.id] + neighbor.weight;

            updateLog(`ğŸ” æ£€æŸ¥é‚»å±… ${graph.nodes[neighbor.id].label}: ${graph.distances[current.id]} + ${neighbor.weight} = ${newDist} ${newDist < oldDist ? '<' : 'â‰¥'} ${oldDist === Infinity ? 'âˆ' : oldDist}`);
            drawGraph();
            await sleep(animationSpeed);

            if (newDist < oldDist) {
                // æ‰¾åˆ°æ›´çŸ­è·¯å¾„ï¼Œæ›´æ–°
                graph.distances[neighbor.id] = newDist;
                graph.parents[neighbor.id] = current.id;
                pq.push({ id: neighbor.id, dist: newDist });

                updateLog(`âœ… æ‰¾åˆ°æ›´çŸ­è·¯å¾„ï¼æ›´æ–° ${graph.nodes[neighbor.id].label} çš„è·ç¦»ä¸º ${newDist}`);
                updateDistanceTable();
                drawGraph();
                await sleep(animationSpeed / 2);
            } else {
                updateLog(`âŒ å½“å‰è·¯å¾„ä¸æ˜¯æ›´çŸ­è·¯å¾„ï¼Œä¿æŒåŸè·ç¦» ${oldDist === Infinity ? 'âˆ' : oldDist}`);
                await sleep(animationSpeed / 2);
            }

            graph.checkingNeighbor = null;
            graph.comparingEdge = null;
        }

        graph.currentNode = null;
        drawGraph();
    }

    graph.animationRunning = false;
    updateLog('ğŸ‰ ç®—æ³•å®Œæˆï¼å·²æ‰¾åˆ°ä»èµ·ç‚¹åˆ°æ‰€æœ‰å¯è¾¾èŠ‚ç‚¹çš„æœ€çŸ­è·¯å¾„ï¼ˆç»¿è‰²ç®­å¤´è¡¨ç¤ºï¼‰');

    // æ˜¾ç¤ºæœ€ç»ˆç»“æœ
    drawGraph();
}

// è¾…åŠ©å‡½æ•°
function sleep(ms) {
    return new Promise(resolve => setTimeout(resolve, ms));
}

function updateLog(message) {
    document.getElementById('logText').innerHTML = message;
}

function updateDistanceTable() {
    const tbody = document.getElementById('distanceTableBody');
    tbody.innerHTML = '';

    for (let node of graph.nodes) {
        const row = tbody.insertRow();

        // èŠ‚ç‚¹
        const nodeCell = row.insertCell(0);
        nodeCell.innerHTML = `<strong>${node.label}</strong>`;

        // è·ç¦»
        const dist = graph.distances[node.id];
        const distCell = row.insertCell(1);
        if (dist === undefined || dist === Infinity) {
            distCell.innerHTML = '<span style="color: #999;">âˆ</span>';
        } else {
            distCell.innerHTML = `<strong>${dist}</strong>`;
        }

        // å‰é©±
        const parent = graph.parents[node.id];
        const parentCell = row.insertCell(2);
        if (parent === undefined || parent === -1) {
            parentCell.textContent = '-';
        } else {
            parentCell.innerHTML = `<strong>${graph.nodes[parent].label}</strong>`;
        }

        // çŠ¶æ€
        let status = 'æœªè®¿é—®';
        let bgColor = '';

        if (node === graph.sourceNode) {
            status = 'èµ·ç‚¹';
            bgColor = '#ffe6e6';
        } else if (node === graph.currentNode) {
            status = 'å¤„ç†ä¸­';
            bgColor = '#fff3cd';
        } else if (node.id === graph.checkingNeighbor) {
            status = 'æ£€æŸ¥ä¸­';
            bgColor = '#ffe4cc';
        } else if (graph.visited.has(node.id)) {
            status = 'å·²å®Œæˆ';
            bgColor = '#d4edda';
        }

        row.insertCell(3).textContent = status;

        if (bgColor) {
            row.style.backgroundColor = bgColor;
        }
    }
}

// æ§åˆ¶å‡½æ•°
function startAlgorithm() {
    if (!graph.sourceNode) {
        updateLog('âŒ è¯·å…ˆç‚¹å‡»ä¸€ä¸ªèŠ‚ç‚¹è®¾ç½®ä¸ºèµ·ç‚¹ï¼');
        return;
    }

    if (graph.animationRunning) {
        updateLog('âš ï¸ ç®—æ³•æ­£åœ¨è¿è¡Œä¸­...');
        return;
    }

    graph.animationRunning = true;
    graph.animationPaused = false;
    dijkstra(graph.sourceNode.id);
}

function pauseAlgorithm() {
    graph.animationPaused = !graph.animationPaused;
    updateLog(graph.animationPaused ? 'â¸ï¸ å·²æš‚åœ' : 'â–¶ï¸ ç»§ç»­è¿è¡Œ');
}

function resetGraph() {
    const nodes = [...graph.nodes];
    const edges = [...graph.edges];

    graph.clear();
    graph.nodes = nodes;
    graph.edges = edges;

    updateDistanceTable();
    drawGraph();
    updateLog('ğŸ”„ å›¾å·²é‡ç½®ï¼Œç‚¹å‡»èŠ‚ç‚¹è®¾ç½®èµ·ç‚¹');
}

function clearGraph() {
    graph.clear();
    updateDistanceTable();
    drawGraph();
    updateLog('ğŸ—‘ï¸ ç”»å¸ƒå·²æ¸…ç©º');
}

// ä»£ç åˆ‡æ¢
function switchCode(lang, event) {
    document.querySelectorAll('.code-tab').forEach(tab => tab.classList.remove('active'));
    document.querySelectorAll('.code-content').forEach(content => content.classList.remove('active'));

    event.target.classList.add('active');
    document.getElementById(`${lang}-code`).classList.add('active');
}

// å¤åˆ¶ä»£ç 
function copyCode(lang, event) {
    const codeElement = document.getElementById(`${lang}-code`).querySelector('code');
    const text = codeElement.textContent;

    navigator.clipboard.writeText(text).then(() => {
        const btn = event.target;
        const originalText = btn.textContent;
        btn.textContent = 'âœ… å·²å¤åˆ¶ï¼';
        setTimeout(() => {
            btn.textContent = originalText;
        }, 2000);
    }).catch(err => {
        // é™çº§æ–¹æ¡ˆ
        const textArea = document.createElement('textarea');
        textArea.value = text;
        textArea.style.position = 'fixed';
        textArea.style.left = '-9999px';
        document.body.appendChild(textArea);
        textArea.select();

        try {
            document.execCommand('copy');
            const btn = event.target;
            const originalText = btn.textContent;
            btn.textContent = 'âœ… å·²å¤åˆ¶ï¼';
            setTimeout(() => {
                btn.textContent = originalText;
            }, 2000);
        } catch (err) {
            alert('å¤åˆ¶å¤±è´¥ï¼Œè¯·æ‰‹åŠ¨å¤åˆ¶ä»£ç ');
        }

        document.body.removeChild(textArea);
    });
}

// æ˜¾ç¤º/éšè—ç­”æ¡ˆ
function toggleAnswer(num, event) {
    const answer = document.getElementById(`answer${num}`);
    const btn = event.target;

    if (answer.style.display === 'block') {
        answer.style.display = 'none';
        btn.textContent = 'æŸ¥çœ‹ç­”æ¡ˆ';
    } else {
        answer.style.display = 'block';
        btn.textContent = 'éšè—ç­”æ¡ˆ';
    }
}

// Canvasç‚¹å‡»äº‹ä»¶
canvas.addEventListener('click', (e) => {
    if (graph.animationRunning) return;

    const rect = canvas.getBoundingClientRect();
    const x = e.clientX - rect.left;
    const y = e.clientY - rect.top;

    const node = graph.findNode(x, y);
    if (node) {
        resetGraph();
        graph.sourceNode = node;
        graph.distances[node.id] = 0;

        updateDistanceTable();
        drawGraph();
        updateLog(`ğŸ¯ å·²è®¾ç½®èŠ‚ç‚¹ ${node.label} ä¸ºèµ·ç‚¹ï¼Œç‚¹å‡»"å¼€å§‹ç®—æ³•"è¿è¡Œ`);
    }
});

// é€Ÿåº¦æ§åˆ¶
document.getElementById('speedSlider').addEventListener('input', (e) => {
    animationSpeed = parseInt(e.target.value);
    document.getElementById('speedValue').textContent = `${animationSpeed}ms`;
});

// åˆå§‹åŒ–
generateRandomGraph();
</script>

{% endblock %}