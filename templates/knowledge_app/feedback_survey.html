{% extends 'knowledge_app/base.html' %}

{% block title %}内测反馈问卷 - 计算机科学学习平台{% endblock %}

{% block extra_css %}
<style>* {box-sizing:border-box}body {font-family:-apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Helvetica Neue', Arial, sans-serif;line-height:1.6;color:var(--text-primary);background:linear-gradient(135deg, var(--primary-color) 0%, var(--secondary-color) 100%);min-height:100vh;margin:0;padding:0}.page-layout {min-height:100vh;display:flex;flex-direction:column}.main-content {flex:1;width:100%}.survey-container {max-width:800px;margin:0 auto;padding:40px 40px;min-height:100vh;position:relative;z-index:1}.page-header {background:rgba(255, 255, 255, 0.1);backdrop-filter:blur(15px);border-radius:24px;padding:40px;margin-bottom:32px;color:var(--text-inverse);text-align:center;position:relative;z-index:2;box-shadow:var(--shadow-md)}.page-title {font-size:2.5rem;font-weight:800;margin-bottom:16px;letter-spacing:-0.02em;text-shadow:0 2px 8px rgba(0, 0, 0, 0.1);display:flex;align-items:center;justify-content:center;gap:16px}.page-subtitle {font-size:1.1rem;opacity:0.92;margin-bottom:0;font-weight:400;line-height:1.5}.survey-form {background:var(--bg-card);border-radius:24px;padding:48px;box-shadow:var(--shadow-md);position:relative;overflow:hidden;border:1px solid rgba(0,0,0,0.06)}.survey-form::before {content:'';position:absolute;top:0;left:0;right:0;height:4px;background:linear-gradient(135deg, var(--accent-color), #44a08d, var(--primary-color));border-radius:24px 24px 0 0}.form-section {margin-bottom:40px}.form-section:last-child {margin-bottom:0}.section-title {font-size:1.3rem;font-weight:700;color:#2c3e50;margin-bottom:20px;display:flex;align-items:center;gap:12px}.section-icon {font-size:1.4rem}.form-group {margin-bottom:24px}.form-label {display:block;font-weight:600;color:#2c3e50;margin-bottom:8px;font-size:1rem}.form-label.required::after {content:' *';color:#e53e3e}.form-input, .form-select, .form-textarea {width:100%;padding:12px 16px;border:2px solid #e2e8f0;border-radius:12px;font-size:1rem;transition:all 0.3s ease;background:var(--bg-card);font-family:inherit}.form-input:focus, .form-select:focus, .form-textarea:focus {outline:none;border-color:var(--primary-color);box-shadow:0 0 0 3px rgba(102, 126, 234, 0.1)}.form-textarea {resize:vertical;min-height:100px}.rating-group {display:flex;gap:8px;align-items:center;flex-wrap:wrap}.rating-option {display:flex;align-items:center;gap:6px;padding:8px 16px;border:2px solid #e2e8f0;border-radius:12px;cursor:pointer;transition:all 0.3s ease;background:var(--bg-card)}.rating-option:hover {border-color:var(--primary-color);background:#f7fafc}.rating-option input[type="radio"] {margin:0}.rating-option.selected {border-color:var(--primary-color);background:#edf2f7}.checkbox-group {display:grid;grid-template-columns:repeat(auto-fit, minmax(200px, 1fr));gap:12px}.checkbox-option {display:flex;align-items:center;gap:8px;padding:12px;border:1px solid var(--border-color);border-radius:var(--border-radius-sm);cursor:pointer;transition:all 0.3s ease}.checkbox-option:hover {background:#f7fafc;border-color:#cbd5e0}.checkbox-option input[type="checkbox"] {margin:0}.submit-section {text-align:center;padding-top:32px;border-top:1px solid #e2e8f0}.submit-btn {padding:16px 48px;background:linear-gradient(135deg, var(--primary-color), var(--secondary-color));color:var(--text-inverse);border:none;border-radius:16px;font-size:1.1rem;font-weight:700;cursor:pointer;transition:all 0.3s ease;display:inline-flex;align-items:center;gap:12px}.submit-btn:hover {transform:translateY(-2px);box-shadow:0 12px 32px rgba(102, 126, 234, 0.3)}.submit-btn:disabled {opacity:0.6;cursor:not-allowed;transform:none;box-shadow:none}.loading {display:none;align-items:center;gap:8px}.spinner {width:20px;height:20px;border:2px solid rgba(255, 255, 255, 0.3);border-top:2px solid white;border-radius:50%;animation:spin 1s linear infinite}@keyframes spin {0% {transform:rotate(0deg)}100% {transform:rotate(360deg)}}.success-message {display:none;background:#e8f5e8;border:1px solid #c8e6c9;border-radius:12px;padding:20px;margin-top:20px;color:#2e7d32;text-align:center}.success-icon {font-size:2rem;margin-bottom:12px}.error-message {display:none;background:#ffebee;border:1px solid #ffcdd2;border-radius:12px;padding:20px;margin-top:20px;color:#d32f2f;text-align:center}@media (max-width:768px) {.survey-container {padding:28px 20px}.page-header {padding:32px 24px}.page-title {font-size:2rem}.survey-form {padding:32px 24px}.rating-group {flex-direction:column;align-items:stretch}.rating-option {justify-content:center}.checkbox-group {grid-template-columns:1fr}}@keyframes fadeInUp {from {opacity:0;transform:translateY(30px)}to {opacity:1;transform:translateY(0)}}.survey-container {animation:fadeInUp 0.8s ease-out}.survey-form {animation:fadeInUp 0.6s ease-out 0.2s both}</style>
{% endblock %}

{% block content %}
<main class="page-layout" role="main"><div class="main-content"><div class="survey-container"><!-- 页面头部 --><header class="page-header"><h1 class="page-title"><span>📝</span><span>内测反馈问卷</span></h1><p class="page-subtitle">您的反馈将帮助我们打造更好的学习平台</p></header><!-- 问卷表单 --><form id="feedbackForm" class="survey-form"><!-- 基本信息 --><div class="form-section"><h2 class="section-title"><span class="section-icon">👤</span>
                        基本信息
                    </h2><div class="form-group"><label class="form-label required">您的身份是？</label><select name="userType" class="form-select" required><option value="">请选择</option><option value="student">在校学生</option><option value="graduate">应届毕业生</option><option value="professional">在职人员</option><option value="self-learner">自学者</option><option value="teacher">教师/讲师</option><option value="other">其他</option></select></div><div class="form-group"><label class="form-label">联系邮箱（可选，用于后续沟通）</label><input type="email" name="contactEmail" class="form-input" placeholder="your@email.com"></div></div><!-- 使用体验 --><div class="form-section"><h2 class="section-title"><span class="section-icon">⭐</span>
                        使用体验
                    </h2><div class="form-group"><label class="form-label required">总体而言，您对平台的体验如何？</label><div class="rating-group"><label class="rating-option"><input type="radio" name="experienceRating" value="5" required><span>😍 非常满意</span></label><label class="rating-option"><input type="radio" name="experienceRating" value="4" required><span>😊 满意</span></label><label class="rating-option"><input type="radio" name="experienceRating" value="3" required><span>😐 一般</span></label><label class="rating-option"><input type="radio" name="experienceRating" value="2" required><span>😕 不满意</span></label><label class="rating-option"><input type="radio" name="experienceRating" value="1" required><span>😞 非常不满意</span></label></div></div><div class="form-group"><label class="form-label required">您觉得哪个功能最有用？</label><div class="checkbox-group"><label class="checkbox-option"><input type="checkbox" name="mostUsefulFeature" value="daily-term"><span>📚 每日名词</span></label><label class="checkbox-option"><input type="checkbox" name="mostUsefulFeature" value="cs-universe"><span>🌌 CS宇宙</span></label><label class="checkbox-option"><input type="checkbox" name="mostUsefulFeature" value="exercises"><span>🎯 练习题库</span></label><label class="checkbox-option"><input type="checkbox" name="mostUsefulFeature" value="ai-assistant"><span>🤖 AI助手</span></label><label class="checkbox-option"><input type="checkbox" name="mostUsefulFeature" value="achievements"><span>🏆 成就系统</span></label><label class="checkbox-option"><input type="checkbox" name="mostUsefulFeature" value="search"><span>🔍 智能搜索</span></label></div></div><div class="form-group"><label class="form-label required">平台的学习难度如何？</label><div class="rating-group"><label class="rating-option"><input type="radio" name="difficultyRating" value="too-easy" required><span>😴 太简单</span></label><label class="rating-option"><input type="radio" name="difficultyRating" value="just-right" required><span>👍 刚好</span></label><label class="rating-option"><input type="radio" name="difficultyRating" value="too-hard" required><span>😰 太难</span></label></div></div></div><!-- 改进建议 --><div class="form-section"><h2 class="section-title"><span class="section-icon">💡</span>
                        改进建议
                    </h2><div class="form-group"><label class="form-label">您认为平台还需要改进哪些方面？</label><textarea name="improvementSuggestions" class="form-textarea" rows="4" placeholder="请详细描述您的建议..."></textarea></div><div class="form-group"><label class="form-label">您希望看到哪些新功能？</label><textarea name="newFeatures" class="form-textarea" rows="4" placeholder="请描述您希望的新功能..."></textarea></div></div><!-- 推荐意愿 --><div class="form-section"><h2 class="section-title"><span class="section-icon">🤝</span>
                        推荐意愿
                    </h2><div class="form-group"><label class="form-label required">您会向朋友推荐这个平台吗？</label><div class="rating-group"><label class="rating-option"><input type="radio" name="recommendationRating" value="5" required><span>🌟 非常愿意</span></label><label class="rating-option"><input type="radio" name="recommendationRating" value="4" required><span>👍 愿意</span></label><label class="rating-option"><input type="radio" name="recommendationRating" value="3" required><span>🤔 可能会</span></label><label class="rating-option"><input type="radio" name="recommendationRating" value="2" required><span>😐 不太会</span></label><label class="rating-option"><input type="radio" name="recommendationRating" value="1" required><span>❌ 不会</span></label></div></div></div><!-- 其他意见 --><div class="form-section"><h2 class="section-title"><span class="section-icon">💬</span>
                        其他意见
                    </h2><div class="form-group"><label class="form-label">还有什么想对我们说的吗？</label><textarea name="additionalComments" class="form-textarea" rows="5" placeholder="任何想法、建议或鼓励都欢迎..."></textarea></div></div><!-- 提交按钮 --><div class="submit-section"><button type="submit" class="submit-btn"><span class="submit-text">📤 提交反馈</span><div class="loading"><div class="spinner"></div><span>提交中...</span></div></button><div class="success-message"><div class="success-icon">🎉</div><h3>感谢您的反馈！</h3><p>您的意见对我们非常重要，我们会认真考虑每一条建议。</p></div><div class="error-message"><div class="error-icon">😔</div><h3>提交失败</h3><p>请稍后重试，或直接发送邮件到 <a href="mailto:2795828496@qq.com">2795828496@qq.com</a></p></div></div></form></div></div></main><script>document.addEventListener('DOMContentLoaded', function() { const form = document.getElementById('feedbackForm'); const submitBtn = form.querySelector('.submit-btn'); const submitText = submitBtn.querySelector('.submit-text'); const loading = submitBtn.querySelector('.loading'); const successMessage = form.querySelector('.success-message'); const errorMessage = form.querySelector('.error-message'); document.querySelectorAll('input[type="radio"]').forEach(radio => { radio.addEventListener('change', function() { const name = this.name; document.querySelectorAll(`input[name="${name}"]`).forEach(r => { r.closest('.rating-option').classList.remove('selected'); }); this.closest('.rating-option').classList.add('selected'); }); }); form.addEventListener('submit', async function(e) { e.preventDefault(); submitBtn.disabled = true; submitText.style.display = 'none'; loading.style.display = 'flex'; successMessage.style.display = 'none'; errorMessage.style.display = 'none'; try { const formData = new FormData(form); const data = {}; for (let [key, value] of formData.entries()) { if (key === 'mostUsefulFeature') { if (!data[key]) data[key] = []; data[key].push(value); } else { data[key] = value; } } const response = await fetch('/api/feedback-survey/', { method: 'POST', headers: { 'Content-Type': 'application/json', 'X-CSRFToken': getCookie('csrftoken'), }, body: JSON.stringify(data) }); const result = await response.json(); if (result.success) { successMessage.style.display = 'block'; form.style.display = 'none'; setTimeout(() => { if (confirm('反馈提交成功！是否返回主页？')) { window.location.href = '/'; } }, 3000); } else { throw new Error(result.message || '提交失败'); } } catch (error) { console.error('提交反馈时出错:', error); errorMessage.style.display = 'block'; } finally { submitBtn.disabled = false; submitText.style.display = 'inline'; loading.style.display = 'none'; } }); function getCookie(name) { let cookieValue = null; if (document.cookie && document.cookie !== '') { const cookies = document.cookie.split(';'); for (let i = 0; i < cookies.length; i++) { const cookie = cookies[i].trim(); if (cookie.substring(0, name.length + 1) === (name + '=')) { cookieValue = decodeURIComponent(cookie.substring(name.length + 1)); break; } } } return cookieValue; } });</script>
{% endblock %}
