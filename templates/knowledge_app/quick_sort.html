{% extends 'knowledge_app/base.html' %}

{% block title %}å¿«é€Ÿæ’åº - è®¡ç®—æœºç§‘å­¦å­¦ä¹ å¹³å°{% endblock %}

{% block content %}
<div class="page-container fade-in"><!-- é¢åŒ…å±‘å¯¼èˆª --><div class="breadcrumb"><a href="{% url 'knowledge_app:index' %}">é¦–é¡µ</a><span>></span><span>ç®—æ³•è®¾è®¡</span><span>></span><span>å¿«é€Ÿæ’åº</span></div><!-- é¡µé¢å¤´éƒ¨ --><div class="page-header slide-in-left"><h1><span class="page-icon">âš¡</span>
            å¿«é€Ÿæ’åº (Quick Sort)
        </h1><p>åŸºäºåˆ†æ²»æ€æƒ³çš„é«˜æ•ˆæ’åºç®—æ³•ï¼Œå¹³å‡æ—¶é—´å¤æ‚åº¦O(n log n)</p></div><!-- ä¸»è¦å†…å®¹ --><div class="content-card slide-in-right"><!-- ç®—æ³•æ¦‚è¿° --><div class="content-section"><h2 class="section-title"><span class="section-icon">ğŸ¯</span>
                ç®—æ³•åŸç†
            </h2><div class="concept-explanation"><p class="concept-intro">
                    å¿«é€Ÿæ’åºæ˜¯ä¸€ç§<strong>åˆ†æ²»ç®—æ³•</strong>ï¼Œé€šè¿‡é€‰æ‹©ä¸€ä¸ª"åŸºå‡†"å…ƒç´ ï¼Œå°†æ•°ç»„åˆ†ä¸ºä¸¤éƒ¨åˆ†ï¼š
                    å°äºåŸºå‡†çš„å…ƒç´ å’Œå¤§äºåŸºå‡†çš„å…ƒç´ ï¼Œç„¶åé€’å½’åœ°å¯¹è¿™ä¸¤éƒ¨åˆ†è¿›è¡Œæ’åºã€‚
                </p><div class="key-points"><div class="point-item"><span class="point-icon">ğŸ¯</span><div class="point-content"><h4>åˆ†æ²»æ€æƒ³</h4><p>å°†å¤§é—®é¢˜åˆ†è§£ä¸ºå°é—®é¢˜ï¼Œé€’å½’æ±‚è§£</p></div></div><div class="point-item"><span class="point-icon">âš–ï¸</span><div class="point-content"><h4>åˆ†åŒºæ“ä½œ</h4><p>é€‰æ‹©åŸºå‡†å…ƒç´ ï¼Œå°†æ•°ç»„åˆ†ä¸ºä¸¤ä¸ªå­æ•°ç»„</p></div></div><div class="point-item"><span class="point-icon">ğŸ”„</span><div class="point-content"><h4>é€’å½’æ’åº</h4><p>å¯¹å·¦å³å­æ•°ç»„é€’å½’åº”ç”¨å¿«é€Ÿæ’åº</p></div></div></div></div></div><!-- å¯è§†åŒ–æ¼”ç¤º --><div class="content-section"><h2 class="section-title"><span class="section-icon">ğŸ®</span>
                äº¤äº’å¼æ¼”ç¤º
            </h2><div class="interactive-demo"><div class="demo-controls"><div class="control-group"><label>æ•°ç»„ï¼š</label><input type="text" id="array-input" value="64,34,25,12,22,11,90" placeholder="è¾“å…¥æ•°ç»„ï¼Œç”¨é€—å·åˆ†éš”"><button class="demo-btn" onclick="updateArray()">æ›´æ–°æ•°ç»„</button></div><div class="control-group"><label>åŸºå‡†é€‰æ‹©ï¼š</label><select id="pivot-strategy"><option value="last">æœ€åä¸€ä¸ªå…ƒç´ </option><option value="first">ç¬¬ä¸€ä¸ªå…ƒç´ </option><option value="middle">ä¸­é—´å…ƒç´ </option><option value="random">éšæœºé€‰æ‹©</option></select><button class="demo-btn primary" onclick="startSort()">å¼€å§‹æ’åº</button><button class="demo-btn" onclick="resetSort()">é‡ç½®</button></div></div><div id="array-display" class="array-display"></div><div class="sort-info"><div class="info-row"><div class="info-item"><span class="info-label">å½“å‰æ­¥éª¤ï¼š</span><span id="current-step">0</span></div><div class="info-item"><span class="info-label">æ¯”è¾ƒæ¬¡æ•°ï¼š</span><span id="comparison-count">0</span></div><div class="info-item"><span class="info-label">äº¤æ¢æ¬¡æ•°ï¼š</span><span id="swap-count">0</span></div><div class="info-item"><span class="info-label">é€’å½’æ·±åº¦ï¼š</span><span id="recursion-depth">0</span></div></div><div class="sort-status" id="sort-status">å‡†å¤‡å¼€å§‹æ’åº</div></div></div></div><!-- ç®—æ³•æ­¥éª¤ --><div class="content-section"><h2 class="section-title"><span class="section-icon">ğŸ“‹</span>
                ç®—æ³•æ­¥éª¤
            </h2><div class="steps-container"><div class="step-item"><div class="step-number">1</div><div class="step-content"><h4>é€‰æ‹©åŸºå‡†</h4><p>ä»æ•°ç»„ä¸­é€‰æ‹©ä¸€ä¸ªå…ƒç´ ä½œä¸ºåŸºå‡†ï¼ˆpivotï¼‰ï¼Œå¸¸è§ç­–ç•¥æœ‰é€‰æ‹©ç¬¬ä¸€ä¸ªã€æœ€åä¸€ä¸ªã€ä¸­é—´æˆ–éšæœºå…ƒç´ </p></div></div><div class="step-item"><div class="step-number">2</div><div class="step-content"><h4>åˆ†åŒºæ“ä½œ</h4><p>é‡æ–°æ’åˆ—æ•°ç»„ï¼Œä½¿å¾—å°äºåŸºå‡†çš„å…ƒç´ åœ¨å·¦è¾¹ï¼Œå¤§äºåŸºå‡†çš„å…ƒç´ åœ¨å³è¾¹</p></div></div><div class="step-item"><div class="step-number">3</div><div class="step-content"><h4>é€’å½’æ’åº</h4><p>å¯¹åŸºå‡†å·¦è¾¹å’Œå³è¾¹çš„å­æ•°ç»„é€’å½’åº”ç”¨å¿«é€Ÿæ’åº</p></div></div><div class="step-item"><div class="step-number">4</div><div class="step-content"><h4>åˆå¹¶ç»“æœ</h4><p>ç”±äºæ˜¯åŸåœ°æ’åºï¼Œä¸éœ€è¦é¢å¤–çš„åˆå¹¶æ­¥éª¤</p></div></div></div></div><!-- ä»£ç å®ç° --><div class="content-section"><h2 class="section-title"><span class="section-icon">ğŸ’»</span>
                ä»£ç å®ç°
            </h2><div class="code-tabs"><div class="tab-buttons"><button class="tab-btn active" onclick="showTab('python')">Python</button><button class="tab-btn" onclick="showTab('java')">Java</button><button class="tab-btn" onclick="showTab('cpp')">C++</button></div><div id="python-tab" class="tab-content active"><div class="code-example"><div class="code-header"><span class="code-title">Pythonå®ç°</span><button class="copy-btn" onclick="copyCode('python-code')">å¤åˆ¶ä»£ç </button></div><pre id="python-code"><code class="language-python">def quick_sort(arr, low=0, high=None):
    """
    å¿«é€Ÿæ’åºç®—æ³•
    :param arr: å¾…æ’åºæ•°ç»„
    :param low: èµ·å§‹ç´¢å¼•
    :param high: ç»“æŸç´¢å¼•
    """
    if high is None:
        high = len(arr) - 1
    
    if low < high:
        # åˆ†åŒºæ“ä½œï¼Œè·å–åŸºå‡†ä½ç½®
        pivot_index = partition(arr, low, high)
        
        # é€’å½’æ’åºå·¦å³å­æ•°ç»„
        quick_sort(arr, low, pivot_index - 1)
        quick_sort(arr, pivot_index + 1, high)

def partition(arr, low, high):
    """
    åˆ†åŒºå‡½æ•°ï¼Œé€‰æ‹©æœ€åä¸€ä¸ªå…ƒç´ ä½œä¸ºåŸºå‡†
    """
    pivot = arr[high]  # é€‰æ‹©æœ€åä¸€ä¸ªå…ƒç´ ä½œä¸ºåŸºå‡†
    i = low - 1  # å°äºåŸºå‡†çš„å…ƒç´ çš„ç´¢å¼•
    
    for j in range(low, high):
        if arr[j] <= pivot:
            i += 1
            arr[i], arr[j] = arr[j], arr[i]  # äº¤æ¢å…ƒç´ 
    
    arr[i + 1], arr[high] = arr[high], arr[i + 1]  # å°†åŸºå‡†æ”¾åˆ°æ­£ç¡®ä½ç½®
    return i + 1

# ä½¿ç”¨ç¤ºä¾‹
arr = [64, 34, 25, 12, 22, 11, 90]
print("åŸæ•°ç»„:", arr)
quick_sort(arr)
print("æ’åºå:", arr)</code></pre></div></div><div id="java-tab" class="tab-content"><div class="code-example"><div class="code-header"><span class="code-title">Javaå®ç°</span><button class="copy-btn" onclick="copyCode('java-code')">å¤åˆ¶ä»£ç </button></div><pre id="java-code"><code class="language-java">public class QuickSort {
    
    public static void quickSort(int[] arr, int low, int high) {
        if (low < high) {
            // åˆ†åŒºæ“ä½œï¼Œè·å–åŸºå‡†ä½ç½®
            int pivotIndex = partition(arr, low, high);
            
            // é€’å½’æ’åºå·¦å³å­æ•°ç»„
            quickSort(arr, low, pivotIndex - 1);
            quickSort(arr, pivotIndex + 1, high);
        }
    }
    
    private static int partition(int[] arr, int low, int high) {
        int pivot = arr[high]; // é€‰æ‹©æœ€åä¸€ä¸ªå…ƒç´ ä½œä¸ºåŸºå‡†
        int i = low - 1; // å°äºåŸºå‡†çš„å…ƒç´ çš„ç´¢å¼•
        
        for (int j = low; j < high; j++) {
            if (arr[j] <= pivot) {
                i++;
                // äº¤æ¢å…ƒç´ 
                int temp = arr[i];
                arr[i] = arr[j];
                arr[j] = temp;
            }
        }
        
        // å°†åŸºå‡†æ”¾åˆ°æ­£ç¡®ä½ç½®
        int temp = arr[i + 1];
        arr[i + 1] = arr[high];
        arr[high] = temp;
        
        return i + 1;
    }
    
    public static void main(String[] args) {
        int[] arr = {64, 34, 25, 12, 22, 11, 90};
        System.out.println("åŸæ•°ç»„: " + Arrays.toString(arr));
        quickSort(arr, 0, arr.length - 1);
        System.out.println("æ’åºå: " + Arrays.toString(arr));
    }
}</code></pre></div></div><div id="cpp-tab" class="tab-content"><div class="code-example"><div class="code-header"><span class="code-title">C++å®ç°</span><button class="copy-btn" onclick="copyCode('cpp-code')">å¤åˆ¶ä»£ç </button></div><pre id="cpp-code"><code class="language-cpp">#include <iostream>
#include <vector>

void quickSort(std::vector<int>& arr, int low, int high) {
    if (low < high) {
        // åˆ†åŒºæ“ä½œï¼Œè·å–åŸºå‡†ä½ç½®
        int pivotIndex = partition(arr, low, high);
        
        // é€’å½’æ’åºå·¦å³å­æ•°ç»„
        quickSort(arr, low, pivotIndex - 1);
        quickSort(arr, pivotIndex + 1, high);
    }
}

int partition(std::vector<int>& arr, int low, int high) {
    int pivot = arr[high]; // é€‰æ‹©æœ€åä¸€ä¸ªå…ƒç´ ä½œä¸ºåŸºå‡†
    int i = low - 1; // å°äºåŸºå‡†çš„å…ƒç´ çš„ç´¢å¼•
    
    for (int j = low; j < high; j++) {
        if (arr[j] <= pivot) {
            i++;
            std::swap(arr[i], arr[j]); // äº¤æ¢å…ƒç´ 
        }
    }
    
    std::swap(arr[i + 1], arr[high]); // å°†åŸºå‡†æ”¾åˆ°æ­£ç¡®ä½ç½®
    return i + 1;
}

int main() {
    std::vector<int> arr = {64, 34, 25, 12, 22, 11, 90};
    
    std::cout << "åŸæ•°ç»„: ";
    for (int x : arr) std::cout << x << " ";
    std::cout << std::endl;
    
    quickSort(arr, 0, arr.size() - 1);
    
    std::cout << "æ’åºå: ";
    for (int x : arr) std::cout << x << " ";
    std::cout << std::endl;
    
    return 0;
}</code></pre></div></div></div></div><!-- å¤æ‚åº¦åˆ†æ --><div class="content-section"><h2 class="section-title"><span class="section-icon">ğŸ“Š</span>
                å¤æ‚åº¦åˆ†æ
            </h2><div class="complexity-grid"><div class="complexity-card best"><h4 class="complexity-title"><span class="complexity-icon">ğŸ†</span>
                        æœ€ä½³æƒ…å†µ
                    </h4><div class="complexity-details"><p><strong>æ—¶é—´å¤æ‚åº¦ï¼š</strong>O(n log n)</p><p><strong>æ¡ä»¶ï¼š</strong>æ¯æ¬¡åˆ†åŒºéƒ½èƒ½å°†æ•°ç»„å¹³å‡åˆ†å‰²</p><p><strong>ç©ºé—´å¤æ‚åº¦ï¼š</strong>O(log n)</p></div></div><div class="complexity-card average"><h4 class="complexity-title"><span class="complexity-icon">ğŸ“Š</span>
                        å¹³å‡æƒ…å†µ
                    </h4><div class="complexity-details"><p><strong>æ—¶é—´å¤æ‚åº¦ï¼š</strong>O(n log n)</p><p><strong>æ¡ä»¶ï¼š</strong>éšæœºè¾“å…¥æ•°æ®</p><p><strong>ç©ºé—´å¤æ‚åº¦ï¼š</strong>O(log n)</p></div></div><div class="complexity-card worst"><h4 class="complexity-title"><span class="complexity-icon">âš ï¸</span>
                        æœ€åæƒ…å†µ
                    </h4><div class="complexity-details"><p><strong>æ—¶é—´å¤æ‚åº¦ï¼š</strong>O(nÂ²)</p><p><strong>æ¡ä»¶ï¼š</strong>æ•°ç»„å·²æ’åºæˆ–é€†åºæ’åº</p><p><strong>ç©ºé—´å¤æ‚åº¦ï¼š</strong>O(n)</p></div></div></div></div><!-- ä¼˜åŒ–ç­–ç•¥ --><div class="content-section"><h2 class="section-title"><span class="section-icon">ğŸš€</span>
                ä¼˜åŒ–ç­–ç•¥
            </h2><div class="optimization-grid"><div class="opt-card"><h4 class="opt-title"><span class="opt-icon">ğŸ¯</span>
                        ä¸‰æ•°å–ä¸­
                    </h4><p class="opt-desc">é€‰æ‹©é¦–ã€ä¸­ã€å°¾ä¸‰ä¸ªå…ƒç´ çš„ä¸­ä½æ•°ä½œä¸ºåŸºå‡†ï¼Œé¿å…æœ€åæƒ…å†µ</p></div><div class="opt-card"><h4 class="opt-title"><span class="opt-icon">ğŸ”€</span>
                        éšæœºåŒ–åŸºå‡†
                    </h4><p class="opt-desc">éšæœºé€‰æ‹©åŸºå‡†å…ƒç´ ï¼Œé™ä½é‡åˆ°æœ€åæƒ…å†µçš„æ¦‚ç‡</p></div><div class="opt-card"><h4 class="opt-title"><span class="opt-icon">ğŸ“</span>
                        å°æ•°ç»„ä¼˜åŒ–
                    </h4><p class="opt-desc">å¯¹å°æ•°ç»„ä½¿ç”¨æ’å…¥æ’åºï¼Œå‡å°‘é€’å½’å¼€é”€</p></div><div class="opt-card"><h4 class="opt-title"><span class="opt-icon">ğŸ”„</span>
                        å°¾é€’å½’ä¼˜åŒ–
                    </h4><p class="opt-desc">å°†é€’å½’è½¬æ¢ä¸ºè¿­ä»£ï¼Œå‡å°‘æ ˆç©ºé—´ä½¿ç”¨</p></div></div></div><!-- åº”ç”¨åœºæ™¯ --><div class="content-section"><h2 class="section-title"><span class="section-icon">ğŸ¯</span>
                å®é™…åº”ç”¨
            </h2><div class="application-grid"><div class="app-card"><span class="app-icon">ğŸ’¾</span><h4>ç³»ç»Ÿæ’åº</h4><p>æ“ä½œç³»ç»Ÿå’Œç¼–ç¨‹è¯­è¨€çš„å†…ç½®æ’åºå‡½æ•°</p></div><div class="app-card"><span class="app-icon">ğŸ”</span><h4>æ•°æ®å¤„ç†</h4><p>å¤§æ•°æ®å¤„ç†å’Œæ•°æ®åº“æŸ¥è¯¢ä¼˜åŒ–</p></div><div class="app-card"><span class="app-icon">ğŸ“Š</span><h4>ç»Ÿè®¡åˆ†æ</h4><p>æ•°æ®åˆ†æä¸­çš„æ’åºå’Œåˆ†ä½æ•°è®¡ç®—</p></div><div class="app-card"><span class="app-icon">ğŸ®</span><h4>æ¸¸æˆå¼€å‘</h4><p>æ’è¡Œæ¦œã€ç‰©ä½“æ¸²æŸ“é¡ºåºç­‰</p></div></div></div></div><!-- å­¦ä¹ æç¤º --><div class="content-card"><div class="content-section"><h2 class="section-title"><span class="section-icon">ğŸ’¡</span>
                å­¦ä¹ è¦ç‚¹
            </h2><div class="unified-grid unified-grid-2"><div class="info-box info-box-info"><span class="info-icon">ğŸ¯</span><strong>ç†è§£åˆ†æ²»ï¼š</strong>æŒæ¡åˆ†æ²»ç®—æ³•çš„æ ¸å¿ƒæ€æƒ³å’Œé€’å½’ç»“æ„ã€‚
                </div><div class="info-box info-box-success"><span class="info-icon">âš–ï¸</span><strong>åˆ†åŒºæ“ä½œï¼š</strong>æ·±å…¥ç†è§£åˆ†åŒºå‡½æ•°çš„å®ç°å’ŒåŒæŒ‡é’ˆæŠ€å·§ã€‚
                </div><div class="info-box info-box-warning"><span class="info-icon">âš ï¸</span><strong>æœ€åæƒ…å†µï¼š</strong>äº†è§£ä»€ä¹ˆæƒ…å†µä¸‹ä¼šé€€åŒ–ä¸ºO(nÂ²)åŠå¦‚ä½•é¿å…ã€‚
                </div><div class="info-box info-box-info"><span class="info-icon">ğŸš€</span><strong>ä¼˜åŒ–æŠ€å·§ï¼š</strong>å­¦ä¹ å„ç§ä¼˜åŒ–ç­–ç•¥æé«˜ç®—æ³•æ€§èƒ½ã€‚
                </div></div></div></div></div><style>.interactive-demo {background:#f8f9fa;border-radius:12px;padding:25px;margin:20px 0}.demo-controls {display:flex;flex-direction:column;gap:15px;margin-bottom:25px}.control-group {display:flex;align-items:center;gap:10px;flex-wrap:wrap}.control-group label {font-weight:600;color:#333;min-width:80px}.control-group input, .control-group select {padding:8px 12px;border:1px solid #ddd;border-radius:6px;flex:1;min-width:200px}.demo-btn {padding:8px 16px;background:#6c757d;color:white;border:none;border-radius:6px;cursor:pointer;font-weight:500;transition:all 0.3s ease}.demo-btn.primary {background:#007bff}.demo-btn:hover {transform:translateY(-1px);box-shadow:0 2px 8px rgba(0,0,0,0.2)}.demo-btn.primary:hover {background:#0056b3}.array-display {display:flex;justify-content:center;align-items:flex-end;gap:5px;margin:25px 0;padding:20px;background:white;border-radius:8px;border:1px solid #e9ecef;overflow-x:auto;min-height:120px}.array-element {display:flex;flex-direction:column;align-items:center;transition:all 0.3s ease;position:relative}.array-bar {width:40px;background:#007bff;border-radius:4px 4px 0 0;display:flex;align-items:flex-end;justify-content:center;color:white;font-weight:600;font-size:12px;padding:5px 2px;min-height:30px;transition:all 0.3s ease}.array-value {margin-top:5px;font-size:14px;font-weight:600;color:#333}.array-element.pivot {transform:scale(1.1)}.array-element.pivot .array-bar {background:#dc3545;box-shadow:0 4px 12px rgba(220,53,69,0.4)}.array-element.comparing .array-bar {background:#ffc107;animation:pulse 1s infinite}.array-element.left-partition .array-bar {background:#28a745}.array-element.right-partition .array-bar {background:#6f42c1}.array-element.sorted .array-bar {background:#17a2b8;opacity:0.7}.sort-info {background:white;border-radius:8px;padding:20px;border:1px solid #e9ecef}.info-row {display:grid;grid-template-columns:repeat(auto-fit, minmax(150px, 1fr));gap:15px;margin-bottom:15px}.info-item {text-align:center;padding:10px;background:#f8f9fa;border-radius:6px}.info-label {display:block;font-size:14px;color:#666;margin-bottom:5px}.info-item span:last-child {font-size:18px;font-weight:600;color:#007bff}.sort-status {text-align:center;padding:15px;border-radius:8px;font-weight:600;margin-top:15px}.sort-status.sorting {background:#cce7ff;color:#004085;border:1px solid #b3d7ff}.sort-status.completed {background:#d4edda;color:#155724;border:1px solid #c3e6cb}.complexity-grid {display:grid;grid-template-columns:repeat(auto-fit, minmax(280px, 1fr));gap:20px;margin:20px 0}.complexity-card {padding:20px;border-radius:12px;border:1px solid #e9ecef;text-align:center}.complexity-card.best {background:linear-gradient(135deg, #d4edda, #c3e6cb);border-color:#c3e6cb}.complexity-card.average {background:linear-gradient(135deg, #cce7ff, #b3d7ff);border-color:#b3d7ff}.complexity-card.worst {background:linear-gradient(135deg, #f8d7da, #f5c6cb);border-color:#f5c6cb}.complexity-title {display:flex;align-items:center;justify-content:center;gap:10px;margin-bottom:15px;color:#333}.complexity-details p {margin:8px 0;color:#555}.optimization-grid {display:grid;grid-template-columns:repeat(auto-fit, minmax(250px, 1fr));gap:20px;margin:20px 0}.opt-card {background:#f8f9fa;padding:20px;border-radius:12px;border:1px solid #e9ecef;text-align:center;transition:all 0.3s ease}.opt-card:hover {transform:translateY(-5px);box-shadow:0 8px 25px rgba(0,0,0,0.1);background:white}.opt-title {display:flex;align-items:center;justify-content:center;gap:10px;margin-bottom:10px;color:#333}.opt-desc {color:#666;font-size:14px;line-height:1.5}@keyframes pulse {0%, 100% {opacity:1}50% {opacity:0.6}}@media (max-width:768px) {.control-group {flex-direction:column;align-items:stretch}.control-group label {min-width:auto}.control-group input, .control-group select {min-width:auto}.array-display {flex-wrap:wrap;justify-content:center;align-items:flex-start}.array-bar {width:35px;font-size:11px}.info-row {grid-template-columns:1fr}.complexity-grid, .optimization-grid {grid-template-columns:1fr}}</style><script>let currentArray = [64, 34, 25, 12, 22, 11, 90]; let originalArray = [...currentArray]; let sortSteps = []; let currentStep = 0; let isSorting = false; let comparisonCount = 0; let swapCount = 0; let maxDepth = 0; function updateArray() { const input = document.getElementById('array-input').value; try { const newArray = input.split(',').map(num => parseInt(num.trim())).filter(num => !isNaN(num)); if (newArray.length === 0) { alert('è¯·è¾“å…¥æœ‰æ•ˆçš„æ•°å­—æ•°ç»„'); return; } currentArray = [...newArray]; originalArray = [...newArray]; resetSort(); displayArray(); } catch (error) { alert('è¾“å…¥æ ¼å¼é”™è¯¯ï¼Œè¯·ä½¿ç”¨é€—å·åˆ†éš”çš„æ•°å­—'); } } function displayArray() { const displayElement = document.getElementById('array-display'); displayElement.innerHTML = ''; const maxValue = Math.max(...currentArray); currentArray.forEach((value, index) => { const element = document.createElement('div'); element.className = 'array-element'; element.id = `element-${index}`; const bar = document.createElement('div'); bar.className = 'array-bar'; bar.style.height = `${(value / maxValue) * 80 + 20}px`; bar.textContent = value; const valueLabel = document.createElement('div'); valueLabel.className = 'array-value'; valueLabel.textContent = value; element.appendChild(bar); element.appendChild(valueLabel); displayElement.appendChild(element); }); } function startSort() { if (isSorting) return; isSorting = true; currentStep = 0; comparisonCount = 0; swapCount = 0; maxDepth = 0; sortSteps = []; currentArray = [...originalArray]; displayArray(); generateSortSteps(); animateSort(); } function generateSortSteps() { const arr = [...originalArray]; const steps = []; function quickSortSteps(arr, low, high, depth = 0) { maxDepth = Math.max(maxDepth, depth); if (low < high) { const pivotStrategy = document.getElementById('pivot-strategy').value; let pivotIndex = choosePivot(arr, low, high, pivotStrategy); if (pivotIndex !== high) { steps.push({ type: 'swap', indices: [pivotIndex, high], message: `å°†åŸºå‡†å…ƒç´ ç§»åˆ°æœ«å°¾` }); [arr[pivotIndex], arr[high]] = [arr[high], arr[pivotIndex]]; swapCount++; } steps.push({ type: 'pivot', index: high, value: arr[high], message: `é€‰æ‹© ${arr[high]} ä½œä¸ºåŸºå‡†` }); const finalPivotIndex = partitionSteps(arr, low, high, steps); steps.push({ type: 'partition_complete', pivotIndex: finalPivotIndex, message: `åˆ†åŒºå®Œæˆï¼ŒåŸºå‡† ${arr[finalPivotIndex]} å·²å°±ä½` }); quickSortSteps(arr, low, finalPivotIndex - 1, depth + 1); quickSortSteps(arr, finalPivotIndex + 1, high, depth + 1); } } quickSortSteps(arr, 0, arr.length - 1); steps.push({ type: 'complete', message: 'æ’åºå®Œæˆï¼' }); sortSteps = steps; } function choosePivot(arr, low, high, strategy) { switch (strategy) { case 'first': return low; case 'middle': return Math.floor((low + high) / 2); case 'random': return Math.floor(Math.random() * (high - low + 1)) + low; case 'last': default: return high; } } function partitionSteps(arr, low, high, steps) { const pivot = arr[high]; let i = low - 1; for (let j = low; j < high; j++) { comparisonCount++; steps.push({ type: 'compare', indices: [j, high], message: `æ¯”è¾ƒ ${arr[j]} ä¸åŸºå‡† ${pivot}` }); if (arr[j] <= pivot) { i++; if (i !== j) { steps.push({ type: 'swap', indices: [i, j], message: `äº¤æ¢ ${arr[i]} å’Œ ${arr[j]}` }); [arr[i], arr[j]] = [arr[j], arr[i]]; swapCount++; } } } steps.push({ type: 'swap', indices: [i + 1, high], message: `å°†åŸºå‡† ${pivot} æ”¾åˆ°æ­£ç¡®ä½ç½®` }); [arr[i + 1], arr[high]] = [arr[high], arr[i + 1]]; swapCount++; return i + 1; } async function animateSort() { updateSortInfo('sorting', 'æ­£åœ¨æ’åº...'); for (let i = 0; i < sortSteps.length; i++) { currentStep = i + 1; const step = sortSteps[i]; document.querySelectorAll('.array-element').forEach(el => { el.className = 'array-element'; }); switch (step.type) { case 'pivot': document.getElementById(`element-${step.index}`).classList.add('pivot'); break; case 'compare': step.indices.forEach(idx => { document.getElementById(`element-${idx}`).classList.add('comparing'); }); break; case 'swap': [currentArray[step.indices[0]], currentArray[step.indices[1]]] = [currentArray[step.indices[1]], currentArray[step.indices[0]]]; displayArray(); step.indices.forEach(idx => { document.getElementById(`element-${idx}`).classList.add('comparing'); }); break; case 'partition_complete': document.getElementById(`element-${step.pivotIndex}`).classList.add('sorted'); break; case 'complete': document.querySelectorAll('.array-element').forEach(el => { el.classList.add('sorted'); }); updateSortInfo('completed', 'æ’åºå®Œæˆï¼'); break; } updateStepInfo(step.message); await new Promise(resolve => setTimeout(resolve, step.type === 'complete' ? 1000 : 800)); } isSorting = false; } function updateStepInfo(message) { document.getElementById('current-step').textContent = currentStep; document.getElementById('comparison-count').textContent = comparisonCount; document.getElementById('swap-count').textContent = swapCount; document.getElementById('recursion-depth').textContent = maxDepth; const statusElement = document.getElementById('sort-status'); statusElement.textContent = message; } function updateSortInfo(status, message) { const statusElement = document.getElementById('sort-status'); statusElement.textContent = message; statusElement.className = `sort-status ${status}`; } function resetSort() { isSorting = false; currentStep = 0; comparisonCount = 0; swapCount = 0; maxDepth = 0; sortSteps = []; currentArray = [...originalArray]; document.querySelectorAll('.array-element').forEach(el => { el.className = 'array-element'; }); updateStepInfo('å‡†å¤‡å¼€å§‹æ’åº'); updateSortInfo('', 'å‡†å¤‡å¼€å§‹æ’åº'); displayArray(); } function showTab(tabName) { document.querySelectorAll('.tab-content').forEach(tab => { tab.classList.remove('active'); }); document.querySelectorAll('.tab-btn').forEach(btn => { btn.classList.remove('active'); }); document.getElementById(`${tabName}-tab`).classList.add('active'); event.target.classList.add('active'); } function copyCode(elementId) { const codeElement = document.getElementById(elementId); const text = codeElement.textContent; navigator.clipboard.writeText(text).then(() => { alert('ä»£ç å·²å¤åˆ¶åˆ°å‰ªè´´æ¿ï¼'); }).catch(() => { alert('å¤åˆ¶å¤±è´¥ï¼Œè¯·æ‰‹åŠ¨å¤åˆ¶'); }); } document.addEventListener('DOMContentLoaded', function() { displayArray(); document.getElementById('array-input').addEventListener('keypress', function(e) { if (e.key === 'Enter') { updateArray(); } }); });</script>

{% endblock %}
