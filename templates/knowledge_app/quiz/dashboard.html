{% extends 'knowledge_app/quiz/base_quiz.html' %}

{% block title %}ä¸ªäººé¢˜åº“ - {{ block.super }}{% endblock %}

{% block quiz_breadcrumb %}
<div class="quiz-breadcrumb"><span>ğŸ </span><span>ä¸ªäººé¢˜åº“</span></div>
{% endblock %}

{% block quiz_content %}
<!-- æ¬¢è¿å¡ç‰‡ --><div class="quiz-card"><div class="quiz-card-header"><h1 class="quiz-card-title">ğŸ“ ä¸ªäººé¢˜åº“ç³»ç»Ÿ</h1><p class="quiz-card-subtitle">æ™ºèƒ½å­¦ä¹ ï¼Œç²¾å‡†æå‡</p></div><div class="quiz-card-body"><div class="quiz-grid quiz-grid-4"><div class="quiz-stat-card"><span class="quiz-stat-icon">ğŸ“š</span><div class="quiz-stat-value">{{ libraries.count }}</div><div class="quiz-stat-label">æˆ‘çš„é¢˜åº“</div></div><div class="quiz-stat-card"><span class="quiz-stat-icon">ğŸ“</span><div class="quiz-stat-value">{{ stats.total_questions_answered }}</div><div class="quiz-stat-label">æ€»ç­”é¢˜æ•°</div></div><div class="quiz-stat-card"><span class="quiz-stat-icon">âœ…</span><div class="quiz-stat-value">{{ stats.overall_accuracy }}%</div><div class="quiz-stat-label">æ€»æ­£ç¡®ç‡</div></div><div class="quiz-stat-card"><span class="quiz-stat-icon">âŒ</span><div class="quiz-stat-value">{{ wrong_answers_count }}</div><div class="quiz-stat-label">å¾…æŒæ¡é”™é¢˜</div></div></div></div></div><!-- ä»Šæ—¥å­¦ä¹  --><div class="quiz-card"><div class="quiz-card-body"><h2 style="margin-bottom: 1.5rem; color: black !important;">ğŸ“… ä»Šæ—¥å­¦ä¹ </h2><div class="quiz-grid quiz-grid-3"><div class="quiz-stat-card"><span class="quiz-stat-icon">â±ï¸</span><div class="quiz-stat-value">{{ today_study_time|floatformat:1 }}</div><div class="quiz-stat-label">å­¦ä¹ æ—¶é•¿(åˆ†é’Ÿ)</div></div><div class="quiz-stat-card"><span class="quiz-stat-icon">ğŸ¯</span><div class="quiz-stat-value">{{ today_sessions_count }}</div><div class="quiz-stat-label">ç»ƒä¹ æ¬¡æ•°</div></div><div class="quiz-stat-card"><span class="quiz-stat-icon">ğŸ“ˆ</span><div class="quiz-stat-value">{{ stats.total_study_time }}</div><div class="quiz-stat-label">ç´¯è®¡å­¦ä¹ (åˆ†é’Ÿ)</div></div></div></div></div><!-- å¿«é€Ÿæ“ä½œ --><div class="quiz-card"><div class="quiz-card-body"><h2 style="margin-bottom: 1.5rem; color: black !important;">ğŸš€ å¿«é€Ÿæ“ä½œ</h2><div class="quiz-grid quiz-grid-2"><div style="text-align: center; padding: 2rem;"><div style="font-size: 4rem; margin-bottom: 1rem;">ğŸ“š</div><h3 style="margin-bottom: 1rem; color: black !important;">ç®¡ç†é¢˜åº“</h3><p style="color: black !important; margin-bottom: 1.5rem;">åˆ›å»ºå’Œç®¡ç†ä½ çš„ä¸ªäººé¢˜åº“</p><div style="display: flex; gap: 1rem; justify-content: center; flex-wrap: wrap;"><a href="{% url 'knowledge_app:quiz_create_library' %}" class="quiz-btn quiz-btn-primary"><span>â•</span><span>åˆ›å»ºé¢˜åº“</span></a><a href="{% url 'knowledge_app:quiz_library_list' %}" class="quiz-btn quiz-btn-outline"><span>ğŸ“‹</span><span>é¢˜åº“åˆ—è¡¨</span></a></div></div><div style="text-align: center; padding: 2rem;"><div style="font-size: 4rem; margin-bottom: 1rem;">âŒ</div><h3 style="margin-bottom: 1rem; color: black !important;">é”™é¢˜ç»ƒä¹ </h3><p style="color: black !important; margin-bottom: 1.5rem;">å¤ä¹ é”™é¢˜ï¼Œå·©å›ºçŸ¥è¯†ç‚¹</p><div style="display: flex; gap: 1rem; justify-content: center; flex-wrap: wrap;">
                    {% if wrong_answers_count > 0 %}
                    <a href="{% url 'knowledge_app:quiz_practice_wrong_answers' %}" class="quiz-btn quiz-btn-warning"><span>ğŸ”„</span><span>å¼€å§‹ç»ƒä¹ </span></a>
                    {% endif %}
                    <a href="{% url 'knowledge_app:quiz_wrong_answers' %}" class="quiz-btn quiz-btn-outline"><span>ğŸ“–</span><span>é”™é¢˜æœ¬</span></a>
                    {% if wrong_answers_count > 0 %}
                    <a href="{% url 'knowledge_app:quiz_export_wrong_answers_pdf' %}" class="quiz-btn quiz-btn-danger" target="_blank"><span>ğŸ“„</span><span>å¯¼å‡ºPDF</span></a>
                    {% endif %}
                </div></div><div style="text-align: center; padding: 2rem; background: white; border-radius: var(--quiz-radius-xl); box-shadow: var(--quiz-shadow); flex: 1; min-width: 200px;"><div style="font-size: 3rem; margin-bottom: 1rem;">ğŸ¤</div><h3 style="margin-bottom: 1rem; color: black !important;">é¢˜åº“åˆ†äº«</h3><p style="color: black !important; margin-bottom: 1.5rem;">åˆ†äº«å’Œå‘ç°ä¼˜è´¨é¢˜åº“</p><div style="display: flex; gap: 0.5rem; justify-content: center; flex-wrap: wrap;"><a href="{% url 'knowledge_app:received_shares' %}" class="quiz-btn quiz-btn-primary"><span>ğŸ“¥</span><span>æ”¶åˆ°çš„åˆ†äº«</span></a><a href="{% url 'knowledge_app:public_libraries' %}" class="quiz-btn quiz-btn-success"><span>ğŸŒ</span><span>å…¬å¼€é¢˜åº“</span></a></div></div></div></div></div><!-- æˆ‘çš„é¢˜åº“ -->
{% if libraries %}
<div class="quiz-card"><div class="quiz-card-body"><div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1.5rem;"><h2 style="margin: 0; color: black !important;">ğŸ“š æˆ‘çš„é¢˜åº“</h2><a href="{% url 'knowledge_app:quiz_library_list' %}" class="quiz-btn quiz-btn-outline">æŸ¥çœ‹å…¨éƒ¨</a></div><div class="quiz-grid quiz-grid-3">
            {% for library in libraries|slice:":6" %}
            <div class="quiz-stat-card" style="text-align: left; cursor: pointer;" onclick="window.location.href='{% url 'knowledge_app:quiz_library_detail' library.id %}'"><div style="display: flex; justify-content: space-between; align-items: start; margin-bottom: 1rem;"><h3 style="margin: 0; color: black !important; font-size: 1.1rem;">{{ library.name }}</h3><span class="quiz-tag quiz-tag-primary">{{ library.total_questions }}é¢˜</span></div><p style="color: black !important; font-size: 0.9rem; margin-bottom: 1rem; line-height: 1.4;">
                    {{ library.description|truncatechars:60 }}
                </p><div style="display: flex; gap: 0.5rem;"><a href="{% url 'knowledge_app:quiz_start' library.id %}" class="quiz-btn quiz-btn-success" style="font-size: 0.8rem; padding: 0.5rem 1rem; color: white;" onclick="event.stopPropagation();"><span>ğŸ¯</span><span>å¼€å§‹ç»ƒä¹ </span></a></div></div>
            {% endfor %}
        </div></div></div>
{% else %}
<!-- ç©ºçŠ¶æ€ --><div class="quiz-card"><div class="quiz-card-body" style="text-align: center; padding: 4rem 2rem;"><div style="font-size: 6rem; margin-bottom: 2rem; opacity: 0.5;">ğŸ“š</div><h2 style="color: black !important; margin-bottom: 1rem;">è¿˜æ²¡æœ‰é¢˜åº“</h2><p style="color: black !important; margin-bottom: 2rem;">åˆ›å»ºä½ çš„ç¬¬ä¸€ä¸ªé¢˜åº“ï¼Œå¼€å§‹å­¦ä¹ ä¹‹æ—…å§ï¼</p><a href="{% url 'knowledge_app:quiz_create_library' %}" class="quiz-btn quiz-btn-primary"><span>â•</span><span>åˆ›å»ºç¬¬ä¸€ä¸ªé¢˜åº“</span></a></div></div>
{% endif %}

<!-- æœ€è¿‘ç»ƒä¹  -->
{% if recent_sessions %}
<div class="quiz-card"><div class="quiz-card-body"><h2 style="margin-bottom: 1.5rem; color: black !important;">ğŸ“ˆ æœ€è¿‘ç»ƒä¹ </h2><div style="display: flex; flex-direction: column; gap: 1rem;">
            {% for session in recent_sessions %}
            <div style="display: flex; justify-content: space-between; align-items: center; padding: 1rem; background: var(--quiz-gray-50); border-radius: var(--quiz-radius); border-left: 4px solid var(--quiz-primary);"><div><h4 style="margin: 0 0 0.5rem 0; color: var(--quiz-gray-800);">{{ session.session_name }}</h4><div style="display: flex; gap: 1rem; align-items: center;"><span class="quiz-tag">{{ session.answered_questions }}/{{ session.total_questions }}é¢˜</span><span class="quiz-tag quiz-tag-success">{{ session.accuracy_rate }}%</span><span style="color: var(--quiz-gray-500); font-size: 0.9rem;">{{ session.started_at|date:"m-d H:i" }}</span></div></div><div>
                    {% if session.status == 'completed' %}
                    <a href="{% url 'knowledge_app:quiz_result' session.id %}" class="quiz-btn quiz-btn-outline" style="font-size: 0.8rem; padding: 0.5rem 1rem;">æŸ¥çœ‹ç»“æœ</a>
                    {% elif session.status == 'in_progress' %}
                    <a href="{% url 'knowledge_app:quiz_session' session.id %}" class="quiz-btn quiz-btn-warning" style="font-size: 0.8rem; padding: 0.5rem 1rem;">ç»§ç»­ç»ƒä¹ </a>
                    {% endif %}
                </div></div>
            {% endfor %}
        </div></div></div>
{% endif %}

<!-- åº•éƒ¨å¯¼èˆª --><div style="text-align: center; margin-top: 2rem;"><div style="display: flex; gap: 1rem; justify-content: center; flex-wrap: wrap;"><a href="{% url 'knowledge_app:quiz_statistics' %}" class="quiz-btn quiz-btn-outline"><span>ğŸ“Š</span><span>å­¦ä¹ ç»Ÿè®¡</span></a><a href="{% url 'knowledge_app:quiz_wrong_answers' %}" class="quiz-btn quiz-btn-outline"><span>âŒ</span><span>é”™é¢˜æœ¬</span></a><a href="{% url 'knowledge_app:index' %}" class="quiz-btn quiz-btn-outline"><span>ğŸ </span><span>è¿”å›é¦–é¡µ</span></a></div></div>
{% endblock %}
