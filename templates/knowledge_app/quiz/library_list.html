{% extends 'knowledge_app/quiz/base_quiz.html' %}

{% block title %}é¢˜åº“åˆ—è¡¨ - {{ block.super }}{% endblock %}

{% block quiz_breadcrumb %}
<div class="quiz-breadcrumb"><a href="{% url 'knowledge_app:quiz_dashboard' %}">ğŸ  ä¸ªäººé¢˜åº“</a><span class="quiz-breadcrumb-separator">></span><span>ğŸ“š é¢˜åº“åˆ—è¡¨</span></div>
{% endblock %}

{% block quiz_content %}
<!-- é¡µé¢å¤´éƒ¨ --><div class="quiz-card"><div class="quiz-card-header"><h1 class="quiz-card-title">ğŸ“š æˆ‘çš„é¢˜åº“</h1><p class="quiz-card-subtitle">ç®¡ç†ä½ çš„ä¸ªäººé¢˜åº“</p></div><div class="quiz-card-body"><!-- æœç´¢å’Œæ“ä½œæ  --><div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 2rem; flex-wrap: wrap; gap: 1rem;"><form method="get" style="display: flex; gap: 1rem; align-items: center;"><input type="text" name="search" value="{{ search }}" placeholder="æœç´¢é¢˜åº“..." 
                       class="quiz-form-control" style="width: 300px;"><button type="submit" class="quiz-btn quiz-btn-primary">ğŸ” æœç´¢</button>
                {% if search %}
                <a href="{% url 'knowledge_app:quiz_library_list' %}" class="quiz-btn quiz-btn-outline">æ¸…é™¤</a>
                {% endif %}
            </form><a href="{% url 'knowledge_app:quiz_create_library' %}" class="quiz-btn quiz-btn-success"><span>â•</span><span>åˆ›å»ºé¢˜åº“</span></a></div><!-- é¢˜åº“ç½‘æ ¼ -->
        {% if page_obj %}
        <div class="quiz-grid quiz-grid-3">
            {% for library in page_obj %}
            <div class="quiz-card" style="margin-bottom: 0; cursor: pointer;" onclick="window.location.href='{% url 'knowledge_app:quiz_library_detail' library.id %}'"><div style="padding: 1.5rem;"><div style="display: flex; justify-content: space-between; align-items: start; margin-bottom: 1rem;"><h3 style="margin: 0; color: black !important; font-size: 1.2rem;">{{ library.name }}</h3><span class="quiz-tag quiz-tag-primary">{{ library.total_questions }}é¢˜</span></div><p style="color: black !important; margin-bottom: 1.5rem; line-height: 1.5;">
                        {{ library.description|truncatechars:100|default:"æš‚æ— æè¿°" }}
                    </p><div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem;"><div style="display: flex; gap: 0.5rem;"><span class="quiz-tag">{{ library.created_at|date:"m-d" }}</span>
                            {% if library.is_active %}
                            <span class="quiz-tag quiz-tag-success">å¯ç”¨</span>
                            {% else %}
                            <span class="quiz-tag quiz-tag-warning">ç¦ç”¨</span>
                            {% endif %}
                        </div></div><div style="display: flex; gap: 0.5rem; flex-wrap: wrap;"><a href="{% url 'knowledge_app:quiz_start' library.id %}"
                           class="quiz-btn quiz-btn-success"
                           style="font-size: 0.8rem; padding: 0.5rem 1rem; flex: 1; color: white;"
                           onclick="event.stopPropagation();"><span>ğŸ¯</span><span>å¼€å§‹ç»ƒä¹ </span></a><a href="{% url 'knowledge_app:quiz_library_detail' library.id %}"
                           class="quiz-btn quiz-btn-outline"
                           style="font-size: 0.8rem; padding: 0.5rem 1rem; color: var(--quiz-primary);"
                           onclick="event.stopPropagation();"><span>ğŸ“‹</span><span>ç®¡ç†</span></a><a href="{% url 'knowledge_app:quiz_export_library_pdf' library.id %}"
                           class="quiz-btn quiz-btn-warning"
                           style="font-size: 0.8rem; padding: 0.5rem 1rem; color: white;"
                           onclick="event.stopPropagation();" target="_blank"><span>ğŸ“„</span><span>PDF</span></a></div></div></div>
            {% endfor %}
        </div><!-- åˆ†é¡µ -->
        {% if page_obj.has_other_pages %}
        <div style="display: flex; justify-content: center; margin-top: 2rem;"><div style="display: flex; gap: 0.5rem; align-items: center;">
                {% if page_obj.has_previous %}
                <a href="?page=1{% if search %}&search={{ search }}{% endif %}" class="quiz-btn quiz-btn-outline">é¦–é¡µ</a><a href="?page={{ page_obj.previous_page_number }}{% if search %}&search={{ search }}{% endif %}" class="quiz-btn quiz-btn-outline">ä¸Šä¸€é¡µ</a>
                {% endif %}
                
                <span style="padding: 0.75rem 1rem; color: var(--quiz-gray-600);">
                    ç¬¬ {{ page_obj.number }} é¡µï¼Œå…± {{ page_obj.paginator.num_pages }} é¡µ
                </span>
                
                {% if page_obj.has_next %}
                <a href="?page={{ page_obj.next_page_number }}{% if search %}&search={{ search }}{% endif %}" class="quiz-btn quiz-btn-outline">ä¸‹ä¸€é¡µ</a><a href="?page={{ page_obj.paginator.num_pages }}{% if search %}&search={{ search }}{% endif %}" class="quiz-btn quiz-btn-outline">æœ«é¡µ</a>
                {% endif %}
            </div></div>
        {% endif %}

        {% else %}
        <!-- ç©ºçŠ¶æ€ --><div style="text-align: center; padding: 4rem 2rem;">
            {% if search %}
            <div style="font-size: 4rem; margin-bottom: 2rem; opacity: 0.5;">ğŸ”</div><h2 style="color: var(--quiz-gray-600); margin-bottom: 1rem;">æ²¡æœ‰æ‰¾åˆ°ç›¸å…³é¢˜åº“</h2><p style="color: var(--quiz-gray-500); margin-bottom: 2rem;">å°è¯•ä½¿ç”¨å…¶ä»–å…³é”®è¯æœç´¢</p><a href="{% url 'knowledge_app:quiz_library_list' %}" class="quiz-btn quiz-btn-outline">æŸ¥çœ‹å…¨éƒ¨é¢˜åº“</a>
            {% else %}
            <div style="font-size: 4rem; margin-bottom: 2rem; opacity: 0.5;">ğŸ“š</div><h2 style="color: var(--quiz-gray-600); margin-bottom: 1rem;">è¿˜æ²¡æœ‰é¢˜åº“</h2><p style="color: var(--quiz-gray-500); margin-bottom: 2rem;">åˆ›å»ºä½ çš„ç¬¬ä¸€ä¸ªé¢˜åº“ï¼Œå¼€å§‹å­¦ä¹ ä¹‹æ—…å§ï¼</p><a href="{% url 'knowledge_app:quiz_create_library' %}" class="quiz-btn quiz-btn-primary"><span>â•</span><span>åˆ›å»ºç¬¬ä¸€ä¸ªé¢˜åº“</span></a>
            {% endif %}
        </div>
        {% endif %}
    </div></div><!-- ç»Ÿè®¡ä¿¡æ¯ -->
{% if page_obj %}
<div class="quiz-card"><div class="quiz-card-body"><h2 style="margin-bottom: 1.5rem; color: var(--quiz-gray-800);">ğŸ“Š ç»Ÿè®¡ä¿¡æ¯</h2><div class="quiz-grid quiz-grid-4"><div class="quiz-stat-card"><span class="quiz-stat-icon">ğŸ“š</span><div class="quiz-stat-value">{{ page_obj.paginator.count }}</div><div class="quiz-stat-label">æ€»é¢˜åº“æ•°</div></div><div class="quiz-stat-card"><span class="quiz-stat-icon">ğŸ“</span><div class="quiz-stat-value">
                    {% for library in page_obj %}{{ library.total_questions }}{% if not forloop.last %}+{% endif %}{% endfor %}
                </div><div class="quiz-stat-label">æ€»é¢˜ç›®æ•°</div></div><div class="quiz-stat-card"><span class="quiz-stat-icon">âœ…</span><div class="quiz-stat-value">
                    {{ page_obj|length|add:0 }}
                </div><div class="quiz-stat-label">å¯ç”¨é¢˜åº“</div></div><div class="quiz-stat-card"><span class="quiz-stat-icon">ğŸ“…</span><div class="quiz-stat-value">ä»Šæ—¥</div><div class="quiz-stat-label">æœ€è¿‘æ›´æ–°</div></div></div></div></div>
{% endif %}

<!-- å¿«é€Ÿæ“ä½œ --><div style="text-align: center; margin-top: 2rem;"><div style="display: flex; gap: 1rem; justify-content: center; flex-wrap: wrap;"><a href="{% url 'knowledge_app:quiz_dashboard' %}" class="quiz-btn quiz-btn-outline"><span>ğŸ </span><span>è¿”å›ä»ªè¡¨æ¿</span></a><a href="{% url 'knowledge_app:quiz_create_library' %}" class="quiz-btn quiz-btn-primary"><span>â•</span><span>åˆ›å»ºé¢˜åº“</span></a><a href="{% url 'knowledge_app:quiz_wrong_answers' %}" class="quiz-btn quiz-btn-warning"><span>âŒ</span><span>é”™é¢˜æœ¬</span></a></div></div>
{% endblock %}
