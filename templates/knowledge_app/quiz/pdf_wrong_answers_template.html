<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>{{ user.username }} - é”™é¢˜é›†</title><style>@page {size:A4;margin:2cm}body {font-family:"Microsoft YaHei", "SimHei", "é»‘ä½“", sans-serif;font-size:12pt;line-height:1.6;color:#000;background:#fff}.header {text-align:center;margin-bottom:30px;border-bottom:2px solid #d32f2f;padding-bottom:20px}.title {font-size:24pt;font-weight:bold;margin-bottom:10px;color:#d32f2f}.info-table {width:100%;border-collapse:collapse;margin-bottom:30px}.info-table td {padding:8px;border:1px solid #333;vertical-align:top}.info-table .label {background-color:#ffebee;font-weight:bold;width:25%;text-align:right}.wrong-question {margin-bottom:25px;page-break-inside:avoid;border:2px solid #ffcdd2;padding:15px;border-radius:5px;background-color:#fafafa}.question-title {font-size:14pt;font-weight:bold;margin-bottom:10px;color:#000}.question-content {margin-bottom:15px;line-height:1.8}.options {margin-left:20px;margin-bottom:15px}.option {margin-bottom:5px;line-height:1.5}.answer-comparison {display:grid;grid-template-columns:1fr 1fr;gap:15px;margin-bottom:15px}.wrong-answer {background-color:#ffebee;border:1px solid #f44336;padding:10px;border-radius:5px}.wrong-answer .label {color:#d32f2f;font-weight:bold;margin-bottom:5px}.correct-answer {background-color:#e8f5e8;border:1px solid #4caf50;padding:10px;border-radius:5px}.correct-answer .label {color:#2e7d32;font-weight:bold;margin-bottom:5px}.error-info {background-color:#fff3e0;padding:8px;border-radius:3px;font-size:10pt;color:#e65100;margin-bottom:10px}.explanation {background-color:#e3f2fd;padding:10px;border-left:4px solid #2196f3;margin-bottom:10px;font-size:11pt;line-height:1.6}.ai-analysis {background-color:#f3e5f5;padding:10px;border-left:4px solid #9c27b0;margin-bottom:10px;font-size:11pt;line-height:1.6}.study-suggestion {background-color:#e8f5e8;padding:10px;border-left:4px solid #4caf50;margin-bottom:10px;font-size:11pt;line-height:1.6}.separator {border-bottom:1px solid #ccc;margin:20px 0}.tags {margin-top:10px;font-size:10pt;color:#666}.tag {background-color:#e0e0e0;padding:2px 6px;border-radius:3px;margin-right:5px}</style></head><body><div class="header"><div class="title">{{ user.username }} - é”™é¢˜é›†</div><div>ç”Ÿæˆæ—¶é—´ï¼š{{ generated_time|date:"Y-m-d H:i:s" }}</div></div><table class="info-table"><tr><td class="label">ç”¨æˆ·åï¼š</td><td>{{ user.username }}</td></tr><tr><td class="label">é”™é¢˜æ•°é‡ï¼š</td><td>{{ total_wrong_answers }} é“</td></tr><tr><td class="label">ç”Ÿæˆæ—¶é—´ï¼š</td><td>{{ generated_time|date:"Y-m-d H:i:s" }}</td></tr></table>

    {% for wrong_answer in wrong_answers %}
    <div class="wrong-question"><div class="question-title">{{ forloop.counter }}. {{ wrong_answer.question.title }}</div><div class="question-content">{{ wrong_answer.question.content }}</div>
        
        {% if wrong_answer.question.question_image %}
        <div style="margin: 10px 0;"><img src="{{ wrong_answer.question.question_image.url }}" style="max-width: 400px; max-height: 300px;" alt="é¢˜ç›®å›¾ç‰‡"></div>
        {% endif %}
        
        {% if wrong_answer.question.question_type in 'single_choice,multiple_choice' %}
        <div class="options">
            {% for key, value in wrong_answer.question.options.items %}
            <div class="option"><strong>{{ key }}.</strong> {{ value }}
                {% if wrong_answer.question.option_images and key in wrong_answer.question.option_images %}
                <br><img src="{{ wrong_answer.question.option_images.key }}" style="max-width: 200px; max-height: 150px; margin-left: 20px;" alt="é€‰é¡¹å›¾ç‰‡">
                {% endif %}
            </div>
            {% endfor %}
        </div>
        {% endif %}
        
        <div class="answer-comparison"><div class="wrong-answer"><div class="label">âŒ ä½ çš„ç­”æ¡ˆï¼š</div><div>{{ wrong_answer.wrong_answer }}</div></div><div class="correct-answer"><div class="label">âœ… æ­£ç¡®ç­”æ¡ˆï¼š</div><div>{{ wrong_answer.correct_answer }}</div></div></div><div class="error-info"><strong>é”™è¯¯æ¬¡æ•°ï¼š</strong>{{ wrong_answer.wrong_count }} æ¬¡ | 
            <strong>æœ€è¿‘é”™è¯¯ï¼š</strong>{{ wrong_answer.last_wrong_at|date:"Y-m-d H:i" }}
        </div>
        
        {% if wrong_answer.question.explanation %}
        <div class="explanation"><strong>ğŸ’¡ ç­”æ¡ˆè§£æï¼š</strong>{{ wrong_answer.question.explanation }}
        </div>
        {% endif %}
        
        {% if wrong_answer.ai_analysis %}
        <div class="ai-analysis"><strong>ğŸ¤– AIåˆ†æï¼š</strong>{{ wrong_answer.ai_analysis }}
        </div>
        {% endif %}
        
        {% if wrong_answer.study_suggestion %}
        <div class="study-suggestion"><strong>ğŸ“š å­¦ä¹ å»ºè®®ï¼š</strong>{{ wrong_answer.study_suggestion }}
        </div>
        {% endif %}
        
        {% if wrong_answer.question.tags.all %}
        <div class="tags"><strong>æ ‡ç­¾ï¼š</strong>
            {% for tag in wrong_answer.question.tags.all %}
            <span class="tag">{{ tag.name }}</span>
            {% endfor %}
        </div>
        {% endif %}
    </div>
    
    {% if not forloop.last %}
    <div class="separator"></div>
    {% endif %}
    {% endfor %}

    <div style="text-align: center; margin-top: 30px; font-size: 10pt; color: #666;">
        â€” é”™é¢˜é›†å¯¼å‡ºå®Œæˆ â€”<br>
        å…± {{ total_wrong_answers }} é“é”™é¢˜ï¼Œè¯·é‡ç‚¹å¤ä¹ 
    </div></body></html>
