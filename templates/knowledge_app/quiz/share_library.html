{% extends 'knowledge_app/quiz/base_quiz.html' %}

{% block title %}分享题库 - {{ library.name }}{% endblock %}

{% block content %}
<div class="quiz-container"><!-- 面包屑导航 --><div class="quiz-breadcrumb"><a href="{% url 'knowledge_app:quiz_dashboard' %}">个人题库</a><span class="quiz-breadcrumb-separator">></span><a href="{% url 'knowledge_app:quiz_library_detail' library.id %}">{{ library.name }}</a><span class="quiz-breadcrumb-separator">></span><span>分享题库</span></div><div class="quiz-card"><div style="text-align: center; margin-bottom: 2rem;"><h1 style="color: black !important; margin-bottom: 0.5rem;">📤 分享题库</h1><p style="color: black !important;">将你的题库分享给其他用户</p></div><!-- 题库信息 --><div style="background: var(--quiz-gray-50); padding: 1.5rem; border-radius: var(--quiz-radius-lg); margin-bottom: 2rem; border-left: 4px solid var(--quiz-primary);"><h3 style="color: black !important; margin: 0 0 0.5rem 0;">{{ library.name }}</h3><p style="color: black !important; margin: 0 0 1rem 0;">{{ library.description|default:"暂无描述" }}</p><div style="display: flex; gap: 1rem; font-size: 0.9rem; color: black !important;"><span>📊 {{ library.total_questions }} 道题目</span><span>📅 创建于 {{ library.created_at|date:"Y-m-d" }}</span></div></div><!-- 分享表单 --><form method="post" style="max-width: 600px; margin: 0 auto;">
            {% csrf_token %}
            
            <!-- 分享类型 --><div class="quiz-form-group"><label class="quiz-form-label">分享类型</label><div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem;"><label style="display: flex; align-items: center; padding: 1rem; background: white; border: 2px solid var(--quiz-gray-200); border-radius: var(--quiz-radius); cursor: pointer; transition: var(--quiz-transition);" onclick="selectShareType('private')"><input type="radio" name="share_type" value="private" style="margin-right: 0.5rem;" onchange="toggleShareOptions()"><div><div style="font-weight: 600; color: black !important;">👤 私密分享</div><div style="font-size: 0.8rem; color: black !important;">分享给特定用户</div></div></label><label style="display: flex; align-items: center; padding: 1rem; background: white; border: 2px solid var(--quiz-gray-200); border-radius: var(--quiz-radius); cursor: pointer; transition: var(--quiz-transition);" onclick="selectShareType('link')"><input type="radio" name="share_type" value="link" style="margin-right: 0.5rem;" onchange="toggleShareOptions()"><div><div style="font-weight: 600; color: black !important;">🔗 链接分享</div><div style="font-size: 0.8rem; color: black !important;">生成分享链接</div></div></label><label style="display: flex; align-items: center; padding: 1rem; background: white; border: 2px solid var(--quiz-gray-200); border-radius: var(--quiz-radius); cursor: pointer; transition: var(--quiz-transition);" onclick="selectShareType('public')"><input type="radio" name="share_type" value="public" style="margin-right: 0.5rem;" onchange="toggleShareOptions()"><div><div style="font-weight: 600; color: black !important;">🌍 公开分享</div><div style="font-size: 0.8rem; color: black !important;">所有人可见</div></div></label></div></div><!-- 私密分享选项 --><div id="privateOptions" style="display: none;"><div class="quiz-form-group"><label for="shared_to_username" class="quiz-form-label">分享给用户</label><input type="text" id="shared_to_username" name="shared_to_username" class="quiz-form-control" placeholder="输入用户名" list="userList"><datalist id="userList">
                        {% for user in users %}
                        <option value="{{ user.username }}">{{ user.username }}</option>
                        {% endfor %}
                    </datalist></div></div><!-- 权限设置 --><div class="quiz-form-group"><label class="quiz-form-label">访问权限</label><div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 1rem;"><label style="display: flex; align-items: center; padding: 0.75rem; background: white; border: 2px solid var(--quiz-gray-200); border-radius: var(--quiz-radius); cursor: pointer;"><input type="radio" name="permission" value="view" checked style="margin-right: 0.5rem;"><div><div style="font-weight: 600; color: black !important;">👀 仅查看</div><div style="font-size: 0.8rem; color: black !important;">只能查看题目</div></div></label><label style="display: flex; align-items: center; padding: 0.75rem; background: white; border: 2px solid var(--quiz-gray-200); border-radius: var(--quiz-radius); cursor: pointer;"><input type="radio" name="permission" value="copy" style="margin-right: 0.5rem;"><div><div style="font-weight: 600; color: black !important;">📋 可复制</div><div style="font-size: 0.8rem; color: black !important;">可以复制题库</div></div></label></div></div><!-- 分享留言 --><div class="quiz-form-group"><label for="message" class="quiz-form-label">分享留言（可选）</label><textarea id="message" name="message" class="quiz-form-control" rows="3" placeholder="写点什么给接收者..."></textarea></div><!-- 过期时间 --><div class="quiz-form-group"><label for="expires_days" class="quiz-form-label">有效期（可选）</label><select id="expires_days" name="expires_days" class="quiz-form-control"><option value="">永不过期</option><option value="1">1天</option><option value="7">7天</option><option value="30">30天</option><option value="90">90天</option></select></div><!-- 提交按钮 --><div style="text-align: center; margin-top: 2rem;"><button type="submit" class="quiz-btn quiz-btn-primary"><span>📤</span><span>创建分享</span></button><a href="{% url 'knowledge_app:quiz_library_detail' library.id %}" class="quiz-btn quiz-btn-outline" style="margin-left: 1rem;"><span>↩️</span><span>返回</span></a></div></form></div></div><script>function selectShareType(type) { document.querySelectorAll('input[name="share_type"]').forEach(radio => { const label = radio.closest('label'); if (radio.value === type) { radio.checked = true; label.style.borderColor = 'var(--quiz-primary)'; label.style.background = 'rgba(99, 102, 241, 0.1)'; } else { radio.checked = false; label.style.borderColor = 'var(--quiz-gray-200)'; label.style.background = 'white'; } }); toggleShareOptions(); } function toggleShareOptions() { const shareType = document.querySelector('input[name="share_type"]:checked')?.value; const privateOptions = document.getElementById('privateOptions'); if (shareType === 'private') { privateOptions.style.display = 'block'; } else { privateOptions.style.display = 'none'; } } document.querySelectorAll('input[name="permission"]').forEach(radio => { radio.addEventListener('change', function() { document.querySelectorAll('input[name="permission"]').forEach(r => { const label = r.closest('label'); if (r.checked) { label.style.borderColor = 'var(--quiz-primary)'; label.style.background = 'rgba(99, 102, 241, 0.1)'; } else { label.style.borderColor = 'var(--quiz-gray-200)'; label.style.background = 'white'; } }); }); }); document.addEventListener('DOMContentLoaded', function() { const checkedPermission = document.querySelector('input[name="permission"]:checked'); if (checkedPermission) { const label = checkedPermission.closest('label'); label.style.borderColor = 'var(--quiz-primary)'; label.style.background = 'rgba(99, 102, 241, 0.1)'; } });</script>
{% endblock %}
