{% extends 'knowledge_app/quiz/base_quiz.html' %}

{% block title %}开始练习 - {{ library.name }} - {{ block.super }}{% endblock %}

{% block quiz_breadcrumb %}
<div class="quiz-breadcrumb"><a href="{% url 'knowledge_app:quiz_dashboard' %}">🏠 个人题库</a><span class="quiz-breadcrumb-separator">></span><a href="{% url 'knowledge_app:quiz_library_list' %}">📚 题库列表</a><span class="quiz-breadcrumb-separator">></span><a href="{% url 'knowledge_app:quiz_library_detail' library.id %}">{{ library.name }}</a><span class="quiz-breadcrumb-separator">></span><span>🎯 开始练习</span></div>
{% endblock %}

{% block quiz_content %}
<div class="quiz-card"><div class="quiz-card-header"><h1 class="quiz-card-title">🎯 开始练习</h1><p class="quiz-card-subtitle">{{ library.name }}</p></div><div class="quiz-card-body"><form method="post" style="max-width: 600px; margin: 0 auto;">
            {% csrf_token %}
            
            <!-- 练习名称 --><div class="quiz-form-group"><label for="session_name" class="quiz-form-label"><span>📝</span><span>练习名称</span></label><input type="text" 
                       id="session_name" 
                       name="session_name" 
                       class="quiz-form-control" 
                       value="{{ library.name }} - 练习"
                       placeholder="为这次练习起个名字..."><div style="font-size: 0.9rem; color: var(--quiz-gray-500); margin-top: 0.5rem;">
                    方便后续查看练习记录
                </div></div><!-- 题目数量 --><div class="quiz-form-group"><label for="question_count" class="quiz-form-label"><span>🔢</span><span>题目数量</span></label><select id="question_count" name="question_count" class="quiz-form-control"><option value="5">5题 - 快速练习</option><option value="10" selected>10题 - 标准练习</option><option value="20">20题 - 深度练习</option><option value="50">50题 - 全面练习</option><option value="0">全部题目</option></select><div style="font-size: 0.9rem; color: var(--quiz-gray-500); margin-top: 0.5rem;">
                    系统会随机选择题目进行练习
                </div></div><!-- 题目类型筛选 --><div class="quiz-form-group"><label for="question_type" class="quiz-form-label"><span>🎯</span><span>题目类型</span></label><select id="question_type" name="question_type" class="quiz-form-control"><option value="">所有类型</option><option value="single_choice">🔘 单选题</option><option value="multiple_choice">☑️ 多选题</option><option value="fill_blank">📝 填空题</option><option value="short_answer">💬 简答题</option></select></div><!-- 难度筛选 --><div class="quiz-form-group"><label for="difficulty" class="quiz-form-label"><span>⭐</span><span>难度等级</span></label><select id="difficulty" name="difficulty" class="quiz-form-control"><option value="">所有难度</option><option value="1">🟢 简单</option><option value="2">🟡 中等</option><option value="3">🔴 困难</option></select></div><!-- 练习模式说明 --><div style="background: linear-gradient(135deg, rgba(99, 102, 241, 0.1), rgba(139, 92, 246, 0.1)); border: 1px solid rgba(99, 102, 241, 0.2); border-radius: var(--quiz-radius-lg); padding: 1.5rem; margin-bottom: 2rem;"><h3 style="color: var(--quiz-primary); margin-bottom: 1rem; display: flex; align-items: center; gap: 0.5rem;"><span>💡</span><span>练习说明</span></h3><ul style="color: var(--quiz-gray-600); margin: 0; padding-left: 1.5rem; line-height: 1.6;"><li>题目将随机打乱顺序，避免记忆答案位置</li><li>答错的题目会自动加入错题本</li><li>练习完成后可查看详细的结果分析</li><li>支持AI智能分析错题原因和学习建议</li></ul></div><!-- 开始按钮 --><div style="text-align: center;"><button type="submit" class="quiz-btn quiz-btn-success" style="font-size: 1.1rem; padding: 1rem 2rem; color: white;"><span>🚀</span><span>开始练习</span></button></div></form></div></div><!-- 题库信息 --><div class="quiz-card"><div class="quiz-card-body"><h2 style="margin-bottom: 1.5rem; color: var(--quiz-gray-800); text-align: center;">📊 题库信息</h2><div class="quiz-grid quiz-grid-4"><div class="quiz-stat-card"><span class="quiz-stat-icon">📝</span><div class="quiz-stat-value">{{ library.total_questions }}</div><div class="quiz-stat-label">总题目数</div></div><div class="quiz-stat-card"><span class="quiz-stat-icon">🔘</span><div class="quiz-stat-value" id="single_choice_count">-</div><div class="quiz-stat-label">单选题</div></div><div class="quiz-stat-card"><span class="quiz-stat-icon">☑️</span><div class="quiz-stat-value" id="multiple_choice_count">-</div><div class="quiz-stat-label">多选题</div></div><div class="quiz-stat-card"><span class="quiz-stat-icon">📝</span><div class="quiz-stat-value" id="other_count">-</div><div class="quiz-stat-label">其他题型</div></div></div></div></div><!-- 练习技巧 --><div class="quiz-card"><div class="quiz-card-body"><h2 style="margin-bottom: 1.5rem; color: var(--quiz-gray-800); text-align: center;">🎯 练习技巧</h2><div class="quiz-grid quiz-grid-2"><div style="padding: 1.5rem; border: 1px solid var(--quiz-gray-200); border-radius: var(--quiz-radius-lg); text-align: center;"><div style="font-size: 3rem; margin-bottom: 1rem;">🧠</div><h3 style="color: var(--quiz-gray-800); margin-bottom: 1rem;">专注思考</h3><p style="color: var(--quiz-gray-600); line-height: 1.5;">
                    仔细阅读题目，理解题意后再作答，避免匆忙选择
                </p></div><div style="padding: 1.5rem; border: 1px solid var(--quiz-gray-200); border-radius: var(--quiz-radius-lg); text-align: center;"><div style="font-size: 3rem; margin-bottom: 1rem;">📝</div><h3 style="color: var(--quiz-gray-800); margin-bottom: 1rem;">记录思路</h3><p style="color: var(--quiz-gray-600); line-height: 1.5;">
                    对于复杂题目，可以在草稿纸上记录解题思路
                </p></div><div style="padding: 1.5rem; border: 1px solid var(--quiz-gray-200); border-radius: var(--quiz-radius-lg); text-align: center;"><div style="font-size: 3rem; margin-bottom: 1rem;">❌</div><h3 style="color: var(--quiz-gray-800); margin-bottom: 1rem;">重视错题</h3><p style="color: var(--quiz-gray-600); line-height: 1.5;">
                    答错的题目会自动收集，记得后续重点复习
                </p></div><div style="padding: 1.5rem; border: 1px solid var(--quiz-gray-200); border-radius: var(--quiz-radius-lg); text-align: center;"><div style="font-size: 3rem; margin-bottom: 1rem;">🤖</div><h3 style="color: var(--quiz-gray-800); margin-bottom: 1rem;">AI分析</h3><p style="color: var(--quiz-gray-600); line-height: 1.5;">
                    利用AI分析功能，获得个性化的学习建议
                </p></div></div></div></div><!-- 返回按钮 --><div style="text-align: center; margin-top: 2rem;"><a href="{% url 'knowledge_app:quiz_library_detail' library.id %}" class="quiz-btn quiz-btn-outline" style="color: var(--quiz-primary);"><span>↩️</span><span>返回题库</span></a></div><script>document.addEventListener('DOMContentLoaded', function() { updateQuestionStats(); }); function updateQuestionStats() { const totalQuestions = {{ library.total_questions }}; fetch(`/quiz/libraries/{{ library.id }}/stats/`) .then(response => response.json()) .then(data => { document.getElementById('single_choice_count').textContent = data.single_choice || 0; document.getElementById('multiple_choice_count').textContent = data.multiple_choice || 0; document.getElementById('other_count').textContent = data.other || 0; }) .catch(error => { console.log('获取统计数据失败:', error); }); } document.querySelector('form').addEventListener('submit', function(e) { const questionCount = document.getElementById('question_count').value; const totalQuestions = {{ library.total_questions }}; if (totalQuestions === 0) { e.preventDefault(); alert('该题库还没有题目，请先添加题目后再开始练习。'); return; } if (questionCount > totalQuestions && questionCount !== '0') { e.preventDefault(); alert(`题库只有 ${totalQuestions} 道题目，请选择合适的数量。`); return; } });</script>
{% endblock %}
