{% extends 'knowledge_app/base.html' %}

{% block title %}æ ˆâ€”â€”è¡¨è¾¾å¼æ±‚å€¼ - è®¡ç®—æœºç§‘å­¦å­¦ä¹ å¹³å°{% endblock %}

{% block content %}
<div class="page-container fade-in"><!-- é¢åŒ…å±‘å¯¼èˆª --><div class="breadcrumb"><a href="{% url 'knowledge_app:index' %}">é¦–é¡µ</a><span>></span><span>æ•°æ®ç»“æ„</span><span>></span><span>æ ˆâ€”â€”è¡¨è¾¾å¼æ±‚å€¼</span></div><!-- é¡µé¢å¤´éƒ¨ --><div class="page-header slide-in-left"><h1><span class="page-icon">ğŸ§®</span>
            æ ˆâ€”â€”è¡¨è¾¾å¼æ±‚å€¼
        </h1><p>å­¦ä¹ ä½¿ç”¨æ ˆè§£æå’Œè®¡ç®—æ•°å­¦è¡¨è¾¾å¼ï¼ŒæŒæ¡è¿ç®—ç¬¦ä¼˜å…ˆçº§å¤„ç†</p></div><!-- ğŸ“‹ çŸ¥è¯†ç‚¹æ¦‚è¿° --><div class="content-card slide-in-right"><div class="content-section"><h2 class="section-title"><span class="section-icon">ğŸ“‹</span>
                çŸ¥è¯†ç‚¹æ¦‚è¿°
            </h2><div class="info-box info-box-info"><span class="info-icon">ğŸ¯</span><strong>æ ¸å¿ƒæ¦‚å¿µï¼š</strong>åˆ©ç”¨æ ˆå¤„ç†è¿ç®—ç¬¦ä¼˜å…ˆçº§å’Œç»“åˆæ€§ï¼Œå°†ä¸­ç¼€è¡¨è¾¾å¼è½¬æ¢ä¸ºåç¼€è¡¨è¾¾å¼å¹¶æ±‚å€¼ï¼Œæˆ–ç›´æ¥å¯¹ä¸­ç¼€è¡¨è¾¾å¼è¿›è¡Œè®¡ç®—ã€‚
            </div><div class="unified-grid unified-grid-2"><div class="grid-card"><span class="card-icon">ğŸ“š</span><h4 class="card-title">å…³é”®æœ¯è¯­</h4><ul style="text-align: left; margin: 10px 0;"><li><strong>ä¸­ç¼€è¡¨è¾¾å¼ï¼š</strong>è¿ç®—ç¬¦åœ¨æ“ä½œæ•°ä¸­é—´ï¼Œå¦‚ 3+4*2</li><li><strong>åç¼€è¡¨è¾¾å¼ï¼š</strong>è¿ç®—ç¬¦åœ¨æ“ä½œæ•°åé¢ï¼Œå¦‚ 3 4 2 * +</li><li><strong>è¿ç®—ç¬¦ä¼˜å…ˆçº§ï¼š</strong>* / ä¼˜å…ˆäº + -</li><li><strong>è°ƒåº¦åœºç®—æ³•ï¼š</strong>ä¸­ç¼€è½¬åç¼€çš„ç»å…¸ç®—æ³•</li><li><strong>æ“ä½œæ•°æ ˆï¼š</strong>å­˜å‚¨æ•°å­—å’Œä¸­é—´ç»“æœ</li><li><strong>è¿ç®—ç¬¦æ ˆï¼š</strong>ä¸´æ—¶å­˜å‚¨è¿ç®—ç¬¦</li></ul></div><div class="grid-card"><span class="card-icon">ğŸ“Š</span><h4 class="card-title">å­¦ä¹ æŒ‡æ ‡</h4><div style="text-align: left;"><p><strong>éš¾åº¦ç­‰çº§ï¼š</strong><span style="color: #ffc107;">è¿›é˜¶çº§</span></p><p><strong>å‰ç½®çŸ¥è¯†ï¼š</strong></p><ul style="margin: 5px 0;"><li>æ ˆçš„åŸºæœ¬æ“ä½œ</li><li>è¿ç®—ç¬¦ä¼˜å…ˆçº§æ¦‚å¿µ</li><li>å­—ç¬¦ä¸²å¤„ç†å’Œè§£æ</li><li>åŸºæœ¬æ•°å­¦è¿ç®—</li></ul></div></div></div></div></div><!-- ğŸ” æ¦‚å¿µè¯¦è§£ --><div class="content-card"><div class="content-section"><h2 class="section-title"><span class="section-icon">ğŸ”</span>
                æ¦‚å¿µè¯¦è§£
            </h2><div class="unified-grid unified-grid-2"><div class="info-box info-box-success"><span class="info-icon">ğŸ¥</span><strong>åŒæ ˆç­–ç•¥ï¼š</strong>å°±åƒå¨å¸ˆç”¨ä¸¤ä¸ªç›˜å­ï¼Œä¸€ä¸ªæ”¾é£Ÿæï¼ˆæ•°å­—ï¼‰ï¼Œä¸€ä¸ªæ”¾è°ƒæ–™ï¼ˆè¿ç®—ç¬¦ï¼‰ï¼ŒæŒ‰é¡ºåºæ­é…åˆ¶ä½œã€‚
                </div><div class="info-box info-box-warning"><span class="info-icon">âš–ï¸</span><strong>ä¼˜å…ˆçº§å¤„ç†ï¼š</strong>é«˜ä¼˜å…ˆçº§è¿ç®—ç¬¦ä¼˜å…ˆå‡ºæ ˆæ‰§è¡Œï¼Œå°±åƒç´§æ€¥ä»»åŠ¡ä¼˜å…ˆå¤„ç†ä¸€æ ·ã€‚
                </div></div><h3>ğŸ”¹ æ ¸å¿ƒå­æ¦‚å¿µåˆ†è§£</h3><div style="margin: 20px 0;"><h4>1ï¸âƒ£ è¡¨è¾¾å¼ç±»å‹ç†è§£</h4><p>ä¸­ç¼€è¡¨è¾¾å¼æ˜¯äººç±»ä¹ æƒ¯çš„å†™æ³•(å¦‚3+4*2)ï¼Œä½†è®¡ç®—æœºæ›´é€‚åˆå¤„ç†åç¼€è¡¨è¾¾å¼(å¦‚3 4 2 * +)ï¼Œå› ä¸ºåç¼€è¡¨è¾¾å¼æ— éœ€è€ƒè™‘ä¼˜å…ˆçº§ã€‚</p><h4>2ï¸âƒ£ è¿ç®—ç¬¦ä¼˜å…ˆçº§è§„åˆ™</h4><p>ä¹˜é™¤æ³•(* /)ä¼˜å…ˆçº§é«˜äºåŠ å‡æ³•(+ -)ï¼ŒåŒçº§è¿ç®—ç¬¦ä»å·¦åˆ°å³è®¡ç®—ã€‚æ‹¬å·å¯ä»¥æ”¹å˜ä¼˜å…ˆçº§ï¼Œæ‹¬å·å†…çš„è¡¨è¾¾å¼ä¼˜å…ˆè®¡ç®—ã€‚</p><h4>3ï¸âƒ£ åŒæ ˆå·¥ä½œæœºåˆ¶</h4><p>æ“ä½œæ•°æ ˆå­˜å‚¨æ•°å­—ï¼Œè¿ç®—ç¬¦æ ˆå­˜å‚¨å¾…å¤„ç†çš„è¿ç®—ç¬¦ã€‚é‡åˆ°è¿ç®—ç¬¦æ—¶ï¼Œæ ¹æ®ä¼˜å…ˆçº§å†³å®šæ˜¯å…¥æ ˆè¿˜æ˜¯å…ˆå¤„ç†æ ˆä¸­çš„è¿ç®—ç¬¦ã€‚</p><h4>4ï¸âƒ£ è®¡ç®—æ‰§è¡Œè¿‡ç¨‹</h4><p>ä»æ“ä½œæ•°æ ˆå–å‡ºä¸¤ä¸ªæ•°å­—ï¼Œä»è¿ç®—ç¬¦æ ˆå–å‡ºä¸€ä¸ªè¿ç®—ç¬¦ï¼Œæ‰§è¡Œè®¡ç®—åå°†ç»“æœæ”¾å›æ“ä½œæ•°æ ˆï¼Œé‡å¤ç›´åˆ°è¡¨è¾¾å¼å¤„ç†å®Œæ¯•ã€‚</p></div><div class="info-box info-box-warning"><span class="info-icon">âš ï¸</span><strong>æ˜“é”™ç‚¹æé†’ï¼š</strong><ul style="text-align: left; margin: 10px 0;"><li>å¿½è§†è¿ç®—ç¬¦çš„å·¦å³ç»“åˆæ€§ï¼ˆå¦‚å‡æ³•3-2-1åº”è¯¥æ˜¯(3-2)-1=0è€Œä¸æ˜¯3-(2-1)=2ï¼‰</li><li>å¤„ç†è´Ÿæ•°æ—¶çš„ç¬¦å·è¯†åˆ«ï¼ˆ-3+2ä¸­çš„è´Ÿå·vså‡å·ï¼‰</li><li>æ‹¬å·çš„ä¼˜å…ˆçº§å¤„ç†ï¼ˆæ‹¬å·å†…è¡¨è¾¾å¼å¿…é¡»å…ˆè®¡ç®—å®Œæˆï¼‰</li><li>é™¤é›¶é”™è¯¯å’Œæµ®ç‚¹æ•°ç²¾åº¦é—®é¢˜</li></ul></div></div></div><!-- ğŸ“Š å¯è§†åŒ–å±•ç¤º --><div class="content-card"><div class="content-section"><h2 class="section-title"><span class="section-icon">ğŸ“Š</span>
                å¯è§†åŒ–å±•ç¤º
            </h2><div class="demo-container" style="background: #f8f9fa; padding: 20px; border-radius: 8px; margin: 20px 0;"><h3>ğŸ¯ äº¤äº’å¼æ¼”ç¤ºï¼šè¡¨è¾¾å¼æ±‚å€¼è¿‡ç¨‹</h3><!-- è¾“å…¥åŒºåŸŸ --><div style="margin-bottom: 20px;"><label for="expressionInput" style="display: block; margin-bottom: 8px; font-weight: bold;">è¾“å…¥æ•°å­¦è¡¨è¾¾å¼ï¼š</label><div style="display: flex; gap: 10px; align-items: center;"><input type="text" id="expressionInput" placeholder="å¦‚ï¼š3+4*2-1 æˆ– (1+2)*3"
                               style="flex: 1; padding: 10px; border: 2px solid #007bff; border-radius: 5px; font-family: monospace; font-size: 16px;"
                               value="3+4*2-1" onkeyup="handleExpressionInput(event)"><button onclick="startEvaluation()" style="background: #28a745; color: white; border: none; padding: 10px 20px; border-radius: 5px; cursor: pointer;">
                            å¼€å§‹æ±‚å€¼
                        </button></div><div style="margin-top: 8px; font-size: 14px; color: #6c757d;">
                        ğŸ’¡ æ”¯æŒï¼šæ•°å­—ã€+ã€-ã€*ã€/ã€æ‹¬å·()ï¼Œå¦‚ï¼š(1+2)*3-4/2
                    </div></div><div id="evaluationDemo" style="margin: 20px 0;"><!-- å½“å‰è¡¨è¾¾å¼æ˜¾ç¤º --><div style="margin-bottom: 20px;"><h4>å½“å‰è¡¨è¾¾å¼</h4><div id="currentExpression" style="font-family: monospace; font-size: 20px; padding: 15px; background: white; border: 2px solid #007bff; border-radius: 5px; min-height: 50px; text-align: center;">
                            3 + 4 * 2 - 1
                        </div></div><!-- åŒæ ˆæ˜¾ç¤º --><div style="display: flex; justify-content: space-between; margin-bottom: 20px;"><div style="flex: 1; margin-right: 10px;"><h4>æ“ä½œæ•°æ ˆ (å­˜å‚¨æ•°å­—)</h4><div id="numberStack" style="height: 200px; background: white; border: 2px solid #28a745; border-radius: 5px; position: relative; overflow: hidden;"><div style="position: absolute; bottom: 10px; left: 50%; transform: translateX(-50%); color: #6c757d;">æ ˆåº•</div></div></div><div style="flex: 1; margin-left: 10px;"><h4>è¿ç®—ç¬¦æ ˆ (å­˜å‚¨è¿ç®—ç¬¦)</h4><div id="operatorStack" style="height: 200px; background: white; border: 2px solid #ffc107; border-radius: 5px; position: relative; overflow: hidden;"><div style="position: absolute; bottom: 10px; left: 50%; transform: translateX(-50%); color: #6c757d;">æ ˆåº•</div></div></div></div><!-- ç»“æœæ˜¾ç¤º --><div style="margin-bottom: 20px;"><h4>è®¡ç®—ç»“æœ</h4><div id="resultDisplay" style="font-size: 24px; font-weight: bold; padding: 15px; background: white; border: 2px solid #dc3545; border-radius: 5px; text-align: center; color: #dc3545;">
                            ç­‰å¾…è®¡ç®—...
                        </div></div><div style="text-align: center;"><button id="evalStepBtn" onclick="nextEvalStep()" style="background: #007bff; color: white; border: none; padding: 12px 24px; border-radius: 5px; cursor: pointer; margin: 5px;">ä¸‹ä¸€æ­¥</button><button onclick="autoEvaluation()" id="autoEvalBtn" style="background: #ffc107; color: #000; border: none; padding: 12px 24px; border-radius: 5px; cursor: pointer; margin: 5px;">è‡ªåŠ¨æ¼”ç¤º</button><button onclick="resetEvaluation()" style="background: #6c757d; color: white; border: none; padding: 12px 24px; border-radius: 5px; cursor: pointer; margin: 5px;">é‡ç½®</button></div><div id="evalStepInfo" style="margin-top: 15px; padding: 15px; background: #e3f2fd; border-radius: 5px; min-height: 60px;"><strong>å‡†å¤‡å¼€å§‹ï¼š</strong>è¾“å…¥æ•°å­¦è¡¨è¾¾å¼ï¼Œç‚¹å‡»"å¼€å§‹æ±‚å€¼"æŸ¥çœ‹è¯¦ç»†è®¡ç®—è¿‡ç¨‹
                    </div></div></div><div class="unified-grid unified-grid-3"><div class="info-box info-box-info"><span class="info-icon">âœ…</span><strong>æœ‰æ•ˆè¡¨è¾¾å¼ç¤ºä¾‹ï¼š</strong><ul style="text-align: left; font-size: 14px;"><li>3+4*2 â†’ 11</li><li>(1+2)*3 â†’ 9</li><li>10/2-3 â†’ 2</li><li>2*3+4*5 â†’ 26</li></ul></div><div class="info-box info-box-warning"><span class="info-icon">ğŸ”</span><strong>ä¼˜å…ˆçº§è§„åˆ™ï¼š</strong><ul style="text-align: left; font-size: 14px;"><li>æ‹¬å·() - æœ€é«˜</li><li>ä¹˜é™¤* / - è¾ƒé«˜</li><li>åŠ å‡+ - - è¾ƒä½</li><li>åŒçº§ä»å·¦åˆ°å³</li></ul></div><div class="info-box info-box-danger"><span class="info-icon">âŒ</span><strong>å¸¸è§é”™è¯¯ï¼š</strong><ul style="text-align: left; font-size: 14px;"><li>æ‹¬å·ä¸åŒ¹é…</li><li>è¿ç»­è¿ç®—ç¬¦++</li><li>é™¤é›¶é”™è¯¯/0</li><li>ç©ºè¡¨è¾¾å¼</li></ul></div></div></div></div><!-- ğŸŒŸ å®é™…åº”ç”¨ --><div class="content-card"><div class="content-section"><h2 class="section-title"><span class="section-icon">ğŸŒŸ</span>
                å®é™…åº”ç”¨
            </h2><div class="unified-grid unified-grid-3"><div class="grid-card"><span class="card-icon">ğŸ§®</span><h4 class="card-title">è®¡ç®—å™¨åº”ç”¨</h4><p class="card-description">ç§‘å­¦è®¡ç®—å™¨ã€æ‰‹æœºè®¡ç®—å™¨ç­‰åº”ç”¨ä½¿ç”¨è¡¨è¾¾å¼æ±‚å€¼å¼•æ“å¤„ç†å¤æ‚çš„æ•°å­¦è®¡ç®—ã€‚</p></div><div class="grid-card"><span class="card-icon">ğŸ“Š</span><h4 class="card-title">ç”µå­è¡¨æ ¼</h4><p class="card-description">Excelã€Google Sheetsç­‰è¡¨æ ¼è½¯ä»¶ä½¿ç”¨è¡¨è¾¾å¼æ±‚å€¼æ¥å¤„ç†å•å…ƒæ ¼å…¬å¼è®¡ç®—ã€‚</p></div><div class="grid-card"><span class="card-icon">âš™ï¸</span><h4 class="card-title">ç¼–ç¨‹è¯­è¨€ç¼–è¯‘å™¨</h4><p class="card-description">ç¼–è¯‘å™¨åœ¨ä»£ç ç”Ÿæˆé˜¶æ®µéœ€è¦è®¡ç®—å¸¸é‡è¡¨è¾¾å¼ï¼Œä¼˜åŒ–ç¨‹åºæ€§èƒ½ã€‚</p></div></div><h3>ğŸ’¡ å¤šè¯­è¨€ä»£ç å®ç°</h3><!-- ä»£ç æ ‡ç­¾é¡µ --><div style="margin: 20px 0;"><div class="code-tabs" style="display: flex; border-bottom: 2px solid #dee2e6;"><button class="tab-btn active" onclick="showCode('python')" data-lang="python">Python</button><button class="tab-btn" onclick="showCode('java')" data-lang="java">Java</button><button class="tab-btn" onclick="showCode('cpp')" data-lang="cpp">C++</button></div><!-- Pythonä»£ç  --><div id="python-code" class="code-block"><div style="display: flex; justify-content: space-between; align-items: center; padding: 10px; background: #2d3748; color: white;"><span>Python å®ç°</span><button onclick="copyCode('python')" style="background: #4a5568; color: white; border: none; padding: 5px 10px; border-radius: 3px; cursor: pointer;">
                            ğŸ“‹ å¤åˆ¶ä»£ç 
                        </button></div><pre id="python-pre" style="margin: 0; background: #f8f9fa; padding: 15px; overflow-x: auto;"><code>def evaluate_expression(expression):
    """
    ä½¿ç”¨åŒæ ˆç®—æ³•è®¡ç®—ä¸­ç¼€è¡¨è¾¾å¼
    """
    def precedence(op):
        if op in ['+', '-']:
            return 1
        if op in ['*', '/']:
            return 2
        return 0

    def apply_operator(operators, values):
        op = operators.pop()
        right = values.pop()
        left = values.pop()

        if op == '+':
            values.append(left + right)
        elif op == '-':
            values.append(left - right)
        elif op == '*':
            values.append(left * right)
        elif op == '/':
            if right == 0:
                raise ValueError("é™¤é›¶é”™è¯¯")
            values.append(left / right)

    values = []  # æ“ä½œæ•°æ ˆ
    operators = []  # è¿ç®—ç¬¦æ ˆ
    i = 0

    while i < len(expression):
        if expression[i] == ' ':
            i += 1
            continue

        # å¤„ç†æ•°å­—
        if expression[i].isdigit():
            val = 0
            while i < len(expression) and expression[i].isdigit():
                val = val * 10 + int(expression[i])
                i += 1
            values.append(val)
            continue

        # å¤„ç†å·¦æ‹¬å·
        if expression[i] == '(':
            operators.append(expression[i])

        # å¤„ç†å³æ‹¬å·
        elif expression[i] == ')':
            while operators and operators[-1] != '(':
                apply_operator(operators, values)
            operators.pop()  # ç§»é™¤ '('

        # å¤„ç†è¿ç®—ç¬¦
        else:
            while (operators and operators[-1] != '(' and
                   precedence(operators[-1]) >= precedence(expression[i])):
                apply_operator(operators, values)
            operators.append(expression[i])

        i += 1

    # å¤„ç†å‰©ä½™çš„è¿ç®—ç¬¦
    while operators:
        apply_operator(operators, values)

    return values[0]

# æµ‹è¯•ç¤ºä¾‹
test_expressions = [
    "3+4*2",      # 11
    "(1+2)*3",    # 9
    "10/2-3",     # 2
    "2*3+4*5"     # 26
]

for expr in test_expressions:
    try:
        result = evaluate_expression(expr)
        print(f"{expr} = {result}")
    except Exception as e:
        print(f"{expr} -> é”™è¯¯: {e}")
</code></pre></div><!-- Javaä»£ç  --><div id="java-code" class="code-block" style="display: none;"><div style="display: flex; justify-content: space-between; align-items: center; padding: 10px; background: #2d3748; color: white;"><span>Java å®ç°</span><button onclick="copyCode('java')" style="background: #4a5568; color: white; border: none; padding: 5px 10px; border-radius: 3px; cursor: pointer;">
                            ğŸ“‹ å¤åˆ¶ä»£ç 
                        </button></div><pre id="java-pre" style="margin: 0; background: #f8f9fa; padding: 15px; overflow-x: auto;"><code>import java.util.*;

public class ExpressionEvaluator {

    /**
     * è·å–è¿ç®—ç¬¦ä¼˜å…ˆçº§
     */
    private static int precedence(char op) {
        switch (op) {
            case '+':
            case '-':
                return 1;
            case '*':
            case '/':
                return 2;
        }
        return -1;
    }

    /**
     * æ‰§è¡Œè¿ç®—
     */
    private static double applyOp(char op, double b, double a) {
        switch (op) {
            case '+':
                return a + b;
            case '-':
                return a - b;
            case '*':
                return a * b;
            case '/':
                if (b == 0)
                    throw new ArithmeticException("é™¤é›¶é”™è¯¯");
                return a / b;
        }
        return 0;
    }

    /**
     * è®¡ç®—ä¸­ç¼€è¡¨è¾¾å¼
     */
    public static double evaluate(String expression) {
        Stack&lt;Double&gt; values = new Stack&lt;&gt;();     // æ“ä½œæ•°æ ˆ
        Stack&lt;Character&gt; operators = new Stack&lt;&gt;(); // è¿ç®—ç¬¦æ ˆ

        for (int i = 0; i &lt; expression.length(); i++) {
            char c = expression.charAt(i);

            // è·³è¿‡ç©ºæ ¼
            if (c == ' ')
                continue;

            // å¤„ç†æ•°å­—
            if (Character.isDigit(c)) {
                StringBuffer sbuf = new StringBuffer();
                while (i &lt; expression.length() &&
                       Character.isDigit(expression.charAt(i)))
                    sbuf.append(expression.charAt(i++));
                values.push(Double.parseDouble(sbuf.toString()));
                i--; // å›é€€ä¸€ä½
            }

            // å¤„ç†å·¦æ‹¬å·
            else if (c == '(')
                operators.push(c);

            // å¤„ç†å³æ‹¬å·
            else if (c == ')') {
                while (!operators.empty() && operators.peek() != '(')
                    values.push(applyOp(operators.pop(), values.pop(), values.pop()));
                operators.pop(); // ç§»é™¤ '('
            }

            // å¤„ç†è¿ç®—ç¬¦
            else if (c == '+' || c == '-' || c == '*' || c == '/') {
                while (!operators.empty() && precedence(c) &lt;= precedence(operators.peek()))
                    values.push(applyOp(operators.pop(), values.pop(), values.pop()));
                operators.push(c);
            }
        }

        // å¤„ç†å‰©ä½™è¿ç®—ç¬¦
        while (!operators.empty())
            values.push(applyOp(operators.pop(), values.pop(), values.pop()));

        return values.pop();
    }

    public static void main(String[] args) {
        String[] testExpressions = {
            "3+4*2",      // 11
            "(1+2)*3",    // 9
            "10/2-3",     // 2
            "2*3+4*5"     // 26
        };

        for (String expr : testExpressions) {
            try {
                double result = evaluate(expr);
                System.out.println(expr + " = " + result);
            } catch (Exception e) {
                System.out.println(expr + " -> é”™è¯¯: " + e.getMessage());
            }
        }
    }
}
</code></pre></div><!-- C++ä»£ç  --><div id="cpp-code" class="code-block" style="display: none;"><div style="display: flex; justify-content: space-between; align-items: center; padding: 10px; background: #2d3748; color: white;"><span>C++ å®ç°</span><button onclick="copyCode('cpp')" style="background: #4a5568; color: white; border: none; padding: 5px 10px; border-radius: 3px; cursor: pointer;">
                            ğŸ“‹ å¤åˆ¶ä»£ç 
                        </button></div><pre id="cpp-pre" style="margin: 0; background: #f8f9fa; padding: 15px; overflow-x: auto;"><code>#include &lt;iostream&gt;
#include &lt;stack&gt;
#include &lt;string&gt;
#include &lt;vector&gt;
#include &lt;stdexcept&gt;

using namespace std;

class ExpressionEvaluator {
private:
    /**
     * è·å–è¿ç®—ç¬¦ä¼˜å…ˆçº§
     */
    static int precedence(char op) {
        if (op == '+' || op == '-') return 1;
        if (op == '*' || op == '/') return 2;
        return 0;
    }

    /**
     * æ‰§è¡Œè¿ç®—
     */
    static double applyOp(char op, double b, double a) {
        switch (op) {
            case '+': return a + b;
            case '-': return a - b;
            case '*': return a * b;
            case '/':
                if (b == 0)
                    throw runtime_error("é™¤é›¶é”™è¯¯");
                return a / b;
            default: return 0;
        }
    }

public:
    /**
     * è®¡ç®—ä¸­ç¼€è¡¨è¾¾å¼
     */
    static double evaluate(const string&amp; expression) {
        stack&lt;double&gt; values;      // æ“ä½œæ•°æ ˆ
        stack&lt;char&gt; operators;    // è¿ç®—ç¬¦æ ˆ

        for (int i = 0; i &lt; expression.length(); i++) {
            char c = expression[i];

            // è·³è¿‡ç©ºæ ¼
            if (c == ' ') continue;

            // å¤„ç†æ•°å­—
            if (isdigit(c)) {
                double val = 0;
                while (i &lt; expression.length() && isdigit(expression[i])) {
                    val = val * 10 + (expression[i] - '0');
                    i++;
                }
                values.push(val);
                i--; // å›é€€ä¸€ä½
            }

            // å¤„ç†å·¦æ‹¬å·
            else if (c == '(') {
                operators.push(c);
            }

            // å¤„ç†å³æ‹¬å·
            else if (c == ')') {
                while (!operators.empty() && operators.top() != '(') {
                    double val2 = values.top(); values.pop();
                    double val1 = values.top(); values.pop();
                    char op = operators.top(); operators.pop();
                    values.push(applyOp(op, val2, val1));
                }
                operators.pop(); // ç§»é™¤ '('
            }

            // å¤„ç†è¿ç®—ç¬¦
            else if (c == '+' || c == '-' || c == '*' || c == '/') {
                while (!operators.empty() &&
                       precedence(c) &lt;= precedence(operators.top())) {
                    double val2 = values.top(); values.pop();
                    double val1 = values.top(); values.pop();
                    char op = operators.top(); operators.pop();
                    values.push(applyOp(op, val2, val1));
                }
                operators.push(c);
            }
        }

        // å¤„ç†å‰©ä½™è¿ç®—ç¬¦
        while (!operators.empty()) {
            double val2 = values.top(); values.pop();
            double val1 = values.top(); values.pop();
            char op = operators.top(); operators.pop();
            values.push(applyOp(op, val2, val1));
        }

        return values.top();
    }
};

int main() {
    vector&lt;string&gt; testExpressions = {
        "3+4*2",      // 11
        "(1+2)*3",    // 9
        "10/2-3",     // 2
        "2*3+4*5"     // 26
    };

    for (const string&amp; expr : testExpressions) {
        try {
            double result = ExpressionEvaluator::evaluate(expr);
            cout &lt;&lt; expr &lt;&lt; " = " &lt;&lt; result &lt;&lt; endl;
        } catch (const exception&amp; e) {
            cout &lt;&lt; expr &lt;&lt; " -> é”™è¯¯: " &lt;&lt; e.what() &lt;&lt; endl;
        }
    }

    return 0;
}
</code></pre></div></div></div></div><!-- âœ… å­¦ä¹ æ£€éªŒ --><div class="content-card"><div class="content-section"><h2 class="section-title"><span class="section-icon">âœ…</span>
                å­¦ä¹ æ£€éªŒ
            </h2><div class="unified-grid unified-grid-1" style="gap: 15px;"><!-- é¢˜ç›®1 --><div class="question-card" style="border: 1px solid #dee2e6; border-radius: 8px; overflow: hidden;"><div class="question-header" onclick="toggleAnswer('q1')" style="padding: 15px; background: #f8f9fa; cursor: pointer; display: flex; justify-content: space-between; align-items: center;"><span><strong>é¢˜ç›®1ï¼š</strong>ä¸ºä»€ä¹ˆè¡¨è¾¾å¼æ±‚å€¼éœ€è¦ç”¨åˆ°ä¸¤ä¸ªæ ˆè€Œä¸æ˜¯ä¸€ä¸ªï¼Ÿ</span><span id="q1-icon">ğŸ”½</span></div><div id="q1-answer" class="answer-content" style="display: none; padding: 15px; background: #e8f4fd;"><p><strong>ç­”æ¡ˆï¼š</strong></p><p>ä¸¤ä¸ªæ ˆå„æœ‰ä¸åŒçš„èŒè´£ï¼Œç¼ºä¸€ä¸å¯ï¼š</p><ul style="text-align: left; margin: 10px 0;"><li><strong>æ“ä½œæ•°æ ˆï¼š</strong>å­˜å‚¨æ•°å­—å’Œä¸­é—´è®¡ç®—ç»“æœï¼ŒæŒ‰é¡ºåºä¿å­˜å¾…è®¡ç®—çš„æ“ä½œæ•°</li><li><strong>è¿ç®—ç¬¦æ ˆï¼š</strong>ä¸´æ—¶å­˜å‚¨è¿ç®—ç¬¦ï¼Œå¤„ç†ä¼˜å…ˆçº§å’Œå»¶è¿Ÿè®¡ç®—</li><li><strong>ååŒå·¥ä½œï¼š</strong>å½“é‡åˆ°ä½ä¼˜å…ˆçº§è¿ç®—ç¬¦æ—¶ï¼Œéœ€è¦å…ˆå¤„ç†æ ˆä¸­é«˜ä¼˜å…ˆçº§è¿ç®—ç¬¦</li><li><strong>å•æ ˆé—®é¢˜ï¼š</strong>æ— æ³•åŒæ—¶ç®¡ç†æ•°å­—å’Œè¿ç®—ç¬¦çš„ä¸åŒå¤„ç†é€»è¾‘</li></ul><p>ä¾‹å¦‚ï¼šè®¡ç®—"3+4*2"æ—¶ï¼Œé‡åˆ°"*"éœ€è¦æš‚å­˜"+"ï¼Œé‡åˆ°"2"åå…ˆè®¡ç®—4*2=8ï¼Œå†è®¡ç®—3+8=11</p></div></div><!-- é¢˜ç›®2 --><div class="question-card" style="border: 1px solid #dee2e6; border-radius: 8px; overflow: hidden;"><div class="question-header" onclick="toggleAnswer('q2')" style="padding: 15px; background: #f8f9fa; cursor: pointer; display: flex; justify-content: space-between; align-items: center;"><span><strong>é¢˜ç›®2ï¼š</strong>æ‰‹åŠ¨è®¡ç®—è¡¨è¾¾å¼"2*3+4*5-6"çš„è¯¦ç»†è¿‡ç¨‹ã€‚</span><span id="q2-icon">ğŸ”½</span></div><div id="q2-answer" class="answer-content" style="display: none; padding: 15px; background: #e8f4fd;"><p><strong>ç­”æ¡ˆï¼šæœ€ç»ˆç»“æœ = 20</strong></p><p><strong>è¯¦ç»†è®¡ç®—è¿‡ç¨‹ï¼š</strong></p><table style="width: 100%; border-collapse: collapse; margin: 10px 0; font-size: 14px;"><tr style="background: #f8f9fa;"><th style="border: 1px solid #ddd; padding: 8px;">æ­¥éª¤</th><th style="border: 1px solid #ddd; padding: 8px;">å½“å‰å­—ç¬¦</th><th style="border: 1px solid #ddd; padding: 8px;">æ“ä½œæ•°æ ˆ</th><th style="border: 1px solid #ddd; padding: 8px;">è¿ç®—ç¬¦æ ˆ</th><th style="border: 1px solid #ddd; padding: 8px;">è¯´æ˜</th></tr><tr><td style="border: 1px solid #ddd; padding: 6px;">1</td><td style="border: 1px solid #ddd; padding: 6px;">2</td><td style="border: 1px solid #ddd; padding: 6px;">[2]</td><td style="border: 1px solid #ddd; padding: 6px;">[]</td><td style="border: 1px solid #ddd; padding: 6px;">æ•°å­—å…¥æ“ä½œæ•°æ ˆ</td></tr><tr><td style="border: 1px solid #ddd; padding: 6px;">2</td><td style="border: 1px solid #ddd; padding: 6px;">*</td><td style="border: 1px solid #ddd; padding: 6px;">[2]</td><td style="border: 1px solid #ddd; padding: 6px;">[*]</td><td style="border: 1px solid #ddd; padding: 6px;">è¿ç®—ç¬¦å…¥æ ˆ</td></tr><tr><td style="border: 1px solid #ddd; padding: 6px;">3</td><td style="border: 1px solid #ddd; padding: 6px;">3</td><td style="border: 1px solid #ddd; padding: 6px;">[2,3]</td><td style="border: 1px solid #ddd; padding: 6px;">[*]</td><td style="border: 1px solid #ddd; padding: 6px;">æ•°å­—å…¥æ“ä½œæ•°æ ˆ</td></tr><tr><td style="border: 1px solid #ddd; padding: 6px;">4</td><td style="border: 1px solid #ddd; padding: 6px;">+</td><td style="border: 1px solid #ddd; padding: 6px;">[6]</td><td style="border: 1px solid #ddd; padding: 6px;">[+]</td><td style="border: 1px solid #ddd; padding: 6px;">*ä¼˜å…ˆçº§é«˜ï¼Œå…ˆè®¡ç®—2*3=6</td></tr><tr><td style="border: 1px solid #ddd; padding: 6px;">5</td><td style="border: 1px solid #ddd; padding: 6px;">4</td><td style="border: 1px solid #ddd; padding: 6px;">[6,4]</td><td style="border: 1px solid #ddd; padding: 6px;">[+]</td><td style="border: 1px solid #ddd; padding: 6px;">æ•°å­—å…¥æ“ä½œæ•°æ ˆ</td></tr><tr><td style="border: 1px solid #ddd; padding: 6px;">6</td><td style="border: 1px solid #ddd; padding: 6px;">*</td><td style="border: 1px solid #ddd; padding: 6px;">[6,4]</td><td style="border: 1px solid #ddd; padding: 6px;">[+,*]</td><td style="border: 1px solid #ddd; padding: 6px;">*ä¼˜å…ˆçº§é«˜äº+ï¼Œå…¥æ ˆ</td></tr><tr><td style="border: 1px solid #ddd; padding: 6px;">7</td><td style="border: 1px solid #ddd; padding: 6px;">5</td><td style="border: 1px solid #ddd; padding: 6px;">[6,4,5]</td><td style="border: 1px solid #ddd; padding: 6px;">[+,*]</td><td style="border: 1px solid #ddd; padding: 6px;">æ•°å­—å…¥æ“ä½œæ•°æ ˆ</td></tr><tr><td style="border: 1px solid #ddd; padding: 6px;">8</td><td style="border: 1px solid #ddd; padding: 6px;">-</td><td style="border: 1px solid #ddd; padding: 6px;">[6,20]</td><td style="border: 1px solid #ddd; padding: 6px;">[+]</td><td style="border: 1px solid #ddd; padding: 6px;">å…ˆè®¡ç®—4*5=20</td></tr><tr><td style="border: 1px solid #ddd; padding: 6px;">9</td><td style="border: 1px solid #ddd; padding: 6px;">-</td><td style="border: 1px solid #ddd; padding: 6px;">[26]</td><td style="border: 1px solid #ddd; padding: 6px;">[-]</td><td style="border: 1px solid #ddd; padding: 6px;">å†è®¡ç®—6+20=26</td></tr><tr><td style="border: 1px solid #ddd; padding: 6px;">10</td><td style="border: 1px solid #ddd; padding: 6px;">6</td><td style="border: 1px solid #ddd; padding: 6px;">[26,6]</td><td style="border: 1px solid #ddd; padding: 6px;">[-]</td><td style="border: 1px solid #ddd; padding: 6px;">æ•°å­—å…¥æ“ä½œæ•°æ ˆ</td></tr><tr><td style="border: 1px solid #ddd; padding: 6px;">11</td><td style="border: 1px solid #ddd; padding: 6px;">ç»“æŸ</td><td style="border: 1px solid #ddd; padding: 6px;">[20]</td><td style="border: 1px solid #ddd; padding: 6px;">[]</td><td style="border: 1px solid #ddd; padding: 6px;">æœ€åè®¡ç®—26-6=20</td></tr></table></div></div><!-- é¢˜ç›®3 --><div class="question-card" style="border: 1px solid #dee2e6; border-radius: 8px; overflow: hidden;"><div class="question-header" onclick="toggleAnswer('q3')" style="padding: 15px; background: #f8f9fa; cursor: pointer; display: flex; justify-content: space-between; align-items: center;"><span><strong>é¢˜ç›®3ï¼š</strong>å¦‚ä½•æ‰©å±•ç®—æ³•ä»¥æ”¯æŒæ›´å¤šè¿ç®—ç¬¦ï¼ˆå¦‚å¹‚è¿ç®—^ã€å–æ¨¡%ï¼‰ï¼Ÿ</span><span id="q3-icon">ğŸ”½</span></div><div id="q3-answer" class="answer-content" style="display: none; padding: 15px; background: #e8f4fd;"><p><strong>ç­”æ¡ˆï¼š</strong></p><p><strong>æ‰©å±•æ­¥éª¤ï¼š</strong></p><ol style="text-align: left; margin: 10px 0;"><li><strong>ä¼˜å…ˆçº§å®šä¹‰ï¼š</strong>å»ºç«‹æ›´å®Œæ•´çš„ä¼˜å…ˆçº§å±‚æ¬¡</li><li><strong>ç»“åˆæ€§è€ƒè™‘ï¼š</strong>æœ‰äº›è¿ç®—ç¬¦æ˜¯å³ç»“åˆçš„ï¼ˆå¦‚å¹‚è¿ç®—ï¼‰</li><li><strong>è¿ç®—é€»è¾‘ï¼š</strong>åœ¨applyOpå‡½æ•°ä¸­æ·»åŠ æ–°çš„è¿ç®—åˆ†æ”¯</li><li><strong>ç‰¹æ®Šå¤„ç†ï¼š</strong>æŸäº›è¿ç®—ç¬¦å¯èƒ½éœ€è¦ç‰¹æ®Šçš„é”™è¯¯æ£€æŸ¥</li></ol><p><strong>ä¼˜å…ˆçº§è¡¨ç¤ºä¾‹ï¼š</strong></p><pre style="background: #2d3748; color: white; padding: 10px; border-radius: 4px; font-size: 12px;">
def precedence(op):
    precedence_map = {
        '+': 1, '-': 1,    # åŠ å‡æ³•
        '*': 2, '/': 2, '%': 2,  # ä¹˜é™¤æ¨¡
        '^': 3             # å¹‚è¿ç®—ï¼ˆæœ€é«˜ä¼˜å…ˆçº§ï¼‰
    }
    return precedence_map.get(op, 0)

def is_right_associative(op):
    return op == '^'  # å¹‚è¿ç®—æ˜¯å³ç»“åˆçš„</pre><p><strong>å³ç»“åˆæ€§å¤„ç†ï¼š</strong>å¹‚è¿ç®—2^3^2åº”è¯¥è®¡ç®—ä¸º2^(3^2)=512è€Œä¸æ˜¯(2^3)^2=64</p></div></div><!-- é¢˜ç›®4 --><div class="question-card" style="border: 1px solid #dee2e6; border-radius: 8px; overflow: hidden;"><div class="question-header" onclick="toggleAnswer('q4')" style="padding: 15px; background: #f8f9fa; cursor: pointer; display: flex; justify-content: space-between; align-items: center;"><span><strong>é¢˜ç›®4ï¼š</strong>ä¸ºä»€ä¹ˆåç¼€è¡¨è¾¾å¼(é€†æ³¢å…°è¡¨è¾¾å¼)æ›´é€‚åˆè®¡ç®—æœºå¤„ç†ï¼Ÿ</span><span id="q4-icon">ğŸ”½</span></div><div id="q4-answer" class="answer-content" style="display: none; padding: 15px; background: #e8f4fd;"><p><strong>ç­”æ¡ˆï¼š</strong></p><div style="text-align: left;"><p><strong>åç¼€è¡¨è¾¾å¼çš„ä¼˜åŠ¿ï¼š</strong></p><ul style="margin: 5px 0;"><li><strong>æ— éœ€æ‹¬å·ï¼š</strong>è¿ç®—é¡ºåºå®Œå…¨ç”±ä½ç½®å†³å®šï¼Œä¸éœ€è¦æ‹¬å·</li><li><strong>æ— ä¼˜å…ˆçº§ï¼š</strong>ä»å·¦åˆ°å³é¡ºåºè®¡ç®—ï¼Œä¸éœ€è¦è€ƒè™‘è¿ç®—ç¬¦ä¼˜å…ˆçº§</li><li><strong>å•æ ˆå³å¯ï¼š</strong>åªéœ€è¦ä¸€ä¸ªæ“ä½œæ•°æ ˆï¼Œç®—æ³•æ›´ç®€å•</li><li><strong>å¤©ç„¶é€’å½’ï¼š</strong>ç¬¦åˆæ ˆçš„å¤„ç†æ–¹å¼ï¼Œæ¯ä¸ªè¿ç®—ç¬¦å¤„ç†æœ€è¿‘çš„ä¸¤ä¸ªæ“ä½œæ•°</li></ul><p><strong>ç¤ºä¾‹å¯¹æ¯”ï¼š</strong></p><ul style="margin: 5px 0;"><li>ä¸­ç¼€ï¼š(3+4)*2-1 â†’ éœ€è¦å¤„ç†æ‹¬å·å’Œä¼˜å…ˆçº§</li><li>åç¼€ï¼š3 4 + 2 * 1 - â†’ ä»å·¦åˆ°å³ç›´æ¥è®¡ç®—</li></ul><p><strong>åç¼€è¡¨è¾¾å¼è®¡ç®—æ­¥éª¤ï¼š</strong></p><ol style="margin: 5px 0; font-size: 14px;"><li>é‡åˆ°æ•°å­—å°±å…¥æ ˆ</li><li>é‡åˆ°è¿ç®—ç¬¦å°±å–å‡ºæ ˆé¡¶ä¸¤ä¸ªæ•°å­—è®¡ç®—</li><li>å°†ç»“æœå…¥æ ˆ</li><li>é‡å¤ç›´åˆ°è¡¨è¾¾å¼ç»“æŸ</li></ol><p><strong>è¿™å°±æ˜¯ä¸ºä»€ä¹ˆç¼–è¯‘å™¨ç»å¸¸å°†ä¸­ç¼€è¡¨è¾¾å¼è½¬æ¢ä¸ºåç¼€è¡¨è¾¾å¼çš„åŸå› ã€‚</strong></p></div></div></div></div><div class="info-box info-box-info" style="margin-top: 20px;"><span class="info-icon">ğŸ“š</span><strong>è¿›é˜¶å­¦ä¹ è·¯å¾„ï¼š</strong>
                æŒæ¡è¡¨è¾¾å¼æ±‚å€¼åï¼Œå¯ä»¥å­¦ä¹ ï¼šç¼–è¯‘åŸç†ä¸­çš„è¯­æ³•åˆ†æã€æŠ½è±¡è¯­æ³•æ ‘(AST)ã€é€’å½’ä¸‹é™è§£æå™¨ã€LR/LALRè¯­æ³•åˆ†æå™¨ã€è¡¨è¾¾å¼ä¼˜åŒ–æŠ€æœ¯ç­‰æ›´é«˜çº§çš„ä¸»é¢˜ã€‚
            </div></div></div><!-- å¯¼èˆªæŒ‰é’® --><div style="text-align: center; margin-top: 40px;"><a href="{% url 'knowledge_app:index' %}" class="unified-btn unified-btn-primary"><span>ğŸ </span>
            è¿”å›é¦–é¡µ
        </a><a href="{% url 'knowledge_app:cs_universe' %}" class="unified-btn unified-btn-secondary"><span>ğŸŒŒ</span>
            æ¢ç´¢CSå®‡å®™
        </a></div></div><style>.code-tabs {background:#f8f9fa}.tab-btn {background:#e9ecef;border:none;padding:12px 24px;cursor:pointer;border-bottom:3px solid transparent;transition:all 0.3s ease}.tab-btn.active {background:#fff;border-bottom-color:#007bff;color:#007bff;font-weight:bold}.tab-btn:hover {background:#fff}.code-block {border:1px solid #dee2e6;border-top:none}.question-card {transition:all 0.3s ease}.question-card:hover {box-shadow:0 2px 8px rgba(0,0,0,0.1)}.question-header {transition:background-color 0.3s ease}.question-header:hover {background:#e9ecef !important}.answer-content {animation:fadeIn 0.3s ease}@keyframes fadeIn {from {opacity:0}to {opacity:1}}.stack-item {animation:stackSlide 0.3s ease}@keyframes stackSlide {from {opacity:0;transform:translateX(-50%) translateY(20px)}to {opacity:1;transform:translateX(-50%) translateY(0)}}</style><script>let currentEvalStep = 0; let currentExpression = "3+4*2-1"; let evalSteps = []; let evalAutoInterval; class ExpressionEvaluator { constructor() { this.precedence = {'+': 1, '-': 1, '*': 2, '/': 2}; } isDigit(char) { return char >= '0' && char <= '9'; } isOperator(char) { return ['+', '-', '*', '/'].includes(char); } applyOperator(op, b, a) { switch(op) { case '+': return a + b; case '-': return a - b; case '*': return a * b; case '/': if (b === 0) throw new Error("é™¤é›¶é”™è¯¯"); return a / b; default: return 0; } } generateSteps(expression) { const steps = []; const values = []; const operators = []; let i = 0; steps.push({ step: 0, char: '', values: [...values], operators: [...operators], action: 'å¼€å§‹è§£æè¡¨è¾¾å¼', highlight: -1 }); try { while (i < expression.length) { const char = expression[i]; if (char === ' ') { i++; continue; } if (this.isDigit(char)) { let num = 0; const startI = i; while (i < expression.length && this.isDigit(expression[i])) { num = num * 10 + parseInt(expression[i]); i++; } values.push(num); steps.push({ step: steps.length, char: num.toString(), values: [...values], operators: [...operators], action: `æ•°å­— ${num} å…¥æ“ä½œæ•°æ ˆ`, highlight: startI, success: true }); } else if (char === '(') { operators.push(char); steps.push({ step: steps.length, char: char, values: [...values], operators: [...operators], action: `å·¦æ‹¬å· '(' å…¥è¿ç®—ç¬¦æ ˆ`, highlight: i, success: true }); i++; } else if (char === ')') { while (operators.length > 0 && operators[operators.length - 1] !== '(') { const op = operators.pop(); const b = values.pop(); const a = values.pop(); const result = this.applyOperator(op, b, a); values.push(result); steps.push({ step: steps.length, char: char, values: [...values], operators: [...operators], action: `æ‰§è¡Œè¿ç®—: ${a} ${op} ${b} = ${result}`, highlight: i, calculation: {a, op, b, result}, success: true }); } if (operators.length > 0) { operators.pop(); } steps.push({ step: steps.length, char: char, values: [...values], operators: [...operators], action: `å³æ‹¬å· ')' åŒ¹é…å®Œæˆï¼Œç§»é™¤å·¦æ‹¬å·`, highlight: i, success: true }); i++; } else if (this.isOperator(char)) { while (operators.length > 0 && operators[operators.length - 1] !== '(' && this.precedence[operators[operators.length - 1]] >= this.precedence[char]) { const op = operators.pop(); const b = values.pop(); const a = values.pop(); const result = this.applyOperator(op, b, a); values.push(result); steps.push({ step: steps.length, char: char, values: [...values], operators: [...operators], action: `${op} ä¼˜å…ˆçº§è¾ƒé«˜ï¼Œå…ˆæ‰§è¡Œ: ${a} ${op} ${b} = ${result}`, highlight: i, calculation: {a, op, b, result}, success: true }); } operators.push(char); steps.push({ step: steps.length, char: char, values: [...values], operators: [...operators], action: `è¿ç®—ç¬¦ '${char}' å…¥è¿ç®—ç¬¦æ ˆ`, highlight: i, success: true }); i++; } else { throw new Error(`æ— æ•ˆå­—ç¬¦: ${char}`); } } while (operators.length > 0) { const op = operators.pop(); const b = values.pop(); const a = values.pop(); const result = this.applyOperator(op, b, a); values.push(result); steps.push({ step: steps.length, char: '', values: [...values], operators: [...operators], action: `å¤„ç†å‰©ä½™è¿ç®—ç¬¦: ${a} ${op} ${b} = ${result}`, highlight: -1, calculation: {a, op, b, result}, success: true }); } steps.push({ step: steps.length, char: '', values: [...values], operators: [...operators], action: `è®¡ç®—å®Œæˆï¼æœ€ç»ˆç»“æœ: ${values[0]}`, highlight: -1, final: true, result: values[0], success: true }); } catch (error) { steps.push({ step: steps.length, char: '', values: [...values], operators: [...operators], action: `é”™è¯¯: ${error.message}`, highlight: i, success: false, error: true }); } return steps; } } const evaluator = new ExpressionEvaluator(); function initializeEvaluationSteps(expression) { evalSteps = evaluator.generateSteps(expression); } function updateEvaluationDisplay() { if (evalSteps.length === 0) return; const step = evalSteps[currentEvalStep]; const exprDiv = document.getElementById('currentExpression'); let highlighted = ''; for (let i = 0; i < currentExpression.length; i++) { if (i === step.highlight) { const color = step.success ? '#ffc107' : '#dc3545'; highlighted += `<span style="background: ${color}; color: #000; padding: 2px 4px; border-radius: 3px; font-weight: bold;">${currentExpression[i]}</span>`; } else if (i < step.highlight) { highlighted += `<span style="color: #28a745;">${currentExpression[i]}</span>`; } else { highlighted += currentExpression[i]; } } exprDiv.innerHTML = highlighted || currentExpression; const numberStackDiv = document.getElementById('numberStack'); numberStackDiv.innerHTML = '<div style="position: absolute; bottom: 10px; left: 50%; transform: translateX(-50%); color: #6c757d;">æ ˆåº•</div>'; step.values.forEach((value, index) => { const element = document.createElement('div'); element.className = 'stack-item'; element.style.cssText = ` position: absolute; bottom: ${30 + index * 35}px; left: 50%; transform: translateX(-50%); background: ${step.success ? '#28a745' : '#dc3545'}; color: white; padding: 6px 12px; border-radius: 5px; font-weight: bold; font-size: 16px; min-width: 30px; text-align: center; `; element.textContent = value; numberStackDiv.appendChild(element); }); const operatorStackDiv = document.getElementById('operatorStack'); operatorStackDiv.innerHTML = '<div style="position: absolute; bottom: 10px; left: 50%; transform: translateX(-50%); color: #6c757d;">æ ˆåº•</div>'; step.operators.forEach((op, index) => { const element = document.createElement('div'); element.className = 'stack-item'; element.style.cssText = ` position: absolute; bottom: ${30 + index * 35}px; left: 50%; transform: translateX(-50%); background: ${step.success ? '#ffc107' : '#dc3545'}; color: #000; padding: 6px 12px; border-radius: 5px; font-weight: bold; font-size: 16px; min-width: 30px; text-align: center; `; element.textContent = op; operatorStackDiv.appendChild(element); }); const resultDiv = document.getElementById('resultDisplay'); if (step.final && step.result !== undefined) { resultDiv.textContent = `ç»“æœ: ${step.result}`; resultDiv.style.color = '#28a745'; resultDiv.style.borderColor = '#28a745'; } else if (step.error) { resultDiv.textContent = 'è®¡ç®—é”™è¯¯'; resultDiv.style.color = '#dc3545'; resultDiv.style.borderColor = '#dc3545'; } else { resultDiv.textContent = 'è®¡ç®—ä¸­...'; resultDiv.style.color = '#007bff'; resultDiv.style.borderColor = '#007bff'; } let actionText = step.action; if (step.calculation) { const {a, op, b, result} = step.calculation; actionText += ` (${a} ${op} ${b} = ${result})`; } const infoColor = step.success ? '#e3f2fd' : '#ffebee'; document.getElementById('evalStepInfo').innerHTML = `<strong>ç¬¬${currentEvalStep}æ­¥ï¼š</strong>${actionText}`; document.getElementById('evalStepInfo').style.background = infoColor; const stepBtn = document.getElementById('evalStepBtn'); if (currentEvalStep >= evalSteps.length - 1) { stepBtn.textContent = 'æ¼”ç¤ºå®Œæˆ'; stepBtn.disabled = true; stepBtn.style.background = '#6c757d'; } else { stepBtn.textContent = 'ä¸‹ä¸€æ­¥'; stepBtn.disabled = false; stepBtn.style.background = '#007bff'; } } function nextEvalStep() { if (currentEvalStep < evalSteps.length - 1) { currentEvalStep++; updateEvaluationDisplay(); } } function startEvaluation() { currentExpression = document.getElementById('expressionInput').value.trim(); if (!currentExpression) { alert('è¯·è¾“å…¥è¦è®¡ç®—çš„è¡¨è¾¾å¼ï¼'); return; } currentEvalStep = 0; initializeEvaluationSteps(currentExpression); updateEvaluationDisplay(); const stepBtn = document.getElementById('evalStepBtn'); stepBtn.disabled = false; stepBtn.style.background = '#007bff'; stepBtn.textContent = 'ä¸‹ä¸€æ­¥'; if (evalAutoInterval) { clearInterval(evalAutoInterval); evalAutoInterval = null; document.getElementById('autoEvalBtn').textContent = 'è‡ªåŠ¨æ¼”ç¤º'; } } function autoEvaluation() { const autoBtn = document.getElementById('autoEvalBtn'); if (evalAutoInterval) { clearInterval(evalAutoInterval); evalAutoInterval = null; autoBtn.textContent = 'è‡ªåŠ¨æ¼”ç¤º'; return; } autoBtn.textContent = 'åœæ­¢è‡ªåŠ¨'; evalAutoInterval = setInterval(() => { if (currentEvalStep < evalSteps.length - 1) { nextEvalStep(); } else { clearInterval(evalAutoInterval); evalAutoInterval = null; autoBtn.textContent = 'è‡ªåŠ¨æ¼”ç¤º'; } }, 2000); } function resetEvaluation() { currentEvalStep = 0; if (evalAutoInterval) { clearInterval(evalAutoInterval); evalAutoInterval = null; document.getElementById('autoEvalBtn').textContent = 'è‡ªåŠ¨æ¼”ç¤º'; } if (evalSteps.length > 0) { updateEvaluationDisplay(); } else { currentExpression = document.getElementById('expressionInput').value.trim() || "3+4*2-1"; initializeEvaluationSteps(currentExpression); updateEvaluationDisplay(); } } function handleExpressionInput(event) { if (event.key === 'Enter') { startEvaluation(); } } function showCode(language) { document.querySelectorAll('.code-block').forEach(block => { block.style.display = 'none'; }); document.querySelectorAll('.tab-btn').forEach(btn => { btn.classList.remove('active'); }); document.getElementById(language + '-code').style.display = 'block'; document.querySelector(`[data-lang="${language}"]`).classList.add('active'); } async function copyCode(language) { const codeElement = document.getElementById(language + '-pre'); const text = codeElement.textContent; try { await navigator.clipboard.writeText(text); const button = document.querySelector(`#${language}-code button`); const originalText = button.innerHTML; button.innerHTML = 'âœ… å·²å¤åˆ¶'; button.style.background = '#28a745'; setTimeout(() => { button.innerHTML = originalText; button.style.background = '#4a5568'; }, 2000); } catch (err) { alert('å¤åˆ¶å¤±è´¥ï¼Œè¯·æ‰‹åŠ¨é€‰æ‹©ä»£ç å¤åˆ¶'); } } function toggleAnswer(questionId) { const answer = document.getElementById(questionId + '-answer'); const icon = document.getElementById(questionId + '-icon'); if (answer.style.display === 'none') { answer.style.display = 'block'; icon.textContent = 'ğŸ”¼'; } else { answer.style.display = 'none'; icon.textContent = 'ğŸ”½'; } } document.addEventListener('DOMContentLoaded', function() { initializeEvaluationSteps(currentExpression); updateEvaluationDisplay(); });</script>

{% endblock %}