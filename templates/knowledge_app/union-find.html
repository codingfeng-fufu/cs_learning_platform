{% extends 'knowledge_app/base.html' %}

{% block title %}{{ page_title|default:"å¹¶æŸ¥é›†(Union-Find)" }} - è®¡ç®—æœºç§‘å­¦å­¦ä¹ å¹³å°{% endblock %}

{% block content %}
<div class="page-container fade-in">
    <!-- é¢åŒ…å±‘å¯¼èˆª -->
    <div class="breadcrumb">
        <a href="{% url 'knowledge_app:index' %}">é¦–é¡µ</a>
        <span>></span>
        <span>{{ breadcrumb_category|default:"æ•°æ®ç»“æ„" }}</span>
        <span>></span>
        <span>{{ page_title|default:"å¹¶æŸ¥é›†(Union-Find)" }}</span>
    </div>

    <!-- é¡µé¢å¤´éƒ¨ -->
    <div class="page-header slide-in-left">
        <h1>
            <span class="page-icon">{{ page_icon|default:"ğŸŒ" }}</span>
            {{ page_title|default:"å¹¶æŸ¥é›†(Union-Find)" }}
        </h1>
        <p>{{ page_description|default:"é«˜æ•ˆå¤„ç†åŠ¨æ€è¿é€šæ€§é—®é¢˜çš„ç¥å™¨ï¼Œè®©å¤æ‚çš„é›†åˆæ“ä½œå˜å¾—ç®€å•" }}</p>
    </div>

    <!-- ğŸ“‹ çŸ¥è¯†ç‚¹æ¦‚è¿° -->
    <div class="content-card slide-in-right">
        <div class="content-section">
            <h2 class="section-title">
                <span class="section-icon">ğŸ“‹</span>
                çŸ¥è¯†ç‚¹æ¦‚è¿°
            </h2>
            <div class="overview-content">
                <div class="concept-intro">
                    <p><strong>æ ¸å¿ƒæ¦‚å¿µï¼š</strong>å¹¶æŸ¥é›†å°±åƒä¸€ä¸ªæ™ºèƒ½çš„"æœ‹å‹åœˆç®¡ç†ç³»ç»Ÿ"ï¼Œèƒ½å¿«é€Ÿåˆ¤æ–­ä¸¤ä¸ªäººæ˜¯å¦åœ¨åŒä¸€ä¸ªæœ‹å‹åœˆï¼Œä»¥åŠåˆå¹¶ä¸åŒçš„æœ‹å‹åœˆï¼Œè®©å¤æ‚çš„ç¾¤ä½“å…³ç³»ç®¡ç†å˜å¾—è¶…çº§ç®€å•ï¼</p>
                </div>

                <div class="unified-grid unified-grid-2">
                    <div class="info-box info-box-info">
                        <h3>ğŸ·ï¸ å…³é”®æœ¯è¯­</h3>
                        <ul>
                            <li><strong>ä¸ç›¸äº¤é›†åˆï¼š</strong>æ²¡æœ‰å…¬å…±å…ƒç´ çš„é›†åˆæ—</li>
                            <li><strong>Findæ“ä½œï¼š</strong>æŸ¥æ‰¾å…ƒç´ å±äºå“ªä¸ªé›†åˆ</li>
                            <li><strong>Unionæ“ä½œï¼š</strong>åˆå¹¶ä¸¤ä¸ªä¸åŒçš„é›†åˆ</li>
                            <li><strong>è·¯å¾„å‹ç¼©ï¼š</strong>ä¼˜åŒ–æŸ¥æ‰¾è·¯å¾„çš„æŠ€æœ¯</li>
                            <li><strong>æŒ‰ç§©åˆå¹¶ï¼š</strong>æŒ‰æ ‘çš„é«˜åº¦åˆå¹¶çš„ç­–ç•¥</li>
                        </ul>
                    </div>

                    <div class="info-box info-box-success">
                        <h3>ğŸ“Š å­¦ä¹ æŒ‡æ ‡</h3>
                        <p><strong>éš¾åº¦ç­‰çº§ï¼š</strong> <span class="badge badge-hard">é«˜çº§</span></p>
                        <p><strong>å‰ç½®çŸ¥è¯†ï¼š</strong></p>
                        <ul>
                            <li>æ ‘å½¢ç»“æ„ç†è§£ âœ“</li>
                            <li>é€’å½’æ€æƒ³ âœ“</li>
                            <li>ç®—æ³•å¤æ‚åº¦åˆ†æ âœ“</li>
                            <li>å›¾è®ºåŸºç¡€æ¦‚å¿µ âœ“</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- ğŸ” æ¦‚å¿µè¯¦è§£ -->
    <div class="content-card">
        <div class="content-section">
            <h2 class="section-title">
                <span class="section-icon">ğŸ”</span>
                æ¦‚å¿µè¯¦è§£
            </h2>

            <div class="concept-details">
                <div class="concept-item">
                    <h3>ğŸ—ï¸ å¹¶æŸ¥é›†çš„åŸºæœ¬æ€æƒ³</h3>
                    <p>æƒ³è±¡ä¸€ä¸ªå¤§å‹ç¤¾äº¤ç½‘ç»œå¹³å°ï¼š</p>
                    <ul>
                        <li>æ¯ä¸ªäºº(å…ƒç´ )éƒ½æœ‰ä¸€ä¸ª"å®¶é•¿"æŒ‡é’ˆæŒ‡å‘ä¸Šçº§</li>
                        <li>æ¯ä¸ªæœ‹å‹åœˆæœ‰ä¸€ä¸ª"åœˆä¸»"(æ ¹èŠ‚ç‚¹)ä»£è¡¨æ•´ä¸ªåœˆå­</li>
                        <li>æŸ¥æ‰¾æœ‹å‹åœˆï¼šä¸€ç›´æ‰¾å®¶é•¿ï¼Œç›´åˆ°æ‰¾åˆ°åœˆä¸»</li>
                        <li>åˆå¹¶æœ‹å‹åœˆï¼šè®©ä¸€ä¸ªåœˆä¸»è®¤å¦ä¸€ä¸ªåœˆä¸»å½“å®¶é•¿</li>
                    </ul>

                    <div class="example-box">
                        <h4>ğŸ¯ ç”Ÿæ´»ä¾‹å­</h4>
                        <p>å‡è®¾æœ‰å­¦ç”Ÿ Aã€Bã€Cã€Dã€Eï¼š</p>
                        <ul>
                            <li>åˆå§‹ï¼šæ¯äººéƒ½æ˜¯ç‹¬ç«‹çš„"å•äººåœˆ"</li>
                            <li>Aå’ŒBæˆä¸ºæœ‹å‹ â†’ åˆå¹¶Aã€Bçš„åœˆå­</li>
                            <li>Cå’ŒDæˆä¸ºæœ‹å‹ â†’ åˆå¹¶Cã€Dçš„åœˆå­</li>
                            <li>åˆ¤æ–­Aå’ŒCæ˜¯å¦ä¸ºæœ‹å‹ â†’ æŸ¥çœ‹æ˜¯å¦åœ¨åŒä¸€åœˆ</li>
                            <li>Bå’ŒCæˆä¸ºæœ‹å‹ â†’ ä¸¤ä¸ªåœˆå­åˆå¹¶æˆä¸€ä¸ªå¤§åœˆ</li>
                        </ul>
                    </div>
                </div>

                <div class="concept-item">
                    <h3>ğŸ”„ ä¸¤å¤§æ ¸å¿ƒæ“ä½œ</h3>
                    <div class="operations-grid">
                        <div class="operation-card find-card">
                            <span class="op-icon">ğŸ”</span>
                            <h4>Find(æŸ¥æ‰¾)</h4>
                            <p><strong>åŠŸèƒ½ï¼š</strong>æ‰¾åˆ°å…ƒç´ xæ‰€åœ¨é›†åˆçš„ä»£è¡¨å…ƒ</p>
                            <p><strong>è¿‡ç¨‹ï¼š</strong>æ²¿ç€çˆ¶æŒ‡é’ˆä¸€ç›´å‘ä¸Šï¼Œç›´åˆ°æ‰¾åˆ°æ ¹èŠ‚ç‚¹</p>
                            <p><strong>ä¼˜åŒ–ï¼š</strong>è·¯å¾„å‹ç¼© - æŠŠè·¯å¾„ä¸Šæ‰€æœ‰èŠ‚ç‚¹ç›´æ¥è¿åˆ°æ ¹</p>
                            <div class="complexity">æ—¶é—´å¤æ‚åº¦: O(Î±(n)) â‰ˆ å¸¸æ•°</div>
                        </div>
                        <div class="operation-card union-card">
                            <span class="op-icon">ğŸ”—</span>
                            <h4>Union(åˆå¹¶)</h4>
                            <p><strong>åŠŸèƒ½ï¼š</strong>åˆå¹¶å…ƒç´ xå’Œyæ‰€åœ¨çš„ä¸¤ä¸ªé›†åˆ</p>
                            <p><strong>è¿‡ç¨‹ï¼š</strong>æ‰¾åˆ°ä¸¤ä¸ªå…ƒç´ çš„æ ¹ï¼Œè®©ä¸€ä¸ªæ ¹æŒ‡å‘å¦ä¸€ä¸ªæ ¹</p>
                            <p><strong>ä¼˜åŒ–ï¼š</strong>æŒ‰ç§©åˆå¹¶ - è®©çŸ®æ ‘çš„æ ¹æŒ‡å‘é«˜æ ‘çš„æ ¹</p>
                            <div class="complexity">æ—¶é—´å¤æ‚åº¦: O(Î±(n)) â‰ˆ å¸¸æ•°</div>
                        </div>
                    </div>
                </div>

                <div class="concept-item">
                    <h3>ğŸš€ ä¼˜åŒ–æŠ€æœ¯è¯¦è§£</h3>
                    <div class="optimization-techniques">
                        <div class="tech-card">
                            <h4>âš¡ è·¯å¾„å‹ç¼© (Path Compression)</h4>
                            <div class="tech-content">
                                <div class="before-after">
                                    <div class="before">
                                        <h5>ä¼˜åŒ–å‰ï¼š</h5>
                                        <p>æŸ¥æ‰¾éœ€è¦é€å±‚å‘ä¸Š</p>
                                        <div class="path-demo">A â†’ B â†’ C â†’ D(æ ¹)</div>
                                        <p>æ—¶é—´å¤æ‚åº¦ï¼šO(n)</p>
                                    </div>
                                    <div class="arrow">â†’</div>
                                    <div class="after">
                                        <h5>ä¼˜åŒ–åï¼š</h5>
                                        <p>æ‰€æœ‰èŠ‚ç‚¹ç›´è¿æ ¹èŠ‚ç‚¹</p>
                                        <div class="path-demo">A â†’ D(æ ¹), B â†’ D(æ ¹), C â†’ D(æ ¹)</div>
                                        <p>æ—¶é—´å¤æ‚åº¦ï¼šO(1)</p>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="tech-card">
                            <h4>âš–ï¸ æŒ‰ç§©åˆå¹¶ (Union by Rank)</h4>
                            <div class="tech-content">
                                <p><strong>ç­–ç•¥ï¼š</strong>æ€»æ˜¯è®©æ·±åº¦å°çš„æ ‘çš„æ ¹æŒ‡å‘æ·±åº¦å¤§çš„æ ‘çš„æ ¹</p>
                                <p><strong>å¥½å¤„ï¼š</strong>é¿å…æ ‘å˜å¾—è¿‡é«˜ï¼Œä¿æŒå¹³è¡¡</p>
                                <div class="rank-example">
                                    <span class="good">âœ… æ­£ç¡®ï¼šçŸ®æ ‘â†’é«˜æ ‘</span>
                                    <span class="bad">âŒ é”™è¯¯ï¼šé«˜æ ‘â†’çŸ®æ ‘</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="concept-item">
                    <h3>âš ï¸ å…³é”®ç†è§£ç‚¹</h3>
                    <div class="key-points">
                        <div class="point-card">
                            <span class="point-icon">ğŸ¯</span>
                            <h4>é˜¿å…‹æ›¼å‡½æ•°</h4>
                            <p>Î±(n)æ˜¯é˜¿å…‹æ›¼å‡½æ•°çš„åå‡½æ•°ï¼Œå®é™…åº”ç”¨ä¸­å¯è§†ä¸ºå¸¸æ•°ï¼Œå³ä½¿n=10^80ä¹Ÿåªæœ‰5</p>
                        </div>
                        <div class="point-card">
                            <span class="point-icon">ğŸ”„</span>
                            <h4>åŠ¨æ€è¿é€šæ€§</h4>
                            <p>å¹¶æŸ¥é›†ä¸“é—¨è§£å†³"åŠ¨æ€è¿é€šæ€§"é—®é¢˜ï¼šåœ¨çº¿åœ°å¤„ç†è¿æ¥å’ŒæŸ¥è¯¢æ“ä½œ</p>
                        </div>
                        <div class="point-card">
                            <span class="point-icon">ğŸ“</span>
                            <h4>åº”ç”¨ç‰¹ç‚¹</h4>
                            <p>åªæ”¯æŒåˆå¹¶ï¼Œä¸æ”¯æŒåˆ†ç¦»ã€‚ä¸€æ—¦ä¸¤ä¸ªé›†åˆåˆå¹¶ï¼Œå°±æ— æ³•å†æ‹†åˆ†</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- ğŸ“Š å¯è§†åŒ–å±•ç¤º -->
    <div class="content-card">
        <div class="content-section">
            <h2 class="section-title">
                <span class="section-icon">ğŸ“Š</span>
                å¯è§†åŒ–å±•ç¤º
            </h2>

            <!-- é™æ€ç»“æ„å›¾ -->
            <div class="visualization-container">
                <h3>ğŸ›ï¸ å¹¶æŸ¥é›†åŸºæœ¬ç»“æ„</h3>
                <div class="static-diagram">
                    <div class="structure-comparison">
                        <div class="structure-view">
                            <h4>æ•°ç»„è¡¨ç¤º</h4>
                            <div class="array-view">
                                <div class="array-header">
                                    <span>ç´¢å¼•</span>
                                    <span>0</span>
                                    <span>1</span>
                                    <span>2</span>
                                    <span>3</span>
                                    <span>4</span>
                                    <span>5</span>
                                </div>
                                <div class="array-content">
                                    <span>parent</span>
                                    <span class="root">0</span>
                                    <span class="child">0</span>
                                    <span class="root">2</span>
                                    <span class="child">2</span>
                                    <span class="child">2</span>
                                    <span class="root">5</span>
                                </div>
                                <div class="array-content">
                                    <span>rank</span>
                                    <span>2</span>
                                    <span>0</span>
                                    <span>2</span>
                                    <span>0</span>
                                    <span>0</span>
                                    <span>0</span>
                                </div>
                            </div>
                        </div>

                        <div class="structure-view">
                            <h4>æ ‘å½¢ç»“æ„</h4>
                            <svg width="100%" height="200" viewBox="0 0 400 200">
                                <!-- ç¬¬ä¸€æ£µæ ‘ -->
                                <g>
                                    <circle cx="100" cy="50" r="20" fill="#4CAF50" stroke="#2E7D32" stroke-width="2"/>
                                    <text x="100" y="55" text-anchor="middle" fill="white" font-weight="bold">0</text>

                                    <circle cx="100" cy="120" r="20" fill="#2196F3" stroke="#1976D2" stroke-width="2"/>
                                    <text x="100" y="125" text-anchor="middle" fill="white" font-weight="bold">1</text>

                                    <line x1="100" y1="70" x2="100" y2="100" stroke="#666" stroke-width="2"/>

                                    <text x="100" y="40" text-anchor="middle" font-size="12" fill="#2E7D32">é›†åˆ1</text>
                                </g>

                                <!-- ç¬¬äºŒæ£µæ ‘ -->
                                <g>
                                    <circle cx="250" cy="50" r="20" fill="#4CAF50" stroke="#2E7D32" stroke-width="2"/>
                                    <text x="250" y="55" text-anchor="middle" fill="white" font-weight="bold">2</text>

                                    <circle cx="220" cy="120" r="20" fill="#2196F3" stroke="#1976D2" stroke-width="2"/>
                                    <text x="220" y="125" text-anchor="middle" fill="white" font-weight="bold">3</text>

                                    <circle cx="280" cy="120" r="20" fill="#2196F3" stroke="#1976D2" stroke-width="2"/>
                                    <text x="280" y="125" text-anchor="middle" fill="white" font-weight="bold">4</text>

                                    <line x1="250" y1="70" x2="220" y2="100" stroke="#666" stroke-width="2"/>
                                    <line x1="250" y1="70" x2="280" y2="100" stroke="#666" stroke-width="2"/>

                                    <text x="250" y="40" text-anchor="middle" font-size="12" fill="#2E7D32">é›†åˆ2</text>
                                </g>

                                <!-- ç¬¬ä¸‰æ£µæ ‘ -->
                                <g>
                                    <circle cx="350" cy="85" r="20" fill="#4CAF50" stroke="#2E7D32" stroke-width="2"/>
                                    <text x="350" y="90" text-anchor="middle" fill="white" font-weight="bold">5</text>

                                    <text x="350" y="75" text-anchor="middle" font-size="12" fill="#2E7D32">é›†åˆ3</text>
                                </g>
                            </svg>
                        </div>
                    </div>

                    <div class="legend">
                        <div class="legend-item">
                            <div class="legend-color root-color"></div>
                            <span>æ ¹èŠ‚ç‚¹(é›†åˆä»£è¡¨)</span>
                        </div>
                        <div class="legend-item">
                            <div class="legend-color child-color"></div>
                            <span>å­èŠ‚ç‚¹</span>
                        </div>
                        <div class="legend-item">
                            <span>parent[i] = i è¡¨ç¤º i æ˜¯æ ¹èŠ‚ç‚¹</span>
                        </div>
                    </div>
                </div>

                <!-- åŠ¨æ€æ“ä½œæ¼”ç¤º -->
                <h3>ğŸ¬ åŠ¨æ€æ“ä½œæ¼”ç¤º</h3>
                <div class="animation-controls">
                    <div class="control-panel">
                        <button id="findBtn" class="unified-btn unified-btn-primary">æŸ¥æ‰¾æ“ä½œ</button>
                        <button id="unionBtn" class="unified-btn unified-btn-secondary">åˆå¹¶æ“ä½œ</button>
                        <input type="number" id="findElement" placeholder="æŸ¥æ‰¾å…ƒç´ " min="0" max="7" value="1">
                        <input type="number" id="unionX" placeholder="å…ƒç´ X" min="0" max="7" value="1">
                        <input type="number" id="unionY" placeholder="å…ƒç´ Y" min="0" max="7" value="3">
                        <button id="resetBtn" class="unified-btn">é‡ç½®</button>
                    </div>
                    <div class="optimization-controls">
                        <label class="checkbox-label">
                            <input type="checkbox" id="pathCompression" checked> å¯ç”¨è·¯å¾„å‹ç¼©
                        </label>
                        <label class="checkbox-label">
                            <input type="checkbox" id="unionByRank" checked> å¯ç”¨æŒ‰ç§©åˆå¹¶
                        </label>
                    </div>
                    <div class="step-info" id="stepInfo">ç‚¹å‡»æ“ä½œæŒ‰é’®å¼€å§‹æ¼”ç¤º</div>
                </div>

                <div class="canvas-container">
                    <canvas id="unionFindCanvas" width="1000" height="600"></canvas>
                </div>

                <!-- å¤æ‚åº¦å¯¹æ¯” -->
                <div class="complexity-comparison">
                    <h3>â±ï¸ å¤æ‚åº¦å¯¹æ¯”</h3>
                    <div class="comparison-table">
                        <table>
                            <thead>
                                <tr>
                                    <th>å®ç°æ–¹å¼</th>
                                    <th>Findæ“ä½œ</th>
                                    <th>Unionæ“ä½œ</th>
                                    <th>ç©ºé—´å¤æ‚åº¦</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>æœ´ç´ å®ç°</td>
                                    <td>O(n)</td>
                                    <td>O(n)</td>
                                    <td>O(n)</td>
                                </tr>
                                <tr class="highlighted">
                                    <td>è·¯å¾„å‹ç¼©</td>
                                    <td>O(log n)</td>
                                    <td>O(log n)</td>
                                    <td>O(n)</td>
                                </tr>
                                <tr class="highlighted">
                                    <td>æŒ‰ç§©åˆå¹¶</td>
                                    <td>O(log n)</td>
                                    <td>O(log n)</td>
                                    <td>O(n)</td>
                                </tr>
                                <tr class="best">
                                    <td>åŒé‡ä¼˜åŒ–</td>
                                    <td>O(Î±(n))</td>
                                    <td>O(Î±(n))</td>
                                    <td>O(n)</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- æ“ä½œæ­¥éª¤è¯´æ˜ -->
                <div class="operation-steps">
                    <div class="step-card">
                        <h4>ğŸ” Findæ“ä½œæ­¥éª¤</h4>
                        <ol>
                            <li>ä»ç›®æ ‡å…ƒç´ å¼€å§‹</li>
                            <li>æ²¿ç€parentæŒ‡é’ˆå‘ä¸ŠæŸ¥æ‰¾</li>
                            <li>ç›´åˆ°æ‰¾åˆ°æ ¹èŠ‚ç‚¹(parent[i] = i)</li>
                            <li><strong>è·¯å¾„å‹ç¼©ï¼š</strong>å°†è·¯å¾„ä¸Šæ‰€æœ‰èŠ‚ç‚¹ç›´æ¥æŒ‡å‘æ ¹</li>
                            <li>è¿”å›æ ¹èŠ‚ç‚¹ä½œä¸ºé›†åˆä»£è¡¨</li>
                        </ol>
                    </div>

                    <div class="step-card">
                        <h4>ğŸ”— Unionæ“ä½œæ­¥éª¤</h4>
                        <ol>
                            <li>åˆ†åˆ«æŸ¥æ‰¾ä¸¤ä¸ªå…ƒç´ çš„æ ¹èŠ‚ç‚¹</li>
                            <li>å¦‚æœæ ¹èŠ‚ç‚¹ç›¸åŒï¼Œè¯´æ˜å·²åœ¨åŒä¸€é›†åˆ</li>
                            <li><strong>æŒ‰ç§©åˆå¹¶ï¼š</strong>æ¯”è¾ƒä¸¤æ£µæ ‘çš„rank</li>
                            <li>è®©rankå°çš„æ ¹æŒ‡å‘rankå¤§çš„æ ¹</li>
                            <li>å¦‚æœrankç›¸ç­‰ï¼Œä»»é€‰ä¸€ä¸ªï¼Œè¢«æŒ‡å‘çš„rank+1</li>
                        </ol>
                    </div>

                    <div class="step-card">
                        <h4>âš¡ ä¼˜åŒ–æŠ€æœ¯åŸç†</h4>
                        <div class="optimization-details">
                            <div class="optimization-item">
                                <h5>è·¯å¾„å‹ç¼©</h5>
                                <p>å°†æŸ¥æ‰¾è·¯å¾„ä¸Šçš„æ‰€æœ‰èŠ‚ç‚¹ç›´æ¥è¿åˆ°æ ¹ï¼Œä½¿å¾—åç»­æŸ¥æ‰¾æ›´å¿«</p>
                            </div>
                            <div class="optimization-item">
                                <h5>æŒ‰ç§©åˆå¹¶</h5>
                                <p>ç»´æŠ¤æ ‘çš„æ·±åº¦ä¿¡æ¯ï¼Œæ€»æ˜¯è®©æµ…æ ‘æŒ‡å‘æ·±æ ‘ï¼Œä¿æŒæ ‘çš„å¹³è¡¡</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- ğŸŒŸ å®é™…åº”ç”¨ -->
    <div class="content-card">
        <div class="content-section">
            <h2 class="section-title">
                <span class="section-icon">ğŸŒŸ</span>
                å®é™…åº”ç”¨
            </h2>

            <div class="applications">
                <div class="application-item featured">
                    <h3>ğŸŒ² Kruskalæœ€å°ç”Ÿæˆæ ‘ç®—æ³•</h3>
                    <p>åœ¨å›¾çš„æ‰€æœ‰è¾¹ä¸­é€‰æ‹©æƒé‡æœ€å°çš„è¾¹ï¼Œç”¨å¹¶æŸ¥é›†åˆ¤æ–­æ˜¯å¦ä¼šå½¢æˆç¯ï¼Œæ„å»ºæœ€å°ç”Ÿæˆæ ‘ã€‚</p>
                    <div class="application-details">
                        <h4>ç®—æ³•æµç¨‹ï¼š</h4>
                        <ol>
                            <li>å°†æ‰€æœ‰è¾¹æŒ‰æƒé‡ä»å°åˆ°å¤§æ’åº</li>
                            <li>å¯¹æ¯æ¡è¾¹(u,v)ï¼Œæ£€æŸ¥uå’Œvæ˜¯å¦åœ¨åŒä¸€è¿é€šåˆ†é‡</li>
                            <li>å¦‚æœä¸åœ¨ï¼Œæ‰§è¡ŒUnion(u,v)å¹¶å°†è¾¹åŠ å…¥ç»“æœ</li>
                            <li>é‡å¤ç›´åˆ°é€‰å‡ºn-1æ¡è¾¹</li>
                        </ol>
                    </div>
                </div>

                <div class="application-item">
                    <h3>ğŸ‘¥ ç¤¾äº¤ç½‘ç»œæœ‹å‹åœˆ</h3>
                    <p>å¿«é€Ÿåˆ¤æ–­ä¸¤ä¸ªç”¨æˆ·æ˜¯å¦åœ¨åŒä¸€ä¸ªæœ‹å‹åœˆï¼Œæˆ–è€…åˆå¹¶ä¸¤ä¸ªæœ‹å‹åœˆã€‚</p>
                </div>

                <div class="application-item">
                    <h3>ğŸï¸ å²›å±¿æ•°é‡é—®é¢˜</h3>
                    <p>åœ¨äºŒç»´ç½‘æ ¼ä¸­ç»Ÿè®¡ç”±1ç»„æˆçš„å²›å±¿æ•°é‡ï¼Œä½¿ç”¨å¹¶æŸ¥é›†åˆå¹¶ç›¸é‚»çš„é™†åœ°ã€‚</p>
                </div>

                <div class="application-item">
                    <h3>ğŸ”Œ ç½‘ç»œè¿é€šæ€§</h3>
                    <p>åˆ¤æ–­è®¡ç®—æœºç½‘ç»œä¸­ä¸¤å°ä¸»æœºæ˜¯å¦è¿é€šï¼Œæˆ–è€…åœ¨çº¿è·¯æ•…éšœæ—¶å¿«é€Ÿé‡ç»„ç½‘ç»œã€‚</p>
                </div>

                <div class="application-item">
                    <h3>ğŸ§¬ åŸºå› åºåˆ—èšç±»</h3>
                    <p>æ ¹æ®ç›¸ä¼¼åº¦å°†åŸºå› åºåˆ—åˆ†ç»„ï¼Œä½¿ç”¨å¹¶æŸ¥é›†ç®¡ç†ä¸åŒçš„åŸºå› å®¶æ—ã€‚</p>
                </div>
            </div>

            <!-- ä»£ç ç¤ºä¾‹ -->
            <div class="code-examples">
                <h3>ğŸ’» ä»£ç å®ç°</h3>
                <div class="code-tabs">
                    <button class="tab-btn active" data-lang="cpp">C++</button>
                    <button class="tab-btn" data-lang="java">Java</button>
                    <button class="tab-btn" data-lang="python">Python</button>
                </div>

                <!-- C++ ä»£ç  -->
                <div class="code-content active" data-lang="cpp">
                    <div class="code-header">
                        <span>å¹¶æŸ¥é›†å®Œæ•´å®ç° - C++</span>
                        <button class="copy-btn" data-clipboard-target="cpp-code">ğŸ“‹ å¤åˆ¶</button>
                    </div>
                    <pre id="cpp-code"><code>
class UnionFind {
private:
    vector&lt;int&gt; parent;  // çˆ¶èŠ‚ç‚¹æ•°ç»„
    vector&lt;int&gt; rank;   // ç§©æ•°ç»„(æ ‘çš„æ·±åº¦)
    int count;          // è¿é€šåˆ†é‡ä¸ªæ•°

public:
    UnionFind(int n) : count(n) {
        parent.resize(n);
        rank.resize(n, 0);
        // åˆå§‹åŒ–ï¼šæ¯ä¸ªå…ƒç´ çš„çˆ¶èŠ‚ç‚¹æ˜¯è‡ªå·±
        for (int i = 0; i < n; i++) {
            parent[i] = i;
        }
    }

    // æŸ¥æ‰¾æ“ä½œ + è·¯å¾„å‹ç¼©
    int find(int x) {
        if (parent[x] != x) {
            // è·¯å¾„å‹ç¼©ï¼šè®©è·¯å¾„ä¸Šæ‰€æœ‰èŠ‚ç‚¹ç›´æ¥æŒ‡å‘æ ¹
            parent[x] = find(parent[x]);
        }
        return parent[x];
    }

    // åˆå¹¶æ“ä½œ + æŒ‰ç§©åˆå¹¶
    bool unionSets(int x, int y) {
        int rootX = find(x);
        int rootY = find(y);

        if (rootX == rootY) {
            return false;  // å·²ç»åœ¨åŒä¸€é›†åˆä¸­
        }

        // æŒ‰ç§©åˆå¹¶ï¼šè®©rankå°çš„æ ¹æŒ‡å‘rankå¤§çš„æ ¹
        if (rank[rootX] < rank[rootY]) {
            parent[rootX] = rootY;
        } else if (rank[rootX] > rank[rootY]) {
            parent[rootY] = rootX;
        } else {
            parent[rootY] = rootX;
            rank[rootX]++;  // rankç›¸ç­‰æ—¶ï¼Œè¢«æŒ‡å‘çš„æ ¹çš„rankå¢åŠ 
        }

        count--;  // è¿é€šåˆ†é‡å‡ä¸€
        return true;
    }

    // åˆ¤æ–­ä¸¤ä¸ªå…ƒç´ æ˜¯å¦åœ¨åŒä¸€é›†åˆ
    bool isConnected(int x, int y) {
        return find(x) == find(y);
    }

    // è·å–è¿é€šåˆ†é‡ä¸ªæ•°
    int getCount() const {
        return count;
    }

    // è·å–é›†åˆå¤§å°(éœ€è¦é¢å¤–ç»´æŠ¤sizeæ•°ç»„)
    int getSize(int x) {
        return size[find(x)];
    }
};

// ä½¿ç”¨ç¤ºä¾‹ï¼šKruskalæœ€å°ç”Ÿæˆæ ‘
struct Edge {
    int u, v, weight;
    bool operator<(const Edge& other) const {
        return weight < other.weight;
    }
};

int kruskalMST(int n, vector&lt;Edge&gt;& edges) {
    sort(edges.begin(), edges.end());
    UnionFind uf(n);

    int mstWeight = 0;
    int edgesUsed = 0;

    for (const Edge& edge : edges) {
        if (uf.unionSets(edge.u, edge.v)) {
            mstWeight += edge.weight;
            edgesUsed++;

            if (edgesUsed == n - 1) {
                break;  // MSTå®Œæˆ
            }
        }
    }

    return mstWeight;
}
                    </code></pre>
                </div>

                <!-- Java ä»£ç  -->
                <div class="code-content" data-lang="java">
                    <div class="code-header">
                        <span>å¹¶æŸ¥é›†å®Œæ•´å®ç° - Java</span>
                        <button class="copy-btn" data-clipboard-target="java-code">ğŸ“‹ å¤åˆ¶</button>
                    </div>
                    <pre id="java-code"><code>
public class UnionFind {
    private int[] parent;  // çˆ¶èŠ‚ç‚¹æ•°ç»„
    private int[] rank;    // ç§©æ•°ç»„
    private int count;     // è¿é€šåˆ†é‡ä¸ªæ•°

    public UnionFind(int n) {
        parent = new int[n];
        rank = new int[n];
        count = n;

        // åˆå§‹åŒ–ï¼šæ¯ä¸ªå…ƒç´ çš„çˆ¶èŠ‚ç‚¹æ˜¯è‡ªå·±
        for (int i = 0; i < n; i++) {
            parent[i] = i;
            rank[i] = 0;
        }
    }

    // æŸ¥æ‰¾æ“ä½œ + è·¯å¾„å‹ç¼©
    public int find(int x) {
        if (parent[x] != x) {
            // è·¯å¾„å‹ç¼©
            parent[x] = find(parent[x]);
        }
        return parent[x];
    }

    // åˆå¹¶æ“ä½œ + æŒ‰ç§©åˆå¹¶
    public boolean union(int x, int y) {
        int rootX = find(x);
        int rootY = find(y);

        if (rootX == rootY) {
            return false;  // å·²åœ¨åŒä¸€é›†åˆ
        }

        // æŒ‰ç§©åˆå¹¶
        if (rank[rootX] < rank[rootY]) {
            parent[rootX] = rootY;
        } else if (rank[rootX] > rank[rootY]) {
            parent[rootY] = rootX;
        } else {
            parent[rootY] = rootX;
            rank[rootX]++;
        }

        count--;
        return true;
    }

    // åˆ¤æ–­è¿é€šæ€§
    public boolean isConnected(int x, int y) {
        return find(x) == find(y);
    }

    // è·å–è¿é€šåˆ†é‡ä¸ªæ•°
    public int getCount() {
        return count;
    }
}

// ä½¿ç”¨ç¤ºä¾‹ï¼šæœ‹å‹åœˆé—®é¢˜
class Solution {
    public int findCircleNum(int[][] isConnected) {
        int n = isConnected.length;
        UnionFind uf = new UnionFind(n);

        for (int i = 0; i < n; i++) {
            for (int j = i + 1; j < n; j++) {
                if (isConnected[i][j] == 1) {
                    uf.union(i, j);
                }
            }
        }

        return uf.getCount();
    }
}

// ä½¿ç”¨ç¤ºä¾‹ï¼šå²›å±¿æ•°é‡
class Solution2 {
    public int numIslands(char[][] grid) {
        if (grid == null || grid.length == 0) return 0;

        int m = grid.length, n = grid[0].length;
        UnionFind uf = new UnionFind(m * n);
        int waterCount = 0;

        int[][] directions = { {0, 1}, {1, 0}, {0, -1}, {-1, 0} };

        for (int i = 0; i < m; i++) {
            for (int j = 0; j < n; j++) {
                if (grid[i][j] == '0') {
                    waterCount++;
                } else {
                    // æ£€æŸ¥å››ä¸ªæ–¹å‘
                    for (int[] dir : directions) {
                        int x = i + dir[0], y = j + dir[1];
                        if (x >= 0 && x < m && y >= 0 && y < n && grid[x][y] == '1') {
                            uf.union(i * n + j, x * n + y);
                        }
                    }
                }
            }
        }

        return uf.getCount() - waterCount;
    }
}
                    </code></pre>
                </div>

                <!-- Python ä»£ç  -->
                <div class="code-content" data-lang="python">
                    <div class="code-header">
                        <span>å¹¶æŸ¥é›†å®Œæ•´å®ç° - Python</span>
                        <button class="copy-btn" data-clipboard-target="python-code">ğŸ“‹ å¤åˆ¶</button>
                    </div>
                    <pre id="python-code"><code>
class UnionFind:
    def __init__(self, n):
        """åˆå§‹åŒ–å¹¶æŸ¥é›†"""
        self.parent = list(range(n))  # çˆ¶èŠ‚ç‚¹æ•°ç»„
        self.rank = [0] * n           # ç§©æ•°ç»„
        self.count = n                # è¿é€šåˆ†é‡ä¸ªæ•°
        self.size = [1] * n           # æ¯ä¸ªé›†åˆçš„å¤§å°

    def find(self, x):
        """æŸ¥æ‰¾ + è·¯å¾„å‹ç¼©"""
        if self.parent[x] != x:
            self.parent[x] = self.find(self.parent[x])
        return self.parent[x]

    def union(self, x, y):
        """åˆå¹¶ + æŒ‰ç§©åˆå¹¶"""
        root_x, root_y = self.find(x), self.find(y)

        if root_x == root_y:
            return False  # å·²åœ¨åŒä¸€é›†åˆ

        # æŒ‰ç§©åˆå¹¶
        if self.rank[root_x] < self.rank[root_y]:
            self.parent[root_x] = root_y
            self.size[root_y] += self.size[root_x]
        elif self.rank[root_x] > self.rank[root_y]:
            self.parent[root_y] = root_x
            self.size[root_x] += self.size[root_y]
        else:
            self.parent[root_y] = root_x
            self.size[root_x] += self.size[root_y]
            self.rank[root_x] += 1

        self.count -= 1
        return True

    def is_connected(self, x, y):
        """åˆ¤æ–­è¿é€šæ€§"""
        return self.find(x) == self.find(y)

    def get_count(self):
        """è·å–è¿é€šåˆ†é‡ä¸ªæ•°"""
        return self.count

    def get_size(self, x):
        """è·å–xæ‰€åœ¨é›†åˆçš„å¤§å°"""
        return self.size[self.find(x)]

# ä½¿ç”¨ç¤ºä¾‹1ï¼šæœ‹å‹åœˆé—®é¢˜
def find_circle_num(is_connected):
    """
    è®¡ç®—æœ‹å‹åœˆæ•°é‡
    :param is_connected: äºŒç»´æ•°ç»„ï¼Œis_connected[i][j] = 1è¡¨ç¤ºiå’Œjæ˜¯æœ‹å‹
    :return: æœ‹å‹åœˆæ•°é‡
    """
    n = len(is_connected)
    uf = UnionFind(n)

    for i in range(n):
        for j in range(i + 1, n):
            if is_connected[i][j] == 1:
                uf.union(i, j)

    return uf.get_count()

# ä½¿ç”¨ç¤ºä¾‹2ï¼šå²›å±¿æ•°é‡
def num_islands(grid):
    """
    è®¡ç®—å²›å±¿æ•°é‡
    :param grid: äºŒç»´å­—ç¬¦æ•°ç»„ï¼Œ'1'è¡¨ç¤ºé™†åœ°ï¼Œ'0'è¡¨ç¤ºæ°´
    :return: å²›å±¿æ•°é‡
    """
    if not grid or not grid[0]:
        return 0

    m, n = len(grid), len(grid[0])
    uf = UnionFind(m * n)
    water_count = 0

    directions = [(0, 1), (1, 0), (0, -1), (-1, 0)]

    for i in range(m):
        for j in range(n):
            if grid[i][j] == '0':
                water_count += 1
            else:
                # æ£€æŸ¥å››ä¸ªæ–¹å‘
                for di, dj in directions:
                    x, y = i + di, j + dj
                    if 0 <= x < m and 0 <= y < n and grid[x][y] == '1':
                        uf.union(i * n + j, x * n + y)

    return uf.get_count() - water_count

# ä½¿ç”¨ç¤ºä¾‹3ï¼šKruskalæœ€å°ç”Ÿæˆæ ‘
def kruskal_mst(n, edges):
    """
    Kruskalç®—æ³•æ±‚æœ€å°ç”Ÿæˆæ ‘
    :param n: èŠ‚ç‚¹æ•°é‡
    :param edges: è¾¹åˆ—è¡¨ï¼Œæ¯ä¸ªå…ƒç´ ä¸º(u, v, weight)
    :return: æœ€å°ç”Ÿæˆæ ‘çš„æ€»æƒé‡
    """
    # æŒ‰æƒé‡æ’åº
    edges.sort(key=lambda x: x[2])

    uf = UnionFind(n)
    mst_weight = 0
    edges_used = 0

    for u, v, weight in edges:
        if uf.union(u, v):
            mst_weight += weight
            edges_used += 1

            if edges_used == n - 1:
                break

    return mst_weight

# ä½¿ç”¨ç¤ºä¾‹
if __name__ == "__main__":
    # æµ‹è¯•å¹¶æŸ¥é›†åŸºæœ¬æ“ä½œ
    uf = UnionFind(6)

    # åˆå¹¶ä¸€äº›å…ƒç´ 
    uf.union(0, 1)
    uf.union(2, 3)
    uf.union(4, 5)

    print(f"è¿é€šåˆ†é‡æ•°: {uf.get_count()}")  # 3
    print(f"0å’Œ1è¿é€š: {uf.is_connected(0, 1)}")  # True
    print(f"0å’Œ2è¿é€š: {uf.is_connected(0, 2)}")  # False

    # ç»§ç»­åˆå¹¶
    uf.union(1, 2)
    print(f"åˆå¹¶åè¿é€šåˆ†é‡æ•°: {uf.get_count()}")  # 2
    print(f"0å’Œ3è¿é€š: {uf.is_connected(0, 3)}")  # True
                    </code></pre>
                </div>
            </div>
        </div>
    </div>

    <!-- âœ… å­¦ä¹ æ£€éªŒ -->
    <div class="content-card">
        <div class="content-section">
            <h2 class="section-title">
                <span class="section-icon">âœ…</span>
                å­¦ä¹ æ£€éªŒ
            </h2>

            <div class="quiz-container">
                <div class="quiz-item">
                    <h3>ğŸ¤” æ€è€ƒé¢˜1ï¼šé˜¿å…‹æ›¼å‡½æ•°ç†è§£</h3>
                    <p><strong>é—®é¢˜ï¼š</strong>ä¸ºä»€ä¹ˆè¯´å¹¶æŸ¥é›†çš„æ—¶é—´å¤æ‚åº¦æ˜¯O(Î±(n))è€Œä¸æ˜¯O(1)ï¼ŸÎ±(n)åœ¨å®é™…åº”ç”¨ä¸­æœ‰å¤šå¤§ï¼Ÿ</p>
                    <button class="answer-btn" onclick="toggleAnswer('answer1')">ç‚¹å‡»æŸ¥çœ‹ç­”æ¡ˆ</button>
                    <div class="answer-content" id="answer1">
                        <p><strong>ç­”æ¡ˆï¼š</strong>Î±(n)æ˜¯é˜¿å…‹æ›¼å‡½æ•°çš„åå‡½æ•°ï¼Œè™½ç„¶ç†è®ºä¸Šä¸æ˜¯å¸¸æ•°ï¼Œä½†åœ¨å®é™…ä¸­å¯è§†ä¸ºå¸¸æ•°ã€‚</p>
                        <p><strong>è§£é‡Šï¼š</strong>Î±(n)å¢é•¿æå…¶ç¼“æ…¢ï¼šÎ±(1)=1, Î±(3)=2, Î±(7)=3, Î±(2047)=4, Î±(2^65536-3)=5ã€‚å³ä½¿å®‡å®™ä¸­åŸå­æ•°(çº¦10^80)ï¼ŒÎ±å€¼ä¹Ÿåªæœ‰5ã€‚æ‰€ä»¥å®é™…åº”ç”¨ä¸­å®Œå…¨å¯ä»¥å½“ä½œå¸¸æ•°æ—¶é—´æ“ä½œã€‚</p>
                    </div>
                </div>

                <div class="quiz-item">
                    <h3>ğŸ¤” æ€è€ƒé¢˜2ï¼šä¼˜åŒ–æŠ€æœ¯çš„å¿…è¦æ€§</h3>
                    <p><strong>é—®é¢˜ï¼š</strong>å¦‚æœåªä½¿ç”¨è·¯å¾„å‹ç¼©è€Œä¸ä½¿ç”¨æŒ‰ç§©åˆå¹¶ï¼Œæˆ–è€…åªä½¿ç”¨æŒ‰ç§©åˆå¹¶è€Œä¸ä½¿ç”¨è·¯å¾„å‹ç¼©ï¼Œæ—¶é—´å¤æ‚åº¦åˆ†åˆ«æ˜¯å¤šå°‘ï¼Ÿ</p>
                    <button class="answer-btn" onclick="toggleAnswer('answer2')">ç‚¹å‡»æŸ¥çœ‹ç­”æ¡ˆ</button>
                    <div class="answer-content" id="answer2">
                        <p><strong>ç­”æ¡ˆï¼š</strong>å•ç‹¬ä½¿ç”¨ä»»ä¸€ä¼˜åŒ–æŠ€æœ¯ï¼Œæ—¶é—´å¤æ‚åº¦éƒ½æ˜¯O(log n)ï¼›ä¸¤è€…ç»“åˆæ‰èƒ½è¾¾åˆ°O(Î±(n))ã€‚</p>
                        <p><strong>è§£é‡Šï¼š</strong>â‘ åªç”¨è·¯å¾„å‹ç¼©ï¼šè™½ç„¶èƒ½å‹ç¼©è·¯å¾„ï¼Œä½†Unionæ—¶å¯èƒ½äº§ç”Ÿé•¿é“¾ï¼›â‘¡åªç”¨æŒ‰ç§©åˆå¹¶ï¼šèƒ½ä¿æŒæ ‘å¹³è¡¡ï¼Œä½†æŸ¥æ‰¾è·¯å¾„ä¸å‹ç¼©ï¼›â‘¢åŒé‡ä¼˜åŒ–ï¼šæŒ‰ç§©åˆå¹¶ä¿æŒå¹³è¡¡+è·¯å¾„å‹ç¼©åŠ é€ŸæŸ¥æ‰¾=è¿‘ä¹å¸¸æ•°æ—¶é—´ã€‚</p>
                    </div>
                </div>

                <div class="quiz-item">
                    <h3>ğŸ¤” æ€è€ƒé¢˜3ï¼šåº”ç”¨åœºæ™¯åˆ¤æ–­</h3>
                    <p><strong>é—®é¢˜ï¼š</strong>ä»€ä¹ˆæƒ…å†µä¸‹åº”è¯¥ä½¿ç”¨å¹¶æŸ¥é›†è€Œä¸æ˜¯DFS/BFSæ¥è§£å†³è¿é€šæ€§é—®é¢˜ï¼Ÿ</p>
                    <button class="answer-btn" onclick="toggleAnswer('answer3')">ç‚¹å‡»æŸ¥çœ‹ç­”æ¡ˆ</button>
                    <div class="answer-content" id="answer3">
                        <p><strong>ç­”æ¡ˆï¼š</strong>å½“éœ€è¦åŠ¨æ€åœ°æ·»åŠ è¾¹å’ŒæŸ¥è¯¢è¿é€šæ€§æ—¶ï¼Œåº”è¯¥ä½¿ç”¨å¹¶æŸ¥é›†ã€‚</p>
                        <p><strong>è§£é‡Šï¼š</strong>DFS/BFSé€‚åˆé™æ€å›¾çš„è¿é€šæ€§æŸ¥è¯¢ï¼Œæ—¶é—´å¤æ‚åº¦O(V+E)ï¼›å¹¶æŸ¥é›†é€‚åˆåŠ¨æ€å›¾ï¼Œå¯ä»¥åœ¨çº¿åœ°å¤„ç†"æ·»åŠ è¾¹"å’Œ"æŸ¥è¯¢è¿é€šæ€§"æ“ä½œï¼Œå‡æ‘Šå¤æ‚åº¦O(Î±(n))ã€‚ä¾‹å¦‚ï¼šç½‘ç»œè¿æ¥å®æ—¶ç›‘æ§ã€Kruskalç®—æ³•ã€åœ¨çº¿åˆ¤æ–­å›¾çš„è¿é€šæ€§å˜åŒ–ç­‰ã€‚</p>
                    </div>
                </div>

                <div class="quiz-item">
                    <h3>ğŸ¤” æ€è€ƒé¢˜4ï¼šæ•°æ®ç»“æ„å˜ç§</h3>
                    <p><strong>é—®é¢˜ï¼š</strong>å¦‚ä½•åœ¨å¹¶æŸ¥é›†çš„åŸºç¡€ä¸Šå®ç°"æ’¤é”€"æ“ä½œï¼Œå³æ”¯æŒåˆ é™¤ä¹‹å‰æ·»åŠ çš„è¾¹ï¼Ÿ</p>
                    <button class="answer-btn" onclick="toggleAnswer('answer4')">ç‚¹å‡»æŸ¥çœ‹ç­”æ¡ˆ</button>
                    <div class="answer-content" id="answer4">
                        <p><strong>ç­”æ¡ˆï¼š</strong>æ ‡å‡†å¹¶æŸ¥é›†ä¸æ”¯æŒæ’¤é”€ï¼Œéœ€è¦ä½¿ç”¨"å¯æŒä¹…åŒ–å¹¶æŸ¥é›†"æˆ–è€…è®°å½•æ“ä½œå†å²ã€‚</p>
                        <p><strong>è§£é‡Šï¼š</strong>â‘ å¯æŒä¹…åŒ–æ–¹æ³•ï¼šä¸ºæ¯æ¬¡æ“ä½œåˆ›å»ºæ–°ç‰ˆæœ¬ï¼›â‘¡å†å²è®°å½•æ–¹æ³•ï¼šè®°å½•æ¯æ¬¡Unionçš„è¯¦ç»†ä¿¡æ¯ï¼Œæ”¯æŒå›æ»šï¼›â‘¢çº¿æ®µæ ‘+å¹¶æŸ¥é›†ï¼šå¯¹æ—¶é—´è½´å»ºçº¿æ®µæ ‘ï¼›â‘£æ³¨æ„ï¼šè·¯å¾„å‹ç¼©ä¼šç ´åå†å²ä¿¡æ¯ï¼Œæ’¤é”€åœºæ™¯ä¸‹é€šå¸¸åªç”¨æŒ‰ç§©åˆå¹¶ã€‚</p>
                    </div>
                </div>

                <div class="quiz-item">
                    <h3>ğŸ¤” æ€è€ƒé¢˜5ï¼šå®é™…ä¼˜åŒ–è€ƒè™‘</h3>
                    <p><strong>é—®é¢˜ï¼š</strong>åœ¨å®é™…é¡¹ç›®ä¸­ï¼Œä»€ä¹ˆæƒ…å†µä¸‹å¯èƒ½ä¸ä½¿ç”¨è·¯å¾„å‹ç¼©ä¼˜åŒ–ï¼Ÿ</p>
                    <button class="answer-btn" onclick="toggleAnswer('answer5')">ç‚¹å‡»æŸ¥çœ‹ç­”æ¡ˆ</button>
                    <div class="answer-content" id="answer5">
                        <p><strong>ç­”æ¡ˆï¼š</strong>éœ€è¦ä¿æŒæ ‘ç»“æ„ä¿¡æ¯ã€æ”¯æŒæ’¤é”€æ“ä½œã€æˆ–è€…åœ¨å¤šçº¿ç¨‹ç¯å¢ƒä¸­æ—¶ã€‚</p>
                        <p><strong>è§£é‡Šï¼š</strong>â‘ éœ€è¦æ ‘ç»“æ„ï¼šæŸäº›åº”ç”¨éœ€è¦çŸ¥é“å…·ä½“çš„çˆ¶å­å…³ç³»ï¼›â‘¡æ’¤é”€æ“ä½œï¼šè·¯å¾„å‹ç¼©ä¼šç ´åå†å²ä¿¡æ¯ï¼›â‘¢å¤šçº¿ç¨‹ï¼šè·¯å¾„å‹ç¼©çš„é€’å½’ä¿®æ”¹åœ¨å¹¶å‘ç¯å¢ƒä¸‹å¤æ‚ï¼›â‘£å†…å­˜æ•æ„Ÿï¼šè·¯å¾„å‹ç¼©å¯èƒ½å¢åŠ æŸäº›æ“ä½œçš„å†…å­˜è®¿é—®ï¼›â‘¤å®æ—¶ç³»ç»Ÿï¼šéœ€è¦ä¿è¯æ¯æ¬¡æ“ä½œçš„æ—¶é—´ä¸Šç•Œã€‚</p>
                    </div>
                </div>
            </div>

            <!-- è¿›é˜¶å­¦ä¹ å»ºè®® -->
            <div class="learning-progress">
                <h3>ğŸ“š è¿›é˜¶å­¦ä¹ è·¯å¾„</h3>
                <div class="progress-steps">
                    <div class="progress-step completed">
                        <span class="step-number">1</span>
                        <div class="step-content">
                            <h4>å¹¶æŸ¥é›†åŸºç¡€</h4>
                            <p>æŒæ¡Findå’ŒUnionæ“ä½œ</p>
                        </div>
                    </div>
                    <div class="progress-step next">
                        <span class="step-number">2</span>
                        <div class="step-content">
                            <h4>å›¾ç®—æ³•åº”ç”¨</h4>
                            <p>Kruskalã€è¿é€šåˆ†é‡</p>
                        </div>
                    </div>
                    <div class="progress-step">
                        <span class="step-number">3</span>
                        <div class="step-content">
                            <h4>åŠ¨æ€è¿é€šæ€§</h4>
                            <p>åœ¨çº¿ç®—æ³•ã€å®æ—¶æŸ¥è¯¢</p>
                        </div>
                    </div>
                    <div class="progress-step">
                        <span class="step-number">4</span>
                        <div class="step-content">
                            <h4>é«˜çº§å˜ç§</h4>
                            <p>å¯æŒä¹…åŒ–ã€å¸¦æƒå¹¶æŸ¥é›†</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- å¯¼èˆªæŒ‰é’® -->
    <div style="text-align: center; margin-top: 40px;">
        <a href="{% url 'knowledge_app:index' %}" class="unified-btn unified-btn-primary">
            <span>ğŸ </span>
            è¿”å›é¦–é¡µ
        </a>
        <a href="{% url 'knowledge_app:cs_universe' %}" class="unified-btn unified-btn-secondary">
            <span>ğŸŒŒ</span>
            æ¢ç´¢CSå®‡å®™
        </a>
    </div>
</div>

<!-- CSSæ ·å¼ -->
<style>
.overview-content {
    margin-top: 20px;
}

.concept-intro {
    background: linear-gradient(135deg, #e3f2fd, #f3e5f5);
    padding: 20px;
    border-radius: 10px;
    margin-bottom: 20px;
    border-left: 4px solid #2196F3;
}

.badge {
    padding: 4px 12px;
    border-radius: 20px;
    font-size: 12px;
    font-weight: bold;
    color: white;
}

.badge-hard {
    background: #f44336;
}

.concept-details {
    margin-top: 20px;
}

.concept-item {
    margin-bottom: 30px;
    padding: 20px;
    background: #fafafa;
    border-radius: 8px;
    border-left: 4px solid #4CAF50;
}

.example-box {
    background: white;
    padding: 15px;
    border-radius: 8px;
    margin-top: 15px;
    border: 1px solid #e0e0e0;
}

.example-box h4 {
    color: #FF5722;
    margin-top: 0;
}

.operations-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
    gap: 20px;
    margin-top: 15px;
}

.operation-card {
    background: white;
    border-radius: 8px;
    padding: 20px;
    box-shadow: 0 4px 8px rgba(0,0,0,0.1);
    transition: transform 0.2s;
}

.operation-card:hover {
    transform: translateY(-5px);
}

.find-card {
    border-left: 4px solid #2196F3;
}

.union-card {
    border-left: 4px solid #FF9800;
}

.op-icon {
    font-size: 2.5em;
    display: block;
    margin-bottom: 15px;
}

.complexity {
    background: #e8f5e8;
    padding: 8px 12px;
    border-radius: 4px;
    font-weight: bold;
    color: #2E7D32;
    margin-top: 10px;
    font-size: 14px;
}

.optimization-techniques {
    margin-top: 15px;
}

.tech-card {
    background: white;
    border-radius: 8px;
    margin-bottom: 20px;
    overflow: hidden;
    box-shadow: 0 2px 8px rgba(0,0,0,0.1);
}

.tech-card h4 {
    background: linear-gradient(135deg, #4CAF50, #66BB6A);
    color: white;
    margin: 0;
    padding: 15px 20px;
}

.tech-content {
    padding: 20px;
}

.before-after {
    display: grid;
    grid-template-columns: 1fr auto 1fr;
    gap: 20px;
    align-items: center;
    margin-top: 15px;
}

.before, .after {
    text-align: center;
}

.path-demo {
    background: #f5f5f5;
    padding: 10px;
    border-radius: 4px;
    font-family: monospace;
    margin: 8px 0;
}

.arrow {
    font-size: 24px;
    font-weight: bold;
    color: #4CAF50;
}

.rank-example {
    margin-top: 10px;
}

.good {
    color: #4CAF50;
    margin-right: 15px;
}

.bad {
    color: #f44336;
}

.key-points {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
    gap: 15px;
    margin-top: 15px;
}

.point-card {
    background: white;
    padding: 15px;
    border-radius: 8px;
    box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    border-left: 4px solid #FF5722;
    display: flex;
    align-items: flex-start;
    gap: 12px;
}

.point-icon {
    font-size: 1.5em;
    flex-shrink: 0;
}

.point-card h4 {
    margin: 0 0 8px 0;
    color: #333;
    font-size: 16px;
}

.point-card p {
    margin: 0;
    color: #666;
    font-size: 14px;
    line-height: 1.4;
}

.visualization-container {
    margin-top: 20px;
}

.static-diagram {
    text-align: center;
    margin: 20px 0;
    padding: 20px;
    background: #f9f9f9;
    border-radius: 8px;
}

.structure-comparison {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
    gap: 30px;
    margin: 20px 0;
}

.structure-view {
    background: white;
    padding: 20px;
    border-radius: 8px;
    box-shadow: 0 2px 8px rgba(0,0,0,0.1);
}

.structure-view h4 {
    text-align: center;
    color: #333;
    margin-top: 0;
}

.array-view {
    font-family: monospace;
    font-size: 14px;
}

.array-header, .array-content {
    display: grid;
    grid-template-columns: 80px repeat(6, 1fr);
    text-align: center;
    border-bottom: 1px solid #ddd;
}

.array-header {
    background: #f5f5f5;
    font-weight: bold;
    padding: 8px 0;
}

.array-content {
    padding: 8px 0;
}

.array-content span:first-child {
    background: #f5f5f5;
    font-weight: bold;
    border-right: 1px solid #ddd;
}

.root {
    background: #4CAF50;
    color: white;
    font-weight: bold;
}

.child {
    background: #2196F3;
    color: white;
    font-weight: bold;
}

.legend {
    display: flex;
    justify-content: center;
    flex-wrap: wrap;
    gap: 20px;
    margin-top: 20px;
}

.legend-item {
    display: flex;
    align-items: center;
    gap: 8px;
    font-size: 14px;
}

.legend-color {
    width: 20px;
    height: 20px;
    border-radius: 4px;
    border: 1px solid #ddd;
}

.root-color {
    background: #4CAF50;
}

.child-color {
    background: #2196F3;
}

.animation-controls {
    margin: 20px 0;
    text-align: center;
}

.control-panel {
    margin-bottom: 15px;
}

.control-panel button,
.control-panel input {
    margin: 5px;
}

.control-panel input {
    padding: 8px;
    border: 1px solid #ddd;
    border-radius: 4px;
    width: 100px;
}

.optimization-controls {
    margin-bottom: 15px;
}

.checkbox-label {
    margin: 0 20px;
    font-size: 14px;
}

.checkbox-label input {
    margin-right: 5px;
}

.step-info {
    padding: 10px;
    background: #e3f2fd;
    border-radius: 4px;
    margin-bottom: 15px;
    font-weight: bold;
}

.canvas-container {
    text-align: center;
    background: white;
    border: 2px solid #ddd;
    border-radius: 8px;
    padding: 10px;
    margin: 15px 0;
}

#unionFindCanvas {
    border: 1px solid #eee;
    border-radius: 4px;
}

.complexity-comparison {
    margin: 30px 0;
}

.comparison-table {
    overflow-x: auto;
}

.comparison-table table {
    width: 100%;
    border-collapse: collapse;
    margin-top: 15px;
    background: white;
    border-radius: 8px;
    overflow: hidden;
    box-shadow: 0 2px 8px rgba(0,0,0,0.1);
}

.comparison-table th,
.comparison-table td {
    border: 1px solid #ddd;
    padding: 12px 15px;
    text-align: center;
}

.comparison-table th {
    background: #f5f5f5;
    font-weight: bold;
    color: #333;
}

.comparison-table .highlighted {
    background: #e8f5e8;
}

.comparison-table .best {
    background: #c8e6c9;
    font-weight: bold;
}

.operation-steps {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
    gap: 15px;
    margin-top: 20px;
}

.step-card {
    background: white;
    padding: 15px;
    border-radius: 8px;
    border-left: 4px solid #2196F3;
    box-shadow: 0 2px 4px rgba(0,0,0,0.1);
}

.step-card h4 {
    margin-top: 0;
    color: #1976D2;
}

.step-card ol {
    margin: 10px 0 0 20px;
}

.optimization-details {
    margin-top: 10px;
}

.optimization-item {
    margin-bottom: 10px;
    padding: 10px;
    background: #f8f9fa;
    border-radius: 4px;
}

.optimization-item h5 {
    margin: 0 0 5px 0;
    color: #333;
}

.applications {
    margin-top: 20px;
}

.application-item {
    margin-bottom: 20px;
    padding: 20px;
    background: #f8f9fa;
    border-radius: 8px;
    border-left: 4px solid #FF5722;
}

.application-item.featured {
    background: linear-gradient(135deg, #fff3e0, #ffffff);
    border-left-color: #FF9800;
}

.application-details {
    margin-top: 15px;
    padding: 15px;
    background: white;
    border-radius: 6px;
    border: 1px solid #e0e0e0;
}

.application-details h4 {
    margin-top: 0;
    color: #FF9800;
}

.application-details ol {
    margin: 10px 0 0 20px;
}

.code-examples {
    margin-top: 30px;
}

.code-tabs {
    display: flex;
    margin-bottom: 0;
    border-bottom: 2px solid #e0e0e0;
}

.tab-btn {
    padding: 12px 24px;
    background: #f5f5f5;
    border: none;
    border-bottom: 2px solid transparent;
    cursor: pointer;
    font-weight: bold;
    transition: all 0.2s;
}

.tab-btn.active {
    background: #2196F3;
    color: white;
    border-bottom-color: #2196F3;
}

.code-content {
    display: none;
    background: #1e1e1e;
    border-radius: 0 0 8px 8px;
    overflow: hidden;
}

.code-content.active {
    display: block;
}

.code-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 10px 15px;
    background: #333;
    color: white;
    font-size: 14px;
}

.copy-btn {
    background: #4CAF50;
    color: white;
    border: none;
    padding: 5px 10px;
    border-radius: 4px;
    cursor: pointer;
    font-size: 12px;
    transition: background 0.2s;
}

.copy-btn:hover {
    background: #45a049;
}

pre {
    margin: 0;
    overflow-x: auto;
}

code {
    color: #f8f8f2;
    font-family: 'Monaco', 'Consolas', monospace;
    font-size: 14px;
    line-height: 1.5;
    display: block;
    padding: 20px;
}

.quiz-container {
    margin-top: 20px;
}

.quiz-item {
    margin-bottom: 25px;
    padding: 20px;
    background: white;
    border-radius: 8px;
    border: 1px solid #e0e0e0;
    box-shadow: 0 2px 4px rgba(0,0,0,0.05);
}

.quiz-item h3 {
    color: #1976D2;
    margin-top: 0;
}

.answer-btn {
    background: #4CAF50;
    color: white;
    border: none;
    padding: 10px 20px;
    border-radius: 5px;
    cursor: pointer;
    margin: 10px 0;
    font-weight: bold;
    transition: background 0.2s;
}

.answer-btn:hover {
    background: #45a049;
}

.answer-content {
    display: none;
    margin-top: 15px;
    padding: 15px;
    background: #e8f5e8;
    border-radius: 5px;
    border-left: 4px solid #4CAF50;
}

.answer-content.show {
    display: block;
    animation: fadeIn 0.3s ease-in;
}

@keyframes fadeIn {
    from { opacity: 0; transform: translateY(-10px); }
    to { opacity: 1; transform: translateY(0); }
}

.learning-progress {
    margin-top: 30px;
    padding: 20px;
    background: linear-gradient(135deg, #e3f2fd, #f3e5f5);
    border-radius: 10px;
}

.progress-steps {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
    gap: 20px;
    margin-top: 20px;
}

.progress-step {
    display: flex;
    align-items: center;
    padding: 15px;
    background: white;
    border-radius: 8px;
    box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    opacity: 0.6;
    transition: all 0.3s;
}

.progress-step.completed {
    opacity: 1;
    border-left: 4px solid #4CAF50;
}

.progress-step.next {
    opacity: 1;
    border-left: 4px solid #FF9800;
    transform: scale(1.05);
}

.step-number {
    display: flex;
    align-items: center;
    justify-content: center;
    width: 30px;
    height: 30px;
    background: #e0e0e0;
    color: white;
    border-radius: 50%;
    margin-right: 15px;
    font-weight: bold;
}

.progress-step.completed .step-number {
    background: #4CAF50;
}

.progress-step.next .step-number {
    background: #FF9800;
}

.step-content h4 {
    margin: 0 0 5px 0;
    color: #333;
}

.step-content p {
    margin: 0;
    color: #666;
    font-size: 14px;
}

@media (max-width: 768px) {
    .operations-grid {
        grid-template-columns: 1fr;
    }

    .key-points {
        grid-template-columns: 1fr;
    }

    .operation-steps {
        grid-template-columns: 1fr;
    }

    .progress-steps {
        grid-template-columns: 1fr;
    }

    .code-tabs {
        flex-wrap: wrap;
    }

    .tab-btn {
        flex: 1;
        min-width: 80px;
    }

    .structure-comparison {
        grid-template-columns: 1fr;
    }

    .before-after {
        grid-template-columns: 1fr;
        gap: 10px;
    }

    .arrow {
        transform: rotate(90deg);
    }
}
</style>

<!-- JavaScript -->
<script>
// å¹¶æŸ¥é›†åŠ¨ç”»ç›¸å…³å˜é‡
let canvas, ctx;
let unionFind = null;
let animationInProgress = false;
let pathCompressionEnabled = true;
let unionByRankEnabled = true;

// å¹¶æŸ¥é›†ç±»
class UnionFindVisual {
    constructor(n) {
        this.n = n;
        this.parent = Array.from({length: n}, (_, i) => i);
        this.rank = new Array(n).fill(0);
        this.size = new Array(n).fill(1);
        this.count = n;

        // å¯è§†åŒ–ç›¸å…³
        this.positions = this.calculatePositions();
        this.highlightedNodes = new Set();
        this.animationPath = [];
    }

    calculatePositions() {
        const positions = [];
        const centerX = 500;
        const centerY = 300;
        const radius = 200;

        for (let i = 0; i < this.n; i++) {
            const angle = (2 * Math.PI * i) / this.n;
            positions.push({
                x: centerX + radius * Math.cos(angle),
                y: centerY + radius * Math.sin(angle)
            });
        }
        return positions;
    }

    find(x, recordPath = false) {
        const path = [];
        let current = x;

        // è®°å½•æŸ¥æ‰¾è·¯å¾„
        while (this.parent[current] !== current) {
            path.push(current);
            current = this.parent[current];
        }
        path.push(current); // æ·»åŠ æ ¹èŠ‚ç‚¹

        if (recordPath) {
            this.animationPath = path;
        }

        // è·¯å¾„å‹ç¼©
        if (pathCompressionEnabled && path.length > 1) {
            for (let i = 0; i < path.length - 1; i++) {
                this.parent[path[i]] = current;
            }
        }

        return current;
    }

    union(x, y) {
        const rootX = this.find(x);
        const rootY = this.find(y);

        if (rootX === rootY) {
            return false;
        }

        if (unionByRankEnabled) {
            // æŒ‰ç§©åˆå¹¶
            if (this.rank[rootX] < this.rank[rootY]) {
                this.parent[rootX] = rootY;
                this.size[rootY] += this.size[rootX];
            } else if (this.rank[rootX] > this.rank[rootY]) {
                this.parent[rootY] = rootX;
                this.size[rootX] += this.size[rootY];
            } else {
                this.parent[rootY] = rootX;
                this.size[rootX] += this.size[rootY];
                this.rank[rootX]++;
            }
        } else {
            // ç®€å•åˆå¹¶
            this.parent[rootX] = rootY;
            this.size[rootY] += this.size[rootX];
        }

        this.count--;
        return true;
    }

    isConnected(x, y) {
        return this.find(x) === this.find(y);
    }
}

// åˆå§‹åŒ–å¹¶æŸ¥é›†æ¼”ç¤º
document.addEventListener('DOMContentLoaded', function() {
    canvas = document.getElementById('unionFindCanvas');
    ctx = canvas.getContext('2d');

    // åˆå§‹åŒ–8ä¸ªå…ƒç´ çš„å¹¶æŸ¥é›†
    initializeUnionFind();
    drawUnionFind();

    // ç»‘å®šäº‹ä»¶
    document.getElementById('findBtn').addEventListener('click', () => {
        if (animationInProgress) return;

        const element = parseInt(document.getElementById('findElement').value);
        if (isNaN(element) || element < 0 || element >= unionFind.n) {
            alert('è¯·è¾“å…¥æœ‰æ•ˆçš„å…ƒç´ ç¼–å·ï¼ˆ0-7ï¼‰');
            return;
        }

        startFindAnimation(element);
    });

    document.getElementById('unionBtn').addEventListener('click', () => {
        if (animationInProgress) return;

        const x = parseInt(document.getElementById('unionX').value);
        const y = parseInt(document.getElementById('unionY').value);

        if (isNaN(x) || isNaN(y) || x < 0 || x >= unionFind.n || y < 0 || y >= unionFind.n) {
            alert('è¯·è¾“å…¥æœ‰æ•ˆçš„å…ƒç´ ç¼–å·ï¼ˆ0-7ï¼‰');
            return;
        }

        if (x === y) {
            alert('ä¸¤ä¸ªå…ƒç´ ä¸èƒ½ç›¸åŒ');
            return;
        }

        startUnionAnimation(x, y);
    });

    document.getElementById('resetBtn').addEventListener('click', () => {
        if (animationInProgress) return;

        initializeUnionFind();
        drawUnionFind();
        document.getElementById('stepInfo').textContent = 'å·²é‡ç½®ï¼Œç‚¹å‡»æ“ä½œæŒ‰é’®å¼€å§‹æ¼”ç¤º';
    });

    // ä¼˜åŒ–é€‰é¡¹
    document.getElementById('pathCompression').addEventListener('change', function() {
        pathCompressionEnabled = this.checked;
    });

    document.getElementById('unionByRank').addEventListener('change', function() {
        unionByRankEnabled = this.checked;
    });
});

// åˆå§‹åŒ–å¹¶æŸ¥é›†
function initializeUnionFind() {
    unionFind = new UnionFindVisual(8);

    // åˆ›å»ºä¸€äº›åˆå§‹è¿æ¥ï¼Œè®©ç»“æ„æ›´æœ‰è¶£
    unionFind.union(0, 1);
    unionFind.union(2, 3);
    unionFind.union(4, 5);
    unionFind.union(5, 6);
}

// ç»˜åˆ¶å¹¶æŸ¥é›†
function drawUnionFind() {
    ctx.clearRect(0, 0, canvas.width, canvas.height);

    // ç»˜åˆ¶è¿æ¥çº¿
    drawConnections();

    // ç»˜åˆ¶èŠ‚ç‚¹
    drawNodes();

    // ç»˜åˆ¶ä¿¡æ¯
    drawInfo();
}

// ç»˜åˆ¶è¿æ¥çº¿
function drawConnections() {
    ctx.strokeStyle = '#666';
    ctx.lineWidth = 2;

    for (let i = 0; i < unionFind.n; i++) {
        if (unionFind.parent[i] !== i) {
            const parentIndex = unionFind.parent[i];
            const from = unionFind.positions[i];
            const to = unionFind.positions[parentIndex];

            // é«˜äº®åŠ¨ç”»è·¯å¾„ä¸Šçš„è¿çº¿
            if (unionFind.animationPath.includes(i) && unionFind.animationPath.includes(parentIndex)) {
                ctx.strokeStyle = '#FF5722';
                ctx.lineWidth = 4;
            } else {
                ctx.strokeStyle = '#666';
                ctx.lineWidth = 2;
            }

            drawArrow(from.x, from.y, to.x, to.y);
        }
    }
}

// ç»˜åˆ¶ç®­å¤´
function drawArrow(x1, y1, x2, y2) {
    // è®¡ç®—æ–¹å‘å‘é‡
    const dx = x2 - x1;
    const dy = y2 - y1;
    const length = Math.sqrt(dx * dx + dy * dy);

    // æ ‡å‡†åŒ–æ–¹å‘å‘é‡
    const unitX = dx / length;
    const unitY = dy / length;

    // è°ƒæ•´èµ·ç‚¹å’Œç»ˆç‚¹ï¼Œé¿å…è¢«èŠ‚ç‚¹é®æŒ¡
    const radius = 25;
    const startX = x1 + unitX * radius;
    const startY = y1 + unitY * radius;
    const endX = x2 - unitX * radius;
    const endY = y2 - unitY * radius;

    // ç»˜åˆ¶çº¿æ¡
    ctx.beginPath();
    ctx.moveTo(startX, startY);
    ctx.lineTo(endX, endY);
    ctx.stroke();

    // ç»˜åˆ¶ç®­å¤´å¤´éƒ¨
    const arrowLength = 15;
    const arrowAngle = Math.PI / 6;
    const angle = Math.atan2(endY - startY, endX - startX);

    ctx.beginPath();
    ctx.moveTo(endX, endY);
    ctx.lineTo(
        endX - arrowLength * Math.cos(angle - arrowAngle),
        endY - arrowLength * Math.sin(angle - arrowAngle)
    );
    ctx.moveTo(endX, endY);
    ctx.lineTo(
        endX - arrowLength * Math.cos(angle + arrowAngle),
        endY - arrowLength * Math.sin(angle + arrowAngle)
    );
    ctx.stroke();
}

// ç»˜åˆ¶èŠ‚ç‚¹
function drawNodes() {
    for (let i = 0; i < unionFind.n; i++) {
        const pos = unionFind.positions[i];
        let color, strokeColor;

        // ç¡®å®šèŠ‚ç‚¹é¢œè‰²
        if (unionFind.parent[i] === i) {
            // æ ¹èŠ‚ç‚¹
            color = '#4CAF50';
            strokeColor = '#2E7D32';
        } else {
            // å­èŠ‚ç‚¹
            color = '#2196F3';
            strokeColor = '#1976D2';
        }

        // é«˜äº®èŠ‚ç‚¹
        if (unionFind.highlightedNodes.has(i)) {
            color = '#FF5722';
            strokeColor = '#E64A19';
        }

        // åœ¨åŠ¨ç”»è·¯å¾„ä¸­çš„èŠ‚ç‚¹
        if (unionFind.animationPath.includes(i)) {
            strokeColor = '#FF9800';
            ctx.lineWidth = 4;
        } else {
            ctx.lineWidth = 3;
        }

        // ç»˜åˆ¶åœ†åœˆ
        ctx.beginPath();
        ctx.arc(pos.x, pos.y, 25, 0, 2 * Math.PI);
        ctx.fillStyle = color;
        ctx.fill();
        ctx.strokeStyle = strokeColor;
        ctx.stroke();

        // ç»˜åˆ¶èŠ‚ç‚¹ç¼–å·
        ctx.fillStyle = 'white';
        ctx.font = 'bold 16px Arial';
        ctx.textAlign = 'center';
        ctx.textBaseline = 'middle';
        ctx.fillText(i.toString(), pos.x, pos.y);

        // æ˜¾ç¤ºrankä¿¡æ¯ï¼ˆå¦‚æœæ˜¯æ ¹èŠ‚ç‚¹ï¼‰
        if (unionFind.parent[i] === i && unionByRankEnabled) {
            ctx.fillStyle = '#333';
            ctx.font = '12px Arial';
            ctx.fillText(`rank:${unionFind.rank[i]}`, pos.x, pos.y + 40);
        }
    }
}

// ç»˜åˆ¶ä¿¡æ¯é¢æ¿
function drawInfo() {
    // ç»˜åˆ¶é›†åˆä¿¡æ¯
    const sets = new Map();
    for (let i = 0; i < unionFind.n; i++) {
        const root = unionFind.find(i);
        if (!sets.has(root)) {
            sets.set(root, []);
        }
        sets.get(root).push(i);
    }

    ctx.fillStyle = '#333';
    ctx.font = '14px Arial';
    ctx.textAlign = 'left';

    let y = 30;
    ctx.fillText(`è¿é€šåˆ†é‡æ•°: ${unionFind.count}`, 20, y);
    y += 20;

    ctx.fillText('é›†åˆè¯¦æƒ…:', 20, y);
    y += 20;

    sets.forEach((members, root) => {
        ctx.fillText(`é›†åˆ${root}: {${members.join(', ')}}`, 20, y);
        y += 18;
    });

    // ç»˜åˆ¶ä¼˜åŒ–çŠ¶æ€
    const optimizations = [];
    if (pathCompressionEnabled) optimizations.push('è·¯å¾„å‹ç¼©');
    if (unionByRankEnabled) optimizations.push('æŒ‰ç§©åˆå¹¶');

    if (optimizations.length > 0) {
        ctx.fillText(`ä¼˜åŒ–: ${optimizations.join(', ')}`, 20, y + 10);
    }
}

// Findæ“ä½œåŠ¨ç”»
function startFindAnimation(element) {
    animationInProgress = true;
    unionFind.highlightedNodes.clear();
    unionFind.animationPath = [];

    let step = 1;
    document.getElementById('stepInfo').textContent = `æ­¥éª¤${step}: å¼€å§‹æŸ¥æ‰¾å…ƒç´  ${element} çš„æ ¹èŠ‚ç‚¹`;

    // è®°å½•æŸ¥æ‰¾è·¯å¾„
    const originalPathCompression = pathCompressionEnabled;
    pathCompressionEnabled = false; // æš‚æ—¶ç¦ç”¨è·¯å¾„å‹ç¼©ä»¥æ˜¾ç¤ºå®Œæ•´è·¯å¾„

    const root = unionFind.find(element, true);

    setTimeout(() => {
        step++;
        document.getElementById('stepInfo').textContent = `æ­¥éª¤${step}: æŸ¥æ‰¾è·¯å¾„: ${unionFind.animationPath.join(' â†’ ')}`;
        drawUnionFind();

        setTimeout(() => {
            if (originalPathCompression && unionFind.animationPath.length > 2) {
                step++;
                document.getElementById('stepInfo').textContent = `æ­¥éª¤${step}: åº”ç”¨è·¯å¾„å‹ç¼©ä¼˜åŒ–`;

                // é‡æ–°å¯ç”¨è·¯å¾„å‹ç¼©å¹¶æ‰§è¡Œ
                pathCompressionEnabled = true;
                unionFind.find(element);
                drawUnionFind();

                setTimeout(() => {
                    step++;
                    document.getElementById('stepInfo').textContent = `æ­¥éª¤${step}: æŸ¥æ‰¾å®Œæˆï¼å…ƒç´  ${element} çš„æ ¹èŠ‚ç‚¹æ˜¯ ${root}`;
                    unionFind.animationPath = [];
                    unionFind.highlightedNodes.add(root);
                    drawUnionFind();

                    setTimeout(() => {
                        unionFind.highlightedNodes.clear();
                        drawUnionFind();
                        animationInProgress = false;
                    }, 2000);
                }, 2000);
            } else {
                step++;
                document.getElementById('stepInfo').textContent = `æ­¥éª¤${step}: æŸ¥æ‰¾å®Œæˆï¼å…ƒç´  ${element} çš„æ ¹èŠ‚ç‚¹æ˜¯ ${root}`;
                unionFind.highlightedNodes.add(root);
                drawUnionFind();

                setTimeout(() => {
                    unionFind.highlightedNodes.clear();
                    unionFind.animationPath = [];
                    drawUnionFind();
                    animationInProgress = false;
                }, 2000);
            }
        }, 2000);
    }, 1500);
}

// Unionæ“ä½œåŠ¨ç”»
function startUnionAnimation(x, y) {
    animationInProgress = true;
    unionFind.highlightedNodes.clear();
    unionFind.animationPath = [];

    let step = 1;
    document.getElementById('stepInfo').textContent = `æ­¥éª¤${step}: å¼€å§‹åˆå¹¶å…ƒç´  ${x} å’Œ ${y}`;

    // é«˜äº®è¦åˆå¹¶çš„å…ƒç´ 
    unionFind.highlightedNodes.add(x);
    unionFind.highlightedNodes.add(y);
    drawUnionFind();

    setTimeout(() => {
        step++;
        const rootX = unionFind.find(x);
        const rootY = unionFind.find(y);

        document.getElementById('stepInfo').textContent = `æ­¥éª¤${step}: æŸ¥æ‰¾æ ¹èŠ‚ç‚¹ - ${x}çš„æ ¹æ˜¯${rootX}ï¼Œ${y}çš„æ ¹æ˜¯${rootY}`;

        unionFind.highlightedNodes.clear();
        unionFind.highlightedNodes.add(rootX);
        unionFind.highlightedNodes.add(rootY);
        drawUnionFind();

        setTimeout(() => {
            step++;
            if (rootX === rootY) {
                document.getElementById('stepInfo').textContent = `æ­¥éª¤${step}: å…ƒç´ å·²åœ¨åŒä¸€é›†åˆä¸­ï¼Œæ— éœ€åˆå¹¶`;
                setTimeout(() => {
                    unionFind.highlightedNodes.clear();
                    drawUnionFind();
                    animationInProgress = false;
                }, 2000);
                return;
            }

            // æ‰§è¡Œåˆå¹¶
            if (unionByRankEnabled) {
                const rankX = unionFind.rank[rootX];
                const rankY = unionFind.rank[rootY];
                document.getElementById('stepInfo').textContent = `æ­¥éª¤${step}: æŒ‰ç§©åˆå¹¶ - rank[${rootX}]=${rankX}, rank[${rootY}]=${rankY}`;
            } else {
                document.getElementById('stepInfo').textContent = `æ­¥éª¤${step}: æ‰§è¡Œç®€å•åˆå¹¶`;
            }

            setTimeout(() => {
                step++;
                unionFind.union(x, y);
                document.getElementById('stepInfo').textContent = `æ­¥éª¤${step}: åˆå¹¶å®Œæˆï¼è¿é€šåˆ†é‡æ•°: ${unionFind.count}`;

                unionFind.highlightedNodes.clear();
                drawUnionFind();

                setTimeout(() => {
                    animationInProgress = false;
                }, 2000);
            }, 2000);
        }, 2000);
    }, 1500);
}

// ä»£ç æ ‡ç­¾é¡µåˆ‡æ¢
document.querySelectorAll('.tab-btn').forEach(btn => {
    btn.addEventListener('click', function() {
        // ç§»é™¤æ‰€æœ‰activeç±»
        document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
        document.querySelectorAll('.code-content').forEach(c => c.classList.remove('active'));

        // æ·»åŠ activeç±»åˆ°å½“å‰æ ‡ç­¾
        this.classList.add('active');
        const lang = this.getAttribute('data-lang');
        document.querySelector(`.code-content[data-lang="${lang}"]`).classList.add('active');
    });
});

// å¤åˆ¶ä»£ç åŠŸèƒ½
document.querySelectorAll('.copy-btn').forEach(btn => {
    btn.addEventListener('click', function() {
        const targetId = this.getAttribute('data-clipboard-target');
        const codeElement = document.getElementById(targetId);

        if (codeElement) {
            // åˆ›å»ºä¸´æ—¶æ–‡æœ¬åŒºåŸŸ
            const textarea = document.createElement('textarea');
            textarea.value = codeElement.textContent;
            document.body.appendChild(textarea);
            textarea.select();
            document.execCommand('copy');
            document.body.removeChild(textarea);

            // æ˜¾ç¤ºå¤åˆ¶æˆåŠŸæç¤º
            const originalText = this.textContent;
            this.textContent = 'âœ… å·²å¤åˆ¶';
            setTimeout(() => {
                this.textContent = originalText;
            }, 2000);
        }
    });
});

// ç­”æ¡ˆåˆ‡æ¢åŠŸèƒ½
function toggleAnswer(answerId) {
    const answerElement = document.getElementById(answerId);
    const button = answerElement.previousElementSibling;

    if (answerElement.classList.contains('show')) {
        answerElement.classList.remove('show');
        button.textContent = 'ç‚¹å‡»æŸ¥çœ‹ç­”æ¡ˆ';
    } else {
        answerElement.classList.add('show');
        button.textContent = 'éšè—ç­”æ¡ˆ';
    }
}
</script>

{% endblock %}