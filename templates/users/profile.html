{% extends 'knowledge_app/base.html' %}

{% block title %}ä¸ªäººä¸­å¿ƒ - è®¡ç®—æœºç§‘å­¦å­¦ä¹ å¹³å°{% endblock %}

{% block extra_css %}
<style>.profile-container {max-width:1400px;margin:0 auto;padding:40px 30px;min-height:100vh;position:relative;z-index:1}.profile-header {background:linear-gradient(135deg, rgba(255, 255, 255, 0.15) 0%, rgba(255, 255, 255, 0.05) 100%);backdrop-filter:blur(20px);border-radius:30px;padding:50px 40px;margin:0 20px 40px 20px;color:var(--text-inverse);text-align:center;position:relative;overflow:hidden;border:1px solid rgba(255, 255, 255, 0.3);z-index:2;box-shadow:0 25px 80px rgba(0, 0, 0, 0.15), inset 0 1px 0 rgba(255, 255, 255, 0.2)}.profile-header::before {content:'';position:absolute;top:-50%;left:-50%;width:200%;height:200%;background:linear-gradient(45deg, transparent, rgba(255,255,255,0.05), transparent);animation:shimmer 3s infinite}@keyframes shimmer {0% {transform:translateX(-100%) translateY(-100%) rotate(45deg)}100% {transform:translateX(100%) translateY(100%) rotate(45deg)}}.profile-avatar {width:120px;height:120px;border-radius:50%;background:linear-gradient(135deg, var(--primary-color) 0%, var(--secondary-color) 50%, var(--accent-color) 100%);display:flex;align-items:center;justify-content:center;font-size:3.5rem;margin:0 auto 25px;color:var(--text-inverse);cursor:pointer;transition:all 0.3s ease;border:4px solid rgba(255, 255, 255, 0.3);box-shadow:0 15px 35px rgba(0, 0, 0, 0.2), 0 5px 15px rgba(0, 0, 0, 0.1);position:relative}.profile-avatar:hover {transform:scale(1.05);box-shadow:0 20px 50px rgba(0, 0, 0, 0.3), 0 8px 25px rgba(0, 0, 0, 0.15)}.profile-avatar::after {content:'ğŸ“·';position:absolute;bottom:-5px;right:-5px;background:rgba(0, 0, 0, 0.7);color:var(--text-inverse);border-radius:50%;width:35px;height:35px;display:flex;align-items:center;justify-content:center;font-size:1rem;opacity:0;transition:opacity 0.3s ease}.profile-avatar:hover::after {opacity:1}.profile-name {font-size:2.5rem;font-weight:800;margin-bottom:8px;background:linear-gradient(135deg, #ffffff 0%, #f0f0f0 100%);-webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text;text-shadow:0 2px 10px rgba(0, 0, 0, 0.3)}.profile-email {font-size:1.1rem;opacity:0.9;margin-bottom:15px;color:rgba(255, 255, 255, 0.8);font-weight:500}.profile-stats {display:grid;grid-template-columns:repeat(auto-fit, minmax(180px, 1fr));gap:25px;margin-top:30px;max-width:800px;margin-left:auto;margin-right:auto}.stat-item {text-align:center;cursor:pointer;transition:all 0.3s ease;padding:25px 20px;border-radius:var(--border-radius-lg);position:relative;background:rgba(255, 255, 255, 0.08);backdrop-filter:blur(10px);border:1px solid rgba(255, 255, 255, 0.15);box-shadow:var(--shadow-md)}.stat-item:hover {background:rgba(255, 255, 255, 0.15);transform:translateY(-5px);box-shadow:var(--shadow-md);border-color:rgba(255, 255, 255, 0.25)}.stat-item::before {content:'';position:absolute;top:0;left:0;right:0;height:3px;background:linear-gradient(90deg, var(--primary-color), var(--secondary-color), var(--accent-color));border-radius:20px 20px 0 0;opacity:0;transition:opacity 0.3s ease}.stat-item:hover::before {opacity:1}.stat-number {font-size:2.2rem;font-weight:900;display:block;margin-bottom:8px;background:linear-gradient(135deg, #ffffff 0%, #f8f9fa 100%);-webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text;text-shadow:0 2px 8px rgba(0, 0, 0, 0.2)}.stat-label {font-size:1rem;opacity:0.95;font-weight:600;margin-bottom:8px;color:rgba(255, 255, 255, 0.9);text-transform:uppercase;letter-spacing:0.5px}.stat-progress {margin-top:8px}.level-progress-bar {width:100%;height:4px;background:rgba(255, 255, 255, 0.3);border-radius:2px;overflow:hidden;margin-bottom:5px}.level-progress-fill {height:100%;background:linear-gradient(90deg, #ffd700, #ffed4e);border-radius:2px;transition:width 0.3s ease}.stat-item small {font-size:0.75rem;opacity:0.8;display:block}.profile-bio {margin:15px 0;font-size:1rem;opacity:0.9;max-width:600px;margin-left:auto;margin-right:auto;line-height:1.5}.quick-actions {display:flex;gap:20px;justify-content:center;margin-top:35px;flex-wrap:wrap}.quick-btn {background:linear-gradient(135deg, rgba(255, 255, 255, 0.2) 0%, rgba(255, 255, 255, 0.1) 100%);border:1px solid rgba(255, 255, 255, 0.3);color:var(--text-inverse);padding:15px 25px;border-radius:30px;cursor:pointer;transition:all 0.3s ease;font-size:1rem;font-weight:600;display:flex;align-items:center;gap:10px;backdrop-filter:blur(10px);box-shadow:var(--shadow-md);position:relative;overflow:hidden}.quick-btn::before {content:'';position:absolute;top:0;left:-100%;width:100%;height:100%;background:linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);transition:left 0.5s ease}.quick-btn:hover::before {left:100%}.quick-btn:hover {background:linear-gradient(135deg, rgba(255, 255, 255, 0.3) 0%, rgba(255, 255, 255, 0.2) 100%);transform:translateY(-3px);box-shadow:var(--shadow-md);border-color:rgba(255, 255, 255, 0.4)}.quick-btn span {font-size:1.2rem;filter:drop-shadow(0 2px 4px rgba(0, 0, 0, 0.2))}.dashboard-grid {display:grid;grid-template-columns:repeat(auto-fit, minmax(350px, 1fr));gap:30px;margin:40px 20px}.dashboard-card {background:var(--bg-card);backdrop-filter:blur(20px);border-radius:25px;padding:40px;box-shadow:0 20px 60px rgba(0, 0, 0, 0.08), 0 8px 25px rgba(0, 0, 0, 0.05);border:1px solid rgba(255, 255, 255, 0.3);transition:all 0.4s ease;position:relative;overflow:hidden}.dashboard-card:hover {transform:translateY(-8px);box-shadow:0 30px 80px rgba(0, 0, 0, 0.12), 0 15px 35px rgba(0, 0, 0, 0.08);border-color:rgba(102, 126, 234, 0.3)}.dashboard-card::before {content:'';position:absolute;top:0;left:0;right:0;height:5px;background:linear-gradient(90deg, var(--primary-color) 0%, var(--secondary-color) 50%, var(--accent-color) 100%);opacity:0;transition:opacity 0.4s ease;border-radius:25px 25px 0 0}.dashboard-card:hover::before {opacity:1}.card-header {display:flex;align-items:center;justify-content:space-between;margin-bottom:30px;padding-bottom:15px;border-bottom:1px solid rgba(0, 0, 0, 0.05)}.card-header-left {display:flex;align-items:center;gap:15px}.card-title {font-size:1.6rem;font-weight:700;color:var(--text-primary);margin:0;background:linear-gradient(135deg, #2d3748 0%, #4a5568 100%);-webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text}.card-icon {font-size:2rem;filter:drop-shadow(0 2px 4px rgba(0, 0, 0, 0.1));background:linear-gradient(135deg, var(--primary-color) 0%, var(--secondary-color) 100%);-webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text}.card-action-btn {background:linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);border:1px solid rgba(0, 0, 0, 0.1);color:#495057;padding:10px 18px;border-radius:12px;font-size:0.9rem;font-weight:600;cursor:pointer;transition:all 0.3s ease;text-decoration:none;display:inline-flex;align-items:center;gap:6px;box-shadow:var(--shadow-md)}.card-action-btn:hover {background:linear-gradient(135deg, var(--primary-color) 0%, var(--secondary-color) 100%);color:var(--text-inverse);border-color:transparent;transform:translateY(-2px);box-shadow:0 8px 25px rgba(102, 126, 234, 0.3)}.progress-main {display:flex;align-items:center;gap:30px}.progress-circle {position:relative;width:120px;height:120px}.progress-text {position:absolute;top:50%;left:50%;transform:translate(-50%, -50%);text-align:center}.progress-percentage {display:block;font-size:1.5rem;font-weight:700;color:var(--accent-color)}.progress-label {font-size:0.8rem;color:#666}.progress-details {flex:1;display:grid;grid-template-columns:1fr;gap:15px}.detail-item {display:flex;justify-content:space-between;align-items:center;padding:12px 15px;background:#f8f9fa;border-radius:var(--border-radius);transition:all 0.2s ease}.detail-item:hover {background:#e9ecef;transform:translateX(5px)}.detail-number {font-size:1.2rem;font-weight:700;color:var(--accent-color)}.detail-label {font-size:0.9rem;color:#666}.progress-bar {width:100%;height:8px;background:#f0f0f0;border-radius:4px;overflow:hidden;margin:10px 0}.progress-fill {height:100%;background:linear-gradient(90deg, var(--accent-color) 0%, #44a08d 100%);border-radius:4px;transition:width 0.3s ease}.achievement-count {background:var(--accent-color);color:var(--text-inverse);padding:4px 8px;border-radius:12px;font-size:0.75rem;font-weight:600}.achievement-grid {display:grid;grid-template-columns:repeat(auto-fill, minmax(140px, 1fr));gap:15px}.achievement-item {text-align:center;padding:20px 15px;background:#f8f9fa;border-radius:var(--border-radius);transition:all 0.3s ease;cursor:pointer;position:relative;border:2px solid transparent}.achievement-item.earned {background:linear-gradient(135deg, #fff 0%, #f0f8ff 100%);border-color:var(--accent-color)}.achievement-item.earned:hover {transform:translateY(-5px) scale(1.05);box-shadow:0 10px 25px rgba(78, 205, 196, 0.3)}.click-hint {position:absolute;bottom:5px;left:50%;transform:translateX(-50%);font-size:0.7rem;color:var(--primary-color);opacity:0;transition:opacity 0.3s ease;font-weight:600;background:var(--bg-card);padding:2px 8px;border-radius:var(--border-radius);white-space:nowrap}.achievement-item.earned:hover .click-hint {opacity:1}.achievement-item.next {background:#f8f9fa;border-color:#ddd;opacity:0.7}.achievement-item.next:hover {transform:translateY(-2px);opacity:0.9}.achievement-icon {font-size:2.5rem;margin-bottom:10px;display:block;filter:drop-shadow(0 2px 4px rgba(0,0,0,0.1))}.achievement-icon.locked {filter:grayscale(100%) opacity(0.5)}.achievement-name {font-size:0.85rem;font-weight:600;color:var(--text-primary);margin-bottom:5px;line-height:1.2}.achievement-date {font-size:0.7rem;color:var(--accent-color);font-weight:500}.achievement-progress {font-size:0.7rem;color:#666;font-weight:500}.no-achievements {grid-column:1 / -1;text-align:center;padding:40px 20px}.empty-state {display:flex;flex-direction:column;align-items:center;gap:15px}.empty-icon {font-size:3rem;opacity:0.5}.empty-state p {color:#666;margin:0;font-size:1rem}.start-learning-btn {background:linear-gradient(135deg, var(--accent-color) 0%, #44a08d 100%);color:var(--text-inverse);border:none;padding:10px 20px;border-radius:var(--border-radius-lg);cursor:pointer;font-weight:600;transition:all 0.3s ease}.start-learning-btn:hover {transform:translateY(-2px);box-shadow:0 5px 15px rgba(78, 205, 196, 0.4)}.recent-activity {max-height:300px;overflow-y:auto}.activity-item {display:flex;align-items:center;gap:15px;padding:12px 0;border-bottom:1px solid #f0f0f0}.activity-item:last-child {border-bottom:none}.activity-icon {width:40px;height:40px;border-radius:50%;background:var(--accent-color);display:flex;align-items:center;justify-content:center;color:var(--text-inverse);font-size:1.2rem}.activity-content {flex:1}.activity-title {font-weight:600;color:var(--text-primary);margin-bottom:2px}.activity-time {font-size:0.8rem;color:#666}.action-buttons {display:flex;gap:20px;justify-content:center;flex-wrap:wrap;margin:50px 20px 40px 20px;padding:30px;background:rgba(255, 255, 255, 0.05);backdrop-filter:blur(10px);border-radius:25px;border:1px solid rgba(255, 255, 255, 0.1)}.btn {padding:15px 30px;border-radius:var(--border-radius);text-decoration:none;font-weight:600;transition:all 0.3s ease;border:none;cursor:pointer;font-size:1rem;display:flex;align-items:center;gap:10px;position:relative;overflow:hidden;box-shadow:var(--shadow-md)}.btn::before {content:'';position:absolute;top:0;left:-100%;width:100%;height:100%;background:linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);transition:left 0.5s ease}.btn:hover::before {left:100%}.btn-primary {background:linear-gradient(135deg, var(--primary-color) 0%, var(--secondary-color) 100%);color:var(--text-inverse);border:1px solid rgba(255, 255, 255, 0.2)}.btn-primary:hover {transform:translateY(-3px);box-shadow:0 15px 40px rgba(102, 126, 234, 0.4);background:linear-gradient(135deg, #5a67d8 0%, #6b46c1 100%)}.btn-secondary {background:var(--bg-card);color:var(--text-secondary);border:1px solid rgba(0, 0, 0, 0.1);backdrop-filter:blur(10px)}.btn-secondary:hover {background:var(--bg-card);transform:translateY(-3px);box-shadow:var(--shadow-md);color:var(--text-primary)}.verification-notice {background:linear-gradient(135deg, #fff3cd, #ffeaa7);border:1px solid #ffc107;border-radius:var(--border-radius);padding:15px;margin-bottom:20px;display:flex;align-items:center;gap:12px;box-shadow:0 2px 8px rgba(255, 193, 7, 0.2)}.dev-notice {color:#28a745;font-size:0.9em;font-weight:500}.verify-btn {display:inline-flex;align-items:center;gap:8px;background:linear-gradient(135deg, #28a745, #20c997);color:white !important;padding:8px 16px;border-radius:6px;text-decoration:none !important;font-weight:500;margin-top:8px;transition:all 0.3s ease;box-shadow:0 2px 4px rgba(40, 167, 69, 0.3)}.verify-btn:hover {background:linear-gradient(135deg, #218838, #1e7e34);transform:translateY(-1px);box-shadow:0 4px 8px rgba(40, 167, 69, 0.4);color:white !important}.verification-notice.success {background:#d4edda;border-color:#c3e6cb}@media (max-width:768px) {.profile-container {padding:25px 20px}.profile-header {padding:40px 30px;margin:0 10px 30px 10px;border-radius:25px}.profile-avatar {width:100px;height:100px;font-size:3rem}.profile-name {font-size:2rem}.profile-stats {grid-template-columns:repeat(2, 1fr);gap:20px}.stat-item {padding:20px 15px}.stat-number {font-size:1.8rem}.quick-actions {gap:15px}.quick-btn {padding:12px 20px;font-size:0.9rem}.dashboard-grid {grid-template-columns:1fr;gap:25px;margin:30px 10px}.dashboard-card {padding:30px 25px;border-radius:var(--border-radius-lg)}.card-title {font-size:1.4rem}.card-icon {font-size:1.8rem}.action-buttons {flex-direction:column;align-items:center;margin:40px 15px 30px 15px;padding:25px}.btn {width:100%;max-width:280px;justify-content:center}.verification-notice {margin:15px 10px;padding:20px;border-radius:var(--border-radius)}}</style>
{% endblock %}

{% block content %}
<div class="profile-container"><!-- é‚®ç®±éªŒè¯æé†’ -->
    {% if not user.is_email_verified %}
    <div class="verification-notice"><span>âš ï¸</span><div><strong>é‚®ç®±æœªéªŒè¯</strong> -
            <span class="dev-notice">å¼€å‘ç¯å¢ƒï¼šç‚¹å‡»ä¸‹æ–¹æŒ‰é’®å³å¯è‡ªåŠ¨éªŒè¯</span><br><a href="{% url 'users:resend_verification' %}" class="verify-btn"><span>âœ…</span> éªŒè¯é‚®ç®±
            </a></div></div>
    {% endif %}

    <!-- ä¸ªäººä¿¡æ¯å¤´éƒ¨ --><div class="profile-header"><div class="profile-avatar" onclick="showAvatarOptions()">
            {{ user.get_display_name|first|upper }}
        </div><div class="profile-name">{{ user.get_display_name }}</div><div class="profile-email">{{ user.email }}</div>
        {% if user.bio %}
        <div class="profile-bio">{{ user.bio }}</div>
        {% endif %}

        <div class="profile-stats"><div class="stat-item" onclick="showLevelInfo()"><span class="stat-number">{{ progress_summary.level }}</span><span class="stat-label">ç­‰çº§</span><div class="stat-progress"><div class="level-progress-bar"><div class="level-progress-fill" style="width: {{ level_progress }}%"></div></div><small>{{ points_to_next_level }} ç§¯åˆ†å‡çº§</small></div></div><div class="stat-item" onclick="showPointsHistory()"><span class="stat-number">{{ progress_summary.points }}</span><span class="stat-label">ç§¯åˆ†</span><small>æœ¬å‘¨ +{{ weekly_points }} ç§¯åˆ†</small></div><div class="stat-item" onclick="showStreakCalendar()"><span class="stat-number">{{ progress_summary.current_streak }}</span><span class="stat-label">è¿ç»­å­¦ä¹ å¤©æ•°</span><small>æœ€é•¿ {{ progress_summary.longest_streak }} å¤©</small></div><div class="stat-item" onclick="showTimeBreakdown()"><span class="stat-number">{{ progress_summary.total_study_time_hours }}</span><span class="stat-label">å­¦ä¹ å°æ—¶</span><small>æœ¬å‘¨ {{ weekly_hours }} å°æ—¶</small></div></div><!-- å¿«é€Ÿæ“ä½œæŒ‰é’® --><div class="quick-actions"><button class="quick-btn" onclick="startQuickLearning()"><span>ğŸš€</span> å¿«é€Ÿå­¦ä¹ 
            </button><button class="quick-btn" onclick="viewLearningPlan()"><span>ğŸ“‹</span> å­¦ä¹ è®¡åˆ’
            </button><button class="quick-btn" onclick="shareProgress()"><span>ğŸ“¤</span> åˆ†äº«è¿›åº¦
            </button></div></div><!-- ä»ªè¡¨æ¿ç½‘æ ¼ --><div class="dashboard-grid"><!-- å­¦ä¹ è¿›åº¦å¡ç‰‡ --><div class="dashboard-card"><div class="card-header"><span class="card-icon">ğŸ“Š</span><h3 class="card-title">å­¦ä¹ è¿›åº¦</h3><a href="{% url 'users:learning_dashboard' %}" class="card-action-btn" style="text-decoration: none; color: inherit;">è¯¦ç»†</a></div><div class="progress-info"><div class="progress-main"><div class="progress-circle"><svg width="120" height="120" viewBox="0 0 120 120"><circle cx="60" cy="60" r="50" fill="none" stroke="#f0f0f0" stroke-width="8"/><circle cx="60" cy="60" r="50" fill="none" stroke="var(--accent-color)" stroke-width="8"
                                    stroke-dasharray="{{ progress_summary.completion_rate|floatformat:1 }} 100"
                                    stroke-dashoffset="25" transform="rotate(-90 60 60)"/></svg><div class="progress-text"><span class="progress-percentage">{{ progress_summary.completion_rate|floatformat:1 }}%</span><span class="progress-label">å®Œæˆ</span></div></div><div class="progress-details"><div class="detail-item"><span class="detail-number">{{ progress_summary.completed_points }}</span><span class="detail-label">å·²å®Œæˆ</span></div><div class="detail-item"><span class="detail-number">{{ progress_summary.in_progress_points }}</span><span class="detail-label">å­¦ä¹ ä¸­</span></div><div class="detail-item"><span class="detail-number">{{ progress_summary.recent_sessions }}</span><span class="detail-label">æœ¬å‘¨å­¦ä¹ </span></div></div></div></div></div><!-- æˆå°±å¡ç‰‡ --><div class="dashboard-card"><div class="card-header"><div class="card-header-left"><span class="card-icon">ğŸ†</span><h3 class="card-title">æˆå°±å¾½ç« </h3><span class="achievement-count">{{ user_achievements|length }}/{{ total_achievements }}</span></div><button class="card-action-btn" onclick="viewAllAchievements()" title="æŸ¥çœ‹æ‰€æœ‰æˆå°±è¯¦æƒ…"><span>ğŸ†</span> æŸ¥çœ‹å…¨éƒ¨ <span>â†’</span></button></div><div class="achievement-grid">
                {% for achievement in user_achievements %}
                <div class="achievement-item earned" title="ç‚¹å‡»æŸ¥çœ‹è¯¦æƒ…: {{ achievement.achievement.description }}"
                     onclick="showAchievementDetail('{{ achievement.achievement.id }}')"
                     style="cursor: pointer;"><span class="achievement-icon">{{ achievement.achievement.icon }}</span><div class="achievement-name">{{ achievement.achievement.name }}</div><div class="achievement-date">{{ achievement.earned_at|date:"m/d" }}</div><div class="click-hint">ç‚¹å‡»æŸ¥çœ‹è¯¦æƒ…</div></div>
                {% empty %}
                <div class="no-achievements"><div class="empty-state"><span class="empty-icon">ğŸ¯</span><p>å¼€å§‹å­¦ä¹ æ¥è·å¾—ç¬¬ä¸€ä¸ªæˆå°±å§ï¼</p><button class="start-learning-btn" onclick="startQuickLearning()">å¼€å§‹å­¦ä¹ </button></div></div>
                {% endfor %}

                <!-- æ˜¾ç¤ºä¸‹ä¸€ä¸ªå¯è·å¾—çš„æˆå°± -->
                {% if next_achievement %}
                <div class="achievement-item next" title="{{ next_achievement.description }}"><span class="achievement-icon locked">ğŸ”’</span><div class="achievement-name">{{ next_achievement.name }}</div><div class="achievement-progress">{{ next_achievement.progress }}%</div></div>
                {% endif %}
            </div></div><!-- æœ€è¿‘æ´»åŠ¨ --><div class="dashboard-card"><div class="card-header"><span class="card-icon">ğŸ“š</span><h3 class="card-title">æœ€è¿‘å­¦ä¹ </h3></div><div class="recent-activity">
                {% for session in recent_activities %}
                <div class="activity-item"><div class="activity-icon">ğŸ“–</div><div class="activity-content"><div class="activity-title">{{ session.knowledge_point.title }}</div><div class="activity-time">
                            {{ session.start_time|timesince }}å‰ Â·
                            {% if session.duration %}
                                å­¦ä¹ äº† {{ session.duration|floatformat:0 }} åˆ†é’Ÿ
                            {% else %}
                                æ­£åœ¨å­¦ä¹ ä¸­
                            {% endif %}
                        </div></div></div>
                {% empty %}
                <div style="text-align: center; color: #666; padding: 20px;"><p>ğŸ“š è¿˜æ²¡æœ‰å­¦ä¹ è®°å½•ï¼Œå¼€å§‹æ‚¨çš„å­¦ä¹ ä¹‹æ—…å§ï¼</p></div>
                {% endfor %}
            </div></div><!-- åˆ†ç±»è¿›åº¦ --><div class="dashboard-card"><div class="card-header"><span class="card-icon">ğŸ“ˆ</span><h3 class="card-title">åˆ†ç±»è¿›åº¦</h3></div>
            {% for category in progress_summary.category_progress %}
            <div style="margin-bottom: 15px;"><div style="display: flex; justify-content: space-between; margin-bottom: 5px;"><span>{{ category.knowledge_point__category }}</span><span>{{ category.completed }}/{{ category.total }}</span></div><div class="progress-bar"><div class="progress-fill" style="width: {% widthratio category.completed category.total 100 %}%"></div></div></div>
            {% empty %}
            <div style="text-align: center; color: #666;"><p>ğŸ¯ å¼€å§‹å­¦ä¹ æ¥æŸ¥çœ‹åˆ†ç±»è¿›åº¦ï¼</p></div>
            {% endfor %}
        </div></div><!-- æ“ä½œæŒ‰é’® --><div class="action-buttons"><a href="{% url 'users:edit_profile' %}" class="btn btn-primary">
            âœï¸ ç¼–è¾‘èµ„æ–™
        </a><a href="{% url 'users:preferences' %}" class="btn btn-secondary">
            âš™ï¸ è®¾ç½®
        </a><a href="{% url 'knowledge_app:index' %}" class="btn btn-secondary">
            ğŸ“š å¼€å§‹å­¦ä¹ 
        </a><a href="{% url 'knowledge_app:cs_universe' %}" class="btn btn-secondary">
            ğŸŒŒ æ¢ç´¢CSå®‡å®™
        </a></div></div>
{% endblock %}

{% block extra_js %}
<script>document.addEventListener('DOMContentLoaded', function() { console.log('ä¸ªäººä¸­å¿ƒé¡µé¢åŠ è½½å®Œæˆ'); const cards = document.querySelectorAll('.dashboard-card'); cards.forEach((card, index) => { card.style.opacity = '0'; card.style.transform = 'translateY(20px)'; setTimeout(() => { card.style.transition = 'all 0.6s ease'; card.style.opacity = '1'; card.style.transform = 'translateY(0)'; }, index * 100); }); const progressBars = document.querySelectorAll('.progress-fill'); progressBars.forEach(bar => { const width = bar.style.width; bar.style.width = '0%'; setTimeout(() => { bar.style.width = width; }, 500); }); const progressCircles = document.querySelectorAll('circle[stroke="var(--accent-color)"]'); progressCircles.forEach(circle => { const dashArray = circle.getAttribute('stroke-dasharray'); circle.setAttribute('stroke-dasharray', '0 100'); setTimeout(() => { circle.style.transition = 'stroke-dasharray 1s ease'; circle.setAttribute('stroke-dasharray', dashArray); }, 800); }); }); function showLevelInfo() { alert('ç­‰çº§ç³»ç»Ÿï¼š\n- æ¯100ç§¯åˆ†å‡ä¸€çº§\n- å®ŒæˆçŸ¥è¯†ç‚¹å’Œè¿ç»­å­¦ä¹ å¯è·å¾—ç§¯åˆ†\n- ç­‰çº§è¶Šé«˜è§£é”æ›´å¤šåŠŸèƒ½'); } function showPointsHistory() { console.log('æ˜¾ç¤ºç§¯åˆ†å†å²'); } function showStreakCalendar() { console.log('æ˜¾ç¤ºå­¦ä¹ æ—¥å†'); } function showTimeBreakdown() { console.log('æ˜¾ç¤ºæ—¶é—´åˆ†æ'); } function startQuickLearning() { window.location.href = '{% url "knowledge_app:index" %}'; } function viewLearningPlan() { window.location.href = '{% url "users:learning_plan" %}'; } function shareProgress() { if (navigator.share) { navigator.share({ title: 'æˆ‘çš„å­¦ä¹ è¿›åº¦', text: `æˆ‘åœ¨è®¡ç®—æœºç§‘å­¦å­¦ä¹ å¹³å°å·²ç»å®Œæˆäº† {{ progress_summary.completed_points }} ä¸ªçŸ¥è¯†ç‚¹ï¼Œç´¯è®¡å­¦ä¹  {{ progress_summary.total_study_time_hours }} å°æ—¶ï¼`, url: window.location.href }); } else { const text = `æˆ‘åœ¨è®¡ç®—æœºç§‘å­¦å­¦ä¹ å¹³å°å·²ç»å®Œæˆäº† {{ progress_summary.completed_points }} ä¸ªçŸ¥è¯†ç‚¹ï¼Œç´¯è®¡å­¦ä¹  {{ progress_summary.total_study_time_hours }} å°æ—¶ï¼`; navigator.clipboard.writeText(text).then(() => { alert('è¿›åº¦ä¿¡æ¯å·²å¤åˆ¶åˆ°å‰ªè´´æ¿ï¼'); }); } } function viewDetailedProgress() { window.location.href = '{% url "users:learning_stats" %}'; } function viewAllAchievements() { const button = event.target.closest('.card-action-btn'); const originalContent = button.innerHTML; button.innerHTML = '<span>â³</span> æ­£åœ¨è·³è½¬...'; button.style.opacity = '0.7'; button.disabled = true; showSuccessMessage('æ­£åœ¨è·³è½¬åˆ°æˆå°±é¡µé¢...'); setTimeout(() => { window.location.href = '{% url "knowledge_app:achievements" %}'; }, 800); } function showAchievementDetail(achievementId) { const achievementItem = event.target.closest('.achievement-item'); const originalTransform = achievementItem.style.transform; achievementItem.style.transform = 'scale(0.95)'; achievementItem.style.transition = 'transform 0.1s ease'; setTimeout(() => { achievementItem.style.transform = originalTransform; }, 100); showSuccessMessage('æ­£åœ¨æŸ¥çœ‹æˆå°±è¯¦æƒ…...'); setTimeout(() => { window.location.href = `/achievements/${achievementId}/`; }, 500); } function showSuccessMessage(message) { const toast = document.createElement('div'); toast.textContent = message; toast.style.cssText = ` position: fixed; top: 20px; right: 20px; background: linear-gradient(135deg, #10b981 0%, #059669 100%); color: var(--text-inverse); padding: 15px 25px; border-radius: var(--border-radius); font-weight: 600; box-shadow: 0 10px 30px rgba(16, 185, 129, 0.3); z-index: 10000; transform: translateX(400px); transition: transform 0.3s ease; `; document.body.appendChild(toast); setTimeout(() => { toast.style.transform = 'translateX(0)'; }, 100); setTimeout(() => { toast.style.transform = 'translateX(400px)'; setTimeout(() => toast.remove(), 300); }, 3000); } function showAvatarOptions() { alert('å¤´åƒè‡ªå®šä¹‰åŠŸèƒ½å³å°†æ¨å‡ºï¼'); } function updateStats() { fetch('{% url "users:learning_stats" %}') .then(response => response.json()) .then(data => { console.log('ç»Ÿè®¡æ•°æ®å·²æ›´æ–°', data); }) .catch(error => { console.error('æ›´æ–°ç»Ÿè®¡æ•°æ®å¤±è´¥:', error); }); } setInterval(updateStats, 5 * 60 * 1000);</script>
{% endblock %}
